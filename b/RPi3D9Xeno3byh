lastLogon", "sambaLogonTime"])
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertTrue(not "lastLogon" in res[0])
        self.assertEquals(str(res[0]["sambaLogonTime"]), "x")

        # Testing search by attribute

        # Search by ignored attribute
        res = self.ldb.search(expression="(revision=x)", scope=SCOPE_DEFAULT,
                attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 2)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=X"))
        self.assertEquals(str(res[0]["dnsHostName"]), "x")
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=Y"))
        self.assertEquals(str(res[1]["dnsHostName"]), "y")
        self.assertEquals(str(res[1]["lastLogon"]), "y")

        # Search by kept attribute
        res = self.ldb.search(expression="(description=y)",
                scope=SCOPE_DEFAULT, attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 2)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=C"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "z")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=Z"))
        self.assertEquals(str(res[1]["dnsHostName"]), "z")
        self.assertEquals(str(res[1]["lastLogon"]), "z")

        # Search by renamed attribute
        res = self.ldb.search(expression="(badPwdCount=x)", scope=SCOPE_DEFAULT,
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 2)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=B"))
        self.assertTrue(not "dnsHostName" in res[1])
        self.assertEquals(str(res[1]["lastLogon"]), "y")

        # Search by converted attribute
        # TODO:
        #   Using the SID directly in the parse tree leads to conversion
        #   errors, letting the search fail with no results.
        #res = self.ldb.search("(objectSid=S-1-5-21-4231626423-2410014848-2360679739-1052)", scope=SCOPE_DEFAULT, attrs)
        res = self.ldb.search(expression="(objectSid=*)", base=None, scope=SCOPE_DEFAULT, attrs=["dnsHostName", "lastLogon", "objectSid"])
        self.assertEquals(len(res), 4)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=X"))
        self.assertEquals(str(res[1]["dnsHostName"]), "x")
        self.assertEquals(str(res[1]["lastLogon"]), "x")
        self.assertSidEquals("S-1-5-21-4231626423-2410014848-2360679739-1052",
                             res[1]["objectSid"])
        self.assertTrue("objectSid" in res[1])
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertSidEquals("S-1-5-21-4231626423-2410014848-2360679739-1052",
                             res[0]["objectSid"])
        self.assertTrue("objectSid" in res[0])

        # Search by generated attribute
        # In most cases, this even works when the mapping is missing
        # a `convert_operator' by enumerating the remote db.
        res = self.ldb.search(expression="(primaryGroupID=512)",
                           attrs=["dnsHostName", "lastLogon", "primaryGroupID"])
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[0]["primaryGroupID"]), "512")

        # Note that Xs "objectSid" seems to be fine in the previous search for
        # "objectSid"...
        #res = ldb.search(expression="(primaryGroupID=*)", NULL, ldb. SCOPE_DEFAULT, attrs)
        #print len(res) + " results found"
        #for i in range(len(res)):
        #    for (obj in res[i]) {
        #        print obj + ": " + res[i][obj]
        #    }
        #    print "---"
        #

        # Search by remote name of renamed attribute */
        res = self.ldb.search(expression="(sambaBadPasswordCount=*)",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 0)

        # Search by objectClass
        attrs = ["dnsHostName", "lastLogon", "objectClass"]
        res = self.ldb.search(expression="(objectClass=user)", attrs=attrs)
        self.assertEquals(len(res), 2)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[0]["objectClass"][0]), "user")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=X"))
        self.assertEquals(str(res[1]["dnsHostName"]), "x")
        self.assertEquals(str(res[1]["lastLogon"]), "x")
        self.assertEquals(str(res[1]["objectClass"][0]), "user")

        # Prove that the objectClass is actually used for the search
        res = self.ldb.search(expression="(|(objectClass=user)(badPwdCount=x))",
                              attrs=attrs)
        self.assertEquals(len(res), 3)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(res[0]["objectClass"][0], "user")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=B"))
        self.assertTrue(not "dnsHostName" in res[1])
        self.assertEquals(str(res[1]["lastLogon"]), "y")
        self.assertEquals(set(res[1]["objectClass"]), set(["top"]))
        self.assertEquals(str(res[2].dn), self.samba4.dn("cn=X"))
        self.assertEquals(str(res[2]["dnsHostName"]), "x")
        self.assertEquals(str(res[2]["lastLogon"]), "x")
        self.assertEquals(str(res[2]["objectClass"][0]), "user")

        # Testing search by parse tree

        # Search by conjunction of local attributes
        res = self.ldb.search(expression="(&(codePage=x)(revision=x))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 2)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=X"))
        self.assertEquals(str(res[0]["dnsHostName"]), "x")
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=Y"))
        self.assertEquals(str(res[1]["dnsHostName"]), "y")
        self.assertEquals(str(res[1]["lastLogon"]), "y")

        # Search by conjunction of remote attributes
        res = self.ldb.search(expression="(&(lastLogon=x)(description=x))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 2)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=X"))
        self.assertEquals(str(res[1]["dnsHostName"]), "x")
        self.assertEquals(str(res[1]["lastLogon"]), "x")

        # Search by conjunction of local and remote attribute
        res = self.ldb.search(expression="(&(codePage=x)(description=x))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 2)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=X"))
        self.assertEquals(str(res[0]["dnsHostName"]), "x")
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=Y"))
        self.assertEquals(str(res[1]["dnsHostName"]), "y")
        self.assertEquals(str(res[1]["lastLogon"]), "y")

        # Search by conjunction of local and remote attribute w/o match
        attrs = ["dnsHostName", "lastLogon"]
        res = self.ldb.search(expression="(&(codePage=x)(nextRid=x))",
                              attrs=attrs)
        self.assertEquals(len(res), 0)
        res = self.ldb.search(expression="(&(revision=x)(lastLogon=z))",
                              attrs=attrs)
        self.assertEquals(len(res), 0)

        # Search by disjunction of local attributes
        res = self.ldb.search(expression="(|(revision=x)(dnsHostName=x))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 2)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=X"))
        self.assertEquals(str(res[0]["dnsHostName"]), "x")
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=Y"))
        self.assertEquals(str(res[1]["dnsHostName"]), "y")
        self.assertEquals(str(res[1]["lastLogon"]), "y")

        # Search by disjunction of remote attributes
        res = self.ldb.search(expression="(|(badPwdCount=x)(lastLogon=x))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 3)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertFalse("dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=B"))
        self.assertFalse("dnsHostName" in res[1])
        self.assertEquals(str(res[1]["lastLogon"]), "y")
        self.assertEquals(str(res[2].dn), self.samba4.dn("cn=X"))
        self.assertEquals(str(res[2]["dnsHostName"]), "x")
        self.assertEquals(str(res[2]["lastLogon"]), "x")

        # Search by disjunction of local and remote attribute
        res = self.ldb.search(expression="(|(revision=x)(lastLogon=y))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 3)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=B"))
        self.assertFalse("dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "y")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=X"))
        self.assertEquals(str(res[1]["dnsHostName"]), "x")
        self.assertEquals(str(res[1]["lastLogon"]), "x")
        self.assertEquals(str(res[2].dn), self.samba4.dn("cn=Y"))
        self.assertEquals(str(res[2]["dnsHostName"]), "y")
        self.assertEquals(str(res[2]["lastLogon"]), "y")

        # Search by disjunction of local and remote attribute w/o match
        res = self.ldb.search(expression="(|(codePage=y)(nextRid=z))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 0)

        # Search by negated local attribute
        res = self.ldb.search(expression="(!(revision=x))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 6)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=B"))
        self.assertTrue(not "dnsHostName" in res[1])
        self.assertEquals(str(res[1]["lastLogon"]), "y")
        self.assertEquals(str(res[2].dn), self.samba4.dn("cn=C"))
        self.assertTrue(not "dnsHostName" in res[2])
        self.assertEquals(str(res[2]["lastLogon"]), "z")
        self.assertEquals(str(res[3].dn), self.samba4.dn("cn=Z"))
        self.assertEquals(str(res[3]["dnsHostName"]), "z")
        self.assertEquals(str(res[3]["lastLogon"]), "z")

        # Search by negated remote attribute
        res = self.ldb.search(expression="(!(description=x))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 4)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=C"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "z")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=Z"))
        self.assertEquals(str(res[1]["dnsHostName"]), "z")
        self.assertEquals(str(res[1]["lastLogon"]), "z")

        # Search by negated conjunction of local attributes
        res = self.ldb.search(expression="(!(&(codePage=x)(revision=x)))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 6)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=B"))
        self.assertTrue(not "dnsHostName" in res[1])
        self.assertEquals(str(res[1]["lastLogon"]), "y")
        self.assertEquals(str(res[2].dn), self.samba4.dn("cn=C"))
        self.assertTrue(not "dnsHostName" in res[2])
        self.assertEquals(str(res[2]["lastLogon"]), "z")
        self.assertEquals(str(res[3].dn), self.samba4.dn("cn=Z"))
        self.assertEquals(str(res[3]["dnsHostName"]), "z")
        self.assertEquals(str(res[3]["lastLogon"]), "z")

        # Search by negated conjunction of remote attributes
        res = self.ldb.search(expression="(!(&(lastLogon=x)(description=x)))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 6)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=B"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "y")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=C"))
        self.assertTrue(not "dnsHostName" in res[1])
        self.assertEquals(str(res[1]["lastLogon"]), "z")
        self.assertEquals(str(res[2].dn), self.samba4.dn("cn=Y"))
        self.assertEquals(str(res[2]["dnsHostName"]), "y")
        self.assertEquals(str(res[2]["lastLogon"]), "y")
        self.assertEquals(str(res[3].dn), self.samba4.dn("cn=Z"))
        self.assertEquals(str(res[3]["dnsHostName"]), "z")
        self.assertEquals(str(res[3]["lastLogon"]), "z")

        # Search by negated conjunction of local and remote attribute
        res = self.ldb.search(expression="(!(&(codePage=x)(description=x)))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 6)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=B"))
        self.assertTrue(not "dnsHostName" in res[1])
        self.assertEquals(str(res[1]["lastLogon"]), "y")
        self.assertEquals(str(res[2].dn), self.samba4.dn("cn=C"))
        self.assertTrue(not "dnsHostName" in res[2])
        self.assertEquals(str(res[2]["lastLogon"]), "z")
        self.assertEquals(str(res[3].dn), self.samba4.dn("cn=Z"))
        self.assertEquals(str(res[3]["dnsHostName"]), "z")
        self.assertEquals(str(res[3]["lastLogon"]), "z")

        # Search by negated disjunction of local attributes
        res = self.ldb.search(expression="(!(|(revision=x)(dnsHostName=x)))",
                              attrs=["dnsHostName", "lastLogon"])
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=B"))
        self.assertTrue(not "dnsHostName" in res[1])
        self.assertEquals(str(res[1]["lastLogon"]), "y")
        self.assertEquals(str(res[2].dn), self.samba4.dn("cn=C"))
        self.assertTrue(not "dnsHostName" in res[2])
        self.assertEquals(str(res[2]["lastLogon"]), "z")
        self.assertEquals(str(res[3].dn), self.samba4.dn("cn=Z"))
        self.assertEquals(str(res[3]["dnsHostName"]), "z")
        self.assertEquals(str(res[3]["lastLogon"]), "z")

        # Search by negated disjunction of remote attributes
        res = self.ldb.search(expression="(!(|(badPwdCount=x)(lastLogon=x)))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 5)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=C"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "z")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=Y"))
        self.assertEquals(str(res[1]["dnsHostName"]), "y")
        self.assertEquals(str(res[1]["lastLogon"]), "y")
        self.assertEquals(str(res[2].dn), self.samba4.dn("cn=Z"))
        self.assertEquals(str(res[2]["dnsHostName"]), "z")
        self.assertEquals(str(res[2]["lastLogon"]), "z")

        # Search by negated disjunction of local and remote attribute
        res = self.ldb.search(expression="(!(|(revision=x)(lastLogon=y)))",
                              attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 5)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=C"))
        self.assertTrue(not "dnsHostName" in res[1])
        self.assertEquals(str(res[1]["lastLogon"]), "z")
        self.assertEquals(str(res[2].dn), self.samba4.dn("cn=Z"))
        self.assertEquals(str(res[2]["dnsHostName"]), "z")
        self.assertEquals(str(res[2]["lastLogon"]), "z")

        # Search by complex parse tree
        res = self.ldb.search(expression="(|(&(revision=x)(dnsHostName=x))(!(&(description=x)(nextRid=y)))(badPwdCount=y))", attrs=["dnsHostName", "lastLogon"])
        self.assertEquals(len(res), 7)
        res = sorted(res, key=attrgetter('dn'))
        self.assertEquals(str(res[0].dn), self.samba4.dn("cn=A"))
        self.assertTrue(not "dnsHostName" in res[0])
        self.assertEquals(str(res[0]["lastLogon"]), "x")
        self.assertEquals(str(res[1].dn), self.samba4.dn("cn=B"))
        self.assertTrue(not "dnsHostName" in res[1])
        self.assertEquals(str(res[1]["lastLogon"]), "y")
        self.assertEquals(str(res[2].dn), self.samba4.dn("cn=C"))
        self.assertTrue(not "dnsHostName" in res[2])
        self.assertEquals(str(res[2]["lastLogon"]), "z")
        self.assertEquals(str(res[3].dn), self.samba4.dn("cn=X"))
        self.assertEquals(str(res[3]["dnsHostName"]), "x")
        self.assertEquals(str(res[3]["lastLogon"]), "x")
        self.assertEquals(str(res[4].dn), self.samba4.dn("cn=Z"))
        self.assertEquals(str(res[4]["dnsHostName"]), "z")
        self.assertEquals(str(res[4]["lastLogon"]), "z")

        # Clean up
        dns = [self.samba4.dn("cn=%s" % n) for n in ["A","B","C","X","Y","Z"]]
        for dn in dns:
            self.ldb.delete(dn)

    def test_map_modify_local(self):
        """Modification of local records."""
        # Add local record
        dn = "cn=test,dc=idealx,dc=org"
        self.ldb.add({"dn": dn,
                 "cn": "test",
                 "foo": "bar",
                 "revision": "1",
                 "description": "test"})
        # Check it's there
        attrs = ["foo", "revision", "description"]
        res = self.ldb.search(dn, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertEquals(str(res[0]["foo"]), "bar")
        self.assertEquals(str(res[0]["revision"]), "1")
        self.assertEquals(str(res[0]["description"]), "test")
        # Check it's not in the local db
        res = self.samba4.db.search(expression="(cn=test)",
                                    scope=SCOPE_DEFAULT, attrs=attrs)
        self.assertEquals(len(res), 0)
        # Check it's not in the remote db
        res = self.samba3.db.search(expression="(cn=test)",
                                    scope=SCOPE_DEFAULT, attrs=attrs)
        self.assertEquals(len(res), 0)

        # Modify local record
        ldif = """
dn: """ + dn + """
replace: foo
foo: baz
replace: description
description: foo
"""
        self.ldb.modify_ldif(ldif)
        # Check in local db
        res = self.ldb.search(dn, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertEquals(str(res[0]["foo"]), "baz")
        self.assertEquals(str(res[0]["revision"]), "1")
        self.assertEquals(str(res[0]["description"]), "foo")

        # Rename local record
        dn2 = "cn=toast,dc=idealx,dc=org"
        self.ldb.rename(dn, dn2)
        # Check in local db
        res = self.ldb.search(dn2, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn2)
        self.assertEquals(str(res[0]["foo"]), "baz")
        self.assertEquals(str(res[0]["revision"]), "1")
        self.assertEquals(str(res[0]["description"]), "foo")

        # Delete local record
        self.ldb.delete(dn2)
        # Check it's gone
        res = self.ldb.search(dn2, scope=SCOPE_BASE)
        self.assertEquals(len(res), 0)

    def test_map_modify_remote_remote(self):
        """Modification of remote data of remote records"""
        # Add remote record
        dn = self.samba4.dn("cn=test")
        dn2 = self.samba3.dn("cn=test")
        self.samba3.db.add({"dn": dn2,
                   "cn": "test",
                   "description": "foo",
                   "sambaBadPasswordCount": "3",
                   "sambaNextRid": "1001"})
        # Check it's there
        res = self.samba3.db.search(dn2, scope=SCOPE_BASE,
                attrs=["description", "sambaBadPasswordCount", "sambaNextRid"])
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn2)
        self.assertEquals(str(res[0]["description"]), "foo")
        self.assertEquals(str(res[0]["sambaBadPasswordCount"]), "3")
        self.assertEquals(str(res[0]["sambaNextRid"]), "1001")
        # Check in mapped db
        attrs = ["description", "badPwdCount", "nextRid"]
        res = self.ldb.search(dn, scope=SCOPE_BASE, attrs=attrs, expression="")
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertEquals(str(res[0]["description"]), "foo")
        self.assertEquals(str(res[0]["badPwdCount"]), "3")
        self.assertEquals(str(res[0]["nextRid"]), "1001")
        # Check in local db
        res = self.samba4.db.search(dn, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 0)

        # Modify remote data of remote record
        ldif = """
dn: """ + dn + """
replace: description
description: test
replace: badPwdCount
badPwdCount: 4
"""
        self.ldb.modify_ldif(ldif)
        # Check in mapped db
        res = self.ldb.search(dn, scope=SCOPE_BASE,
                attrs=["description", "badPwdCount", "nextRid"])
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertEquals(str(res[0]["description"]), "test")
        self.assertEquals(str(res[0]["badPwdCount"]), "4")
        self.assertEquals(str(res[0]["nextRid"]), "1001")
        # Check in remote db
        res = self.samba3.db.search(dn2, scope=SCOPE_BASE,
                attrs=["description", "sambaBadPasswordCount", "sambaNextRid"])
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn2)
        self.assertEquals(str(res[0]["description"]), "test")
        self.assertEquals(str(res[0]["sambaBadPasswordCount"]), "4")
        self.assertEquals(str(res[0]["sambaNextRid"]), "1001")

        # Rename remote record
        dn2 = self.samba4.dn("cn=toast")
        self.ldb.rename(dn, dn2)
        # Check in mapped db
        dn = dn2
        res = self.ldb.search(dn, scope=SCOPE_BASE,
                attrs=["description", "badPwdCount", "nextRid"])
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertEquals(str(res[0]["description"]), "test")
        self.assertEquals(str(res[0]["badPwdCount"]), "4")
        self.assertEquals(str(res[0]["nextRid"]), "1001")
        # Check in remote db
        dn2 = self.samba3.dn("cn=toast")
        res = self.samba3.db.search(dn2, scope=SCOPE_BASE,
                attrs=["description", "sambaBadPasswordCount", "sambaNextRid"])
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn2)
        self.assertEquals(str(res[0]["description"]), "test")
        self.assertEquals(str(res[0]["sambaBadPasswordCount"]), "4")
        self.assertEquals(str(res[0]["sambaNextRid"]), "1001")

        # Delete remote record
        self.ldb.delete(dn)
        # Check in mapped db that it's removed
        res = self.ldb.search(dn, scope=SCOPE_BASE)
        self.assertEquals(len(res), 0)
        # Check in remote db
        res = self.samba3.db.search(dn2, scope=SCOPE_BASE)
        self.assertEquals(len(res), 0)

    def test_map_modify_remote_local(self):
        """Modification of local data of remote records"""
        # Add remote record (same as before)
        dn = self.samba4.dn("cn=test")
        dn2 = self.samba3.dn("cn=test")
        self.samba3.db.add({"dn": dn2,
                   "cn": "test",
                   "description": "foo",
                   "sambaBadPasswordCount": "3",
                   "sambaNextRid": "1001"})

        # Modify local data of remote record
        ldif = """
dn: """ + dn + """
add: revision
revision: 1
replace: description
description: test

"""
        self.ldb.modify_ldif(ldif)
        # Check in mapped db
        attrs = ["revision", "description"]
        res = self.ldb.search(dn, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertEquals(str(res[0]["description"]), "test")
        self.assertEquals(str(res[0]["revision"]), "1")
        # Check in remote db
        res = self.samba3.db.search(dn2, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn2)
        self.assertEquals(str(res[0]["description"]), "test")
        self.assertTrue(not "revision" in res[0])
        # Check in local db
        res = self.samba4.db.search(dn, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertTrue(not "description" in res[0])
        self.assertEquals(str(res[0]["revision"]), "1")

        # Delete (newly) split record
        self.ldb.delete(dn)

    def test_map_modify_split(self):
        """Testing modification of split records"""
        # Add split record
        dn = self.samba4.dn("cn=test")
        dn2 = self.samba3.dn("cn=test")
        self.ldb.add({
            "dn": dn,
            "cn": "test",
            "description": "foo",
            "badPwdCount": "3",
            "nextRid": "1001",
            "revision": "1"})
        # Check it's there
        attrs = ["description", "badPwdCount", "nextRid", "revision"]
        res = self.ldb.search(dn, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertEquals(str(res[0]["description"]), "foo")
        self.assertEquals(str(res[0]["badPwdCount"]), "3")
        self.assertEquals(str(res[0]["nextRid"]), "1001")
        self.assertEquals(str(res[0]["revision"]), "1")
        # Check in local db
        res = self.samba4.db.search(dn, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertTrue(not "description" in res[0])
        self.assertTrue(not "badPwdCount" in res[0])
        self.assertTrue(not "nextRid" in res[0])
        self.assertEquals(str(res[0]["revision"]), "1")
        # Check in remote db
        attrs = ["description", "sambaBadPasswordCount", "sambaNextRid",
                 "revision"]
        res = self.samba3.db.search(dn2, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn2)
        self.assertEquals(str(res[0]["description"]), "foo")
        self.assertEquals(str(res[0]["sambaBadPasswordCount"]), "3")
        self.assertEquals(str(res[0]["sambaNextRid"]), "1001")
        self.assertTrue(not "revision" in res[0])

        # Modify of split record
        ldif = """
dn: """ + dn + """
replace: description
description: test
replace: badPwdCount
badPwdCount: 4
replace: revision
revision: 2
"""
        self.ldb.modify_ldif(ldif)
        # Check in mapped db
        attrs = ["description", "badPwdCount", "nextRid", "revision"]
        res = self.ldb.search(dn, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertEquals(str(res[0]["description"]), "test")
        self.assertEquals(str(res[0]["badPwdCount"]), "4")
        self.assertEquals(str(res[0]["nextRid"]), "1001")
        self.assertEquals(str(res[0]["revision"]), "2")
        # Check in local db
        res = self.samba4.db.search(dn, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertTrue(not "description" in res[0])
        self.assertTrue(not "badPwdCount" in res[0])
        self.assertTrue(not "nextRid" in res[0])
        self.assertEquals(str(res[0]["revision"]), "2")
        # Check in remote db
        attrs = ["description", "sambaBadPasswordCount", "sambaNextRid",
                 "revision"]
        res = self.samba3.db.search(dn2, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn2)
        self.assertEquals(str(res[0]["description"]), "test")
        self.assertEquals(str(res[0]["sambaBadPasswordCount"]), "4")
        self.assertEquals(str(res[0]["sambaNextRid"]), "1001")
        self.assertTrue(not "revision" in res[0])

        # Rename split record
        dn2 = self.samba4.dn("cn=toast")
        self.ldb.rename(dn, dn2)
        # Check in mapped db
        dn = dn2
        attrs = ["description", "badPwdCount", "nextRid", "revision"]
        res = self.ldb.search(dn, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertEquals(str(res[0]["description"]), "test")
        self.assertEquals(str(res[0]["badPwdCount"]), "4")
        self.assertEquals(str(res[0]["nextRid"]), "1001")
        self.assertEquals(str(res[0]["revision"]), "2")
        # Check in local db
        res = self.samba4.db.search(dn, scope=SCOPE_BASE, attrs=attrs)
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn)
        self.assertTrue(not "description" in res[0])
        self.assertTrue(not "badPwdCount" in res[0])
        self.assertTrue(not "nextRid" in res[0])
        self.assertEquals(str(res[0]["revision"]), "2")
        # Check in remote db
        dn2 = self.samba3.dn("cn=toast")
        res = self.samba3.db.search(dn2, scope=SCOPE_BASE,
          attrs=["description", "sambaBadPasswordCount", "sambaNextRid",
                 "revision"])
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0].dn), dn2)
        self.assertEquals(str(res[0]["description"]), "test")
        self.assertEquals(str(res[0]["sambaBadPasswordCount"]), "4")
        self.assertEquals(str(res[0]["sambaNextRid"]), "1001")
        self.assertTrue(not "revision" in res[0])

        # Delete split record
        self.ldb.delete(dn)
        # Check in mapped db
        res = self.ldb.search(dn, scope=SCOPE_BASE)
        self.assertEquals(len(res), 0)
        # Check in local db
        res = self.samba4.db.search(dn, scope=SCOPE_BASE)
        self.assertEquals(len(res), 0)
        # Check in remote db
        res = self.samba3.db.search(dn2, scope=SCOPE_BASE)
        self.assertEquals(len(res), 0)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       # Unix SMB/CIFS implementation.
# Copyright (C) Sean Dague <sdague@linux.vnet.ibm.com
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # Unix SMB/CIFS implementation.
# Copyright (C) Sean Dague <sdague@linux.vnet.ibm.com> 2011
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

# This provides a wrapper around the cmd interface so that tests can
# easily be built on top of it and have minimal code to run basic tests
# of the commands. A list of the environmental variables can be found in
# ~/selftest/selftest.pl
#
# These can all be accesses via os.environ["VARIBLENAME"] when needed

import random
import string
from samba.auth import system_session
from samba.samdb import SamDB
from cStringIO import StringIO
from samba.netcmd.main import cmd_sambatool
import samba.tests

class SambaToolCmdTest(samba.tests.BlackboxTestCase):

    def getSamDB(self, *argv):
        """a convenience function to get a samdb instance so that we can query it"""

        # We build a fake command to get the options created the same
        # way the command classes do it. It would be better if the command
        # classes had a way to more cleanly do this, but this lets us write
        # tests for now
        cmd = cmd_sambatool.subcommands["user"].subcommands["setexpiry"]
        parser, optiongroups = cmd._create_parser("user")
        opts, args = parser.parse_args(list(argv))
        # Filter out options from option groups
        args = args[1:]
        kwargs = dict(opts.__dict__)
        for option_group in parser.option_groups:
            for option in option_group.option_list:
                if option.dest is not None:
                    del kwargs[option.dest]
        kwargs.update(optiongroups)

        H = kwargs.get("H", None)
        sambaopts = kwargs.get("sambaopts", None)
        credopts = kwargs.get("credopts", None)

        lp = sambaopts.get_loadparm()
        creds = credopts.get_credentials(lp, fallback_machine=True)

        samdb = SamDB(url=H, session_info=system_session(),
                      credentials=creds, lp=lp)
        return samdb


    def runcmd(self, name, *args):
        """run a single level command"""
        cmd = cmd_sambatool.subcommands[name]
        cmd.outf = StringIO()
        cmd.errf = StringIO()
        result = cmd._run("samba-tool %s" % name, *args)
        return (result, cmd.outf.getvalue(), cmd.errf.getvalue())

    def runsubcmd(self, name, sub, *args):
        """run a command with sub commands"""
        # The reason we need this function separate from runcmd is
        # that the .outf StringIO assignment is overriden if we use
        # runcmd, so we can't capture stdout and stderr
        cmd = cmd_sambatool.subcommands[name].subcommands[sub]
        cmd.outf = StringIO()
        cmd.errf = StringIO()
        result = cmd._run("samba-tool %s %s" % (name, sub), *args)
        return (result, cmd.outf.getvalue(), cmd.errf.getvalue())

    def assertCmdSuccess(self, exit, out, err, msg=""):
        self.assertIsNone(exit, msg="exit[%s] stdout[%s] stderr[%s]: %s" % (
                          exit, out, err, msg))

    def assertCmdFail(self, val, msg=""):
        self.assertIsNotNone(val, msg)

    def assertMatch(self, base, string, msg=""):
        self.assertTrue(string in base, msg)

    def randomName(self, count=8):
        """Create a random name, cap letters and numbers, and always starting with a letter"""
        name = random.choice(string.ascii_uppercase)
        name += ''.join(random.choice(string.ascii_uppercase + string.ascii_lowercase+ string.digits) for x in range(count - 1))
        return name

    def randomPass(self, count=16):
        name = random.choice(string.ascii_uppercase)
        name += random.choice(string.digits)
        name += random.choice(string.ascii_lowercase)
        name += ''.join(random.choice(string.ascii_uppercase + string.ascii_lowercase+ string.digits) for x in range(count - 3))
        return name

    def randomXid(self):
        # pick some hopefully unused, high UID/GID range to avoid interference
        # from the system the test runs on
        xid = random.randint(4711000, 4799000)
        return xid

    def assertWithin(self, val1, val2, delta, msg=""):
        """Assert that val1 is within delta of val2, useful for time computations"""
        self.assertTrue(((val1 + delta) > val2) and ((val1 - delta) < val2), msg)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 # Unix SMB/CIFS implementation.
# Copyright (C) Rowland Penny <rpenny@samba.org> 2016
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import os, ldb
from samba.tests.samba_tool.base import SambaToolCmdTest

class FsmoCmdTestCase(SambaToolCmdTest):
    """Test for samba-tool fsmo show subcommand"""

    def test_fsmoget(self):
        """Run fsmo show to see if it errors"""
        (result, out, err) = self.runsubcmd("fsmo", "show")

        self.assertCmdSuccess(result, out, err)
        self.assertEquals(err,"","Shouldn't be any error messages")

        # Check that the output is sensible
        samdb = self.getSamDB("-H", "ldap://%s" % os.environ["SERVER"],
            "-U%s%%%s" % (os.environ["USERNAME"], os.environ["PASSWORD"]))

        try:
            res = samdb.search(base=ldb.Dn(samdb, "CN=Infrastructure,DC=DomainDnsZones") + samdb.get_default_basedn(),
                       scope=ldb.SCOPE_BASE, attrs=["fsmoRoleOwner"])

            self.assertTrue("DomainDnsZonesMasterRole owner: " + res[0]["fsmoRoleOwner"][0] in out)
        except ldb.LdbError, (enum, string):
            if enum == ldb.ERR_NO_SUCH_OBJECT:
                self.assertTrue("The 'domaindns' role is not present in this domain" in out)
            else:
                raise

        res = samdb.search(base=samdb.get_default_basedn(),
                           scope=ldb.SCOPE_BASE, attrs=["fsmoRoleOwner"])

        self.assertTrue("DomainNamingMasterRole owner: " + res[0]["fsmoRoleOwner"][0] in out)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 # Unix SMB/CIFS implementation.
# Copyright (C) Andrew Bartlett 2012
#
# based on time.py:
# Copyright (C) Sean Dague <sdague@linux.vnet.ibm.com> 2011
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import os
from samba.tests.samba_tool.base import SambaToolCmdTest
import shutil

class GpoCmdTestCase(SambaToolCmdTest):
    """Tests for samba-tool time subcommands"""

    gpo_name = "testgpo"

    def test_gpo_list(self):
        """Run gpo list against the server and make sure it looks accurate"""
        (result, out, err) = self.runsubcmd("gpo", "listall", "-H", "ldap://%s" % os.environ["SERVER"])
        self.assertCmdSuccess(result, out, err, "Ensuring gpo listall ran successfully")

    def test_fetchfail(self):
        """Run against a non-existent GPO, and make sure it fails (this hard-coded UUID is very unlikely to exist"""
        (result, out, err) = self.runsubcmd("gpo", "fetch", "c25cac17-a02a-4151-835d-fae17446ee43", "-H", "ldap://%s" % os.environ["SERVER"])
        self.assertCmdFail(result, "check for result code")

    def test_fetch(self):
        """Run against a real GPO, and make sure it passes"""
        (result, out, err) = self.runsubcmd("gpo", "fetch", self.gpo_guid, "-H", "ldap://%s" % os.environ["SERVER"], "--tmpdir", self.tempdir)
        self.assertCmdSuccess(result, out, err, "Ensuring gpo fetched successfully")
        shutil.rmtree(os.path.join(self.tempdir, "policy"))

    def test_show(self):
        """Show a real GPO, and make sure it passes"""
        (result, out, err) = self.runsubcmd("gpo", "show", self.gpo_guid, "-H", "ldap://%s" % os.environ["SERVER"])
        self.assertCmdSuccess(result, out, err, "Ensuring gpo fetched successfully")

    def test_show_as_admin(self):
        """Show a real GPO, and make sure it passes"""
        (result, out, err) = self.runsubcmd("gpo", "show", self.gpo_guid, "-H", "ldap://%s" % os.environ["SERVER"], "-U%s%%%s" % (os.environ["USERNAME"], os.environ["PASSWORD"]))
        self.assertCmdSuccess(result, out, err, "Ensuring gpo fetched successfully")

    def test_aclcheck(self):
        """Check all the GPOs on the remote server have correct ACLs"""
        (result, out, err) = self.runsubcmd("gpo", "aclcheck", "-H", "ldap://%s" % os.environ["SERVER"], "-U%s%%%s" % (os.environ["USERNAME"], os.environ["PASSWORD"]))
        self.assertCmdSuccess(result, out, err, "Ensuring gpo checked successfully")

    def setUp(self):
        """set up a temporary GPO to work with"""
        super(GpoCmdTestCase, self).setUp()
        (result, out, err) = self.runsubcmd("gpo", "create", self.gpo_name,
                                            "-H", "ldap://%s" % os.environ["SERVER"],
                                            "-U%s%%%s" % (os.environ["USERNAME"], os.environ["PASSWORD"]),
                                            "--tmpdir", self.tempdir)
        shutil.rmtree(os.path.join(self.tempdir, "policy"))
        self.assertCmdSuccess(result, out, err, "Ensuring gpo created successfully")
        try:
            self.gpo_guid = "{%s}" % out.split("{")[1].split("}")[0]
        except IndexError:
            self.fail("Failed to find GUID in output: %s" % out)

    def tearDown(self):
        """remove the temporary GPO to work with"""
        (result, out, err) = self.runsubcmd("gpo", "del", self.gpo_guid, "-H", "ldap://%s" % os.environ["SERVER"], "-U%s%%%s" % (os.environ["USERNAME"], os.environ["PASSWORD"]))
        self.assertCmdSuccess(result, out, err, "Ensuring gpo deleted successfully")
        super(GpoCmdTestCase, self).tearDown()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # Unix SMB/CIFS implementation.
# Copyright (C) Michael Adam 2012
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import os
import time
import ldb
from samba.tests.samba_tool.base import SambaToolCmdTest
from samba import (
        nttime2unix,
        dsdb
        )

class GroupCmdTestCase(SambaToolCmdTest):
    """Tests for samba-tool group subcommands"""
    groups = []
    samdb = None

    def setUp(self):
        super(GroupCmdTestCase, self).setUp()
        self.samdb = self.getSamDB("-H", "ldap://%s" % os.environ["DC_SERVER"],
            "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
        self.groups = []
        self.groups.append(self._randomGroup({"name": "testgroup1"}))
        self.groups.append(self._randomGroup({"name": "testgroup2"}))
        self.groups.append(self._randomGroup({"name": "testgroup3"}))
        self.groups.append(self._randomGroup({"name": "testgroup4"}))

        # setup the 4 groups and ensure they are correct
        for group in self.groups:
            (result, out, err) = self._create_group(group)

            self.assertCmdSuccess(result, out, err)
            self.assertEquals(err, "", "There shouldn't be any error message")
            self.assertIn("Added group %s" % group["name"], out)

            found = self._find_group(group["name"])

            self.assertIsNotNone(found)

            self.assertEquals("%s" % found.get("name"), group["name"])
            self.assertEquals("%s" % found.get("description"), group["description"])

    def tearDown(self):
        super(GroupCmdTestCase, self).tearDown()
        # clean up all the left over groups, just in case
        for group in self.groups:
            if self._find_group(group["name"]):
                self.runsubcmd("group", "delete", group["name"])


    def test_newgroup(self):
        """This tests the "group add" and "group delete" commands"""
        # try to add all the groups again, this should fail
        for group in self.groups:
            (result, out, err) = self._create_group(group)
            self.assertCmdFail(result, "Succeeded to create existing group")
            self.assertIn("LDAP error 68 LDAP_ENTRY_ALREADY_EXISTS", err)

        # try to delete all the groups we just added
        for group in self.groups:
            (result, out, err) = self.runsubcmd("group", "delete", group["name"])
            self.assertCmdSuccess(result, out, err,
                                  "Failed to delete group '%s'" % group["name"])
            found = self._find_group(group["name"])
            self.assertIsNone(found,
                              "Deleted group '%s' still exists" % group["name"])

        # test adding groups
        for group in self.groups:
            (result, out, err) =  self.runsubcmd("group", "add", group["name"],
                                                 "--description=%s" % group["description"],
                                                 "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                                 "-U%s%%%s" % (os.environ["DC_USERNAME"],
                                                 os.environ["DC_PASSWORD"]))

            self.assertCmdSuccess(result, out, err)
            self.assertEquals(err,"","There shouldn't be any error message")
            self.assertIn("Added group %s" % group["name"], out)

            found = self._find_group(group["name"])

            self.assertEquals("%s" % found.get("samaccountname"),
                              "%s" % group["name"])


    def test_list(self):
        (result, out, err) = self.runsubcmd("group", "list",
                                            "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                            "-U%s%%%s" % (os.environ["DC_USERNAME"],
                                                          os.environ["DC_PASSWORD"]))
        self.assertCmdSuccess(result, out, err, "Error running list")

        search_filter = "(objectClass=group)"

        grouplist = self.samdb.search(base=self.samdb.domain_dn(),
                                      scope=ldb.SCOPE_SUBTREE,
                                      expression=search_filter,
                                      attrs=["samaccountname"])

        self.assertTrue(len(grouplist) > 0, "no groups found in samdb")

        for groupobj in grouplist:
            name = groupobj.get("samaccountname", idx=0)
            found = self.assertMatch(out, name,
                                     "group '%s' not found" % name)

    def test_listmembers(self):
        (result, out, err) = self.runsubcmd("group", "listmembers", "Domain Users",
                                            "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                            "-U%s%%%s" % (os.environ["DC_USERNAME"],
                                                          os.environ["DC_PASSWORD"]))
        self.assertCmdSuccess(result, out, err, "Error running listmembers")

        search_filter = "(|(primaryGroupID=513)(memberOf=CN=Domain Users,CN=Users,%s))" % self.samdb.domain_dn()

        grouplist = self.samdb.search(base=self.samdb.domain_dn(),
                                      scope=ldb.SCOPE_SUBTREE,
                                      expression=search_filter,
                                      attrs=["samAccountName"])

        self.assertTrue(len(grouplist) > 0, "no groups found in samdb")

        for groupobj in grouplist:
            name = groupobj.get("samAccountName", idx=0)
            found = self.assertMatch(out, name, "group '%s' not found" % name)

    def _randomGroup(self, base={}):
        """create a group with random attribute values, you can specify base attributes"""
        group = {
            "name": self.randomName(),
            "description": self.randomName(count=100),
            }
        group.update(base)
        return group

    def _create_group(self, group):
        return self.runsubcmd("group", "add", group["name"],
                              "--description=%s" % group["description"],
                              "-H", "ldap://%s" % os.environ["DC_SERVER"],
                              "-U%s%%%s" % (os.environ["DC_USERNAME"],
                                            os.environ["DC_PASSWORD"]))

    def _find_group(self, name):
        search_filter = ("(&(sAMAccountName=%s)(objectCategory=%s,%s))" %
                         (ldb.binary_encode(name),
                         "CN=Group,CN=Schema,CN=Configuration",
                         self.samdb.domain_dn()))
        grouplist = self.samdb.search(base=self.samdb.domain_dn(),
                                      scope=ldb.SCOPE_SUBTREE,
                                      expression=search_filter,
                                      attrs=[])
        if grouplist:
            return grouplist[0]
        else:
            return None
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      # Unix SMB/CIFS implementation.
# Copyright (C) Andrew Bartlett <abartlet@samba.org> 2016
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import os, ldb
from samba.tests.samba_tool.base import SambaToolCmdTest

class JoinCmdTestCase(SambaToolCmdTest):
    """Test for samba-tool fsmo show subcommand"""

    def test_rejoin(self):
        """Run domain join to confirm it errors because we are already joined"""
        (result, out, err) = self.runsubcmd("domain", "join", os.environ["REALM"], "dc", "-U%s%%%s" % (os.environ["USERNAME"], os.environ["PASSWORD"]))

        self.assertCmdFail(result)
        self.assertTrue("Not removing account" in err,"Should fail with exception")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     # Unix SMB/CIFS implementation.
# Copyright (C) Andrew Bartlett 2012
#
# Based on user.py:
# Copyright (C) Sean Dague <sdague@linux.vnet.ibm.com> 2011
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import os
import time
import ldb
from samba.tests.samba_tool.base import SambaToolCmdTest
import random

class NtACLCmdSysvolTestCase(SambaToolCmdTest):
    """Tests for samba-tool ntacl sysvol* subcommands"""


    def test_ntvfs(self):
        (result, out, err) =  self.runsubcmd("ntacl", "sysvolreset",
                                             "--use-ntvfs")
        self.assertCmdSuccess(result, out, err)
        self.assertEquals(out,"","Shouldn't be any output messages")
        self.assertIn("Please note that POSIX permissions have NOT been changed, only the stored NT ACL", err)

    def test_s3fs(self):
        (result, out, err) =  self.runsubcmd("ntacl", "sysvolreset",
                                             "--use-s3fs")

        self.assertCmdSuccess(result, out, err)
        self.assertEquals(err,"","Shouldn't be any error messages")
        self.assertEquals(out,"","Shouldn't be any output messages")

    def test_ntvfs_check(self):
        (result, out, err) =  self.runsubcmd("ntacl", "sysvolreset",
                                             "--use-ntvfs")
        self.assertCmdSuccess(result, out, err)
        self.assertEquals(out,"","Shouldn't be any output messages")
        self.assertIn("Please note that POSIX permissions have NOT been changed, only the stored NT ACL", err)
        # Now check they were set correctly
        (result, out, err) =  self.runsubcmd("ntacl", "sysvolcheck")
        self.assertCmdSuccess(result, out, err)
        self.assertEquals(err,"","Shouldn't be any error messages")
        self.assertEquals(out,"","Shouldn't be any output messages")

    def test_s3fs_check(self):
        (result, out, err) =  self.runsubcmd("ntacl", "sysvolreset",
                                             "--use-s3fs")

        self.assertCmdSuccess(result, out, err)
        self.assertEquals(err,"","Shouldn't be any error messages")
        self.assertEquals(out,"","Shouldn't be any output messages")

        # Now check they were set correctly
        (result, out, err) =  self.runsubcmd("ntacl", "sysvolcheck")
        self.assertCmdSuccess(result, out, err)
        self.assertEquals(err,"","Shouldn't be any error messages")
        self.assertEquals(out,"","Shouldn't be any output messages")

class NtACLCmdGetSetTestCase(SambaToolCmdTest):
    """Tests for samba-tool ntacl get/set subcommands"""

    acl = "O:DAG:DUD:P(A;OICI;0x001f01ff;;;DA)(A;OICI;0x001f01ff;;;EA)(A;OICIIO;0x001f01ff;;;CO)(A;OICI;0x001f01ff;;;DA)(A;OICI;0x001f01ff;;;SY)(A;OICI;0x001200a9;;;AU)(A;OICI;0x001200a9;;;ED)S:AI(OU;CIIDSA;WP;f30e3bbe-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIDSA;WP;f30e3bbf-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)"


    def test_ntvfs(self):
        path = os.environ['SELFTEST_PREFIX']
        tempf = os.path.join(path,"pytests"+str(int(100000*random.random())))
        open(tempf, 'w').write("empty")

        (result, out, err) =  self.runsubcmd("ntacl", "set", self.acl, tempf,
                                             "--use-ntvfs")
        self.assertCmdSuccess(result, out, err)
        self.assertEquals(out,"","Shouldn't be any output messages")
        self.assertIn("Please note that POSIX permissions have NOT been changed, only the stored NT ACL", err)

    def test_s3fs(self):
        path = os.environ['SELFTEST_PREFIX']
        tempf = os.path.join(path,"pytests"+str(int(100000*random.random())))
        open(tempf, 'w').write("empty")

        (result, out, err) =  self.runsubcmd("ntacl", "set", self.acl, tempf,
                                             "--use-s3fs")

        self.assertCmdSuccess(result, out, err)
        self.assertEquals(err,"","Shouldn't be any error messages")
        self.assertEquals(out,"","Shouldn't be any output messages")

    def test_ntvfs_check(self):
        path = os.environ['SELFTEST_PREFIX']
        tempf = os.path.join(path,"pytests"+str(int(100000*random.random())))
        open(tempf, 'w').write("empty")

        (result, out, err) =  self.runsubcmd("ntacl", "set", self.acl, tempf,
                                             "--use-ntvfs")
        self.assertCmdSuccess(result, out, err)
        self.assertEquals(out,"","Shouldn't be any output messages")
        self.assertIn("Please note that POSIX permissions have NOT been changed, only the stored NT ACL", err)

        # Now check they were set correctly
        (result, out, err) =  self.runsubcmd("ntacl",  "get", tempf,
                                             "--use-ntvfs", "--as-sddl")
        self.assertCmdSuccess(result, out, err)
        self.assertEquals(err,"","Shouldn't be any error messages")
        self.assertEquals(self.acl+"\n", out, "Output should be the ACL")

    def test_s3fs_check(self):
        path = os.environ['SELFTEST_PREFIX']
        tempf = os.path.join(path,"pytests"+str(int(100000*random.random())))
        open(tempf, 'w').write("empty")

        (result, out, err) =  self.runsubcmd("ntacl", "set", self.acl, tempf,
                                             "--use-s3fs")
        self.assertCmdSuccess(result, out, err)
        self.assertEquals(out,"","Shouldn't be any output messages")
        self.assertEquals(err,"","Shouldn't be any error messages")

        # Now check they were set correctly
        (result, out, err) =  self.runsubcmd("ntacl",  "get", tempf,
                                             "--use-s3fs", "--as-sddl")
        self.assertCmdSuccess(result, out, err)
        self.assertEquals(err,"","Shouldn't be any error messages")
        self.assertEquals(self.acl+"\n", out,"Output should be the ACL")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               # Unix SMB/CIFS implementation.
# Copyright (C) Andrew Bartlett 2012
#
# based on time.py:
# Copyright (C) Sean Dague <sdague@linux.vnet.ibm.com> 2011
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import os
from samba.tests.samba_tool.base import SambaToolCmdTest

class ProcessCmdTestCase(SambaToolCmdTest):
    """Tests for samba-tool process subcommands"""

    def test_name(self):
        """Run processes command"""
        (result, out, err) = self.runcmd("processes", "--name", "samba")
        self.assertCmdSuccess(result, out, err, "Ensuring processes ran successfully")

    def test_all(self):
        """Run processes command"""
        (result, out, err) = self.runcmd("processes")
        self.assertCmdSuccess(result, out, err, "Ensuring processes ran successfully")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               # Unix SMB/CIFS implementation.
# Copyright (C) Catalyst IT Ltd. 2015
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import os
import ldb
import samba
from samba.samdb import SamDB
from samba.tests import delete_force
from samba.tests.samba_tool.base import SambaToolCmdTest
from samba.credentials import Credentials
from samba.auth import system_session

class RodcCmdTestCase(SambaToolCmdTest):
    def setUp(self):
        super(RodcCmdTestCase, self).setUp()
        self.lp = samba.param.LoadParm()
        self.lp.load(os.environ["SMB_CONF_PATH"])
        self.creds = Credentials()
        self.creds.set_username(os.environ["DC_USERNAME"])
        self.creds.set_password(os.environ["DC_PASSWORD"])
        self.creds.guess(self.lp)
        self.session = system_session()
        self.ldb = SamDB("ldap://" + os.environ["DC_SERVER"],
            session_info=self.session, credentials=self.creds,lp=self.lp)

        self.base_dn = self.ldb.domain_dn()

        self.ldb.newuser("sambatool1", "1qazXSW@")
        self.ldb.newuser("sambatool2", "2wsxCDE#")
        self.ldb.newuser("sambatool3", "3edcVFR$")
        self.ldb.newuser("sambatool4", "4rfvBGT%")
        self.ldb.newuser("sambatool5", "5tjbNHY*")
        self.ldb.newuser("sambatool6", "6yknMJU*")

        self.ldb.add_remove_group_members("Allowed RODC Password Replication Group",
                                          ["sambatool1", "sambatool2", "sambatool3",
                                           "sambatool4", "sambatool5"],
                                          add_members_operation=True)

    def tearDown(self):
        super(RodcCmdTestCase, self).tearDown()
        self.ldb.deleteuser("sambatool1")
        self.ldb.deleteuser("sambatool2")
        self.ldb.deleteuser("sambatool3")
        self.ldb.deleteuser("sambatool4")
        self.ldb.deleteuser("sambatool5")
        self.ldb.deleteuser("sambatool6")
        (result, out, err) = self.runsubcmd("drs", "replicate", "--local", "unused",
                                            os.environ["DC_SERVER"], self.base_dn)


    def test_single_by_account_name(self):
        (result, out, err) = self.runsubcmd("rodc", "preload", "sambatool1",
                                            "--server", os.environ["DC_SERVER"])
        self.assertCmdSuccess(result, out, err, "ensuring rodc prefetch ran successfully")
        self.assertEqual(out, "Replicating DN CN=sambatool1,CN=Users,%s\n" % self.base_dn)
        self.assertEqual(err, "")

    def test_single_by_dn(self):
        (result, out, err) = self.runsubcmd("rodc", "preload", "cn=sambatool2,cn=users,%s" % self.base_dn,
                                            "--server", os.environ["DC_SERVER"])
        self.assertCmdSuccess(result, out, err, "ensuring rodc prefetch ran successfully")
        self.assertEqual(out, "Replicating DN CN=sambatool2,CN=Users,%s\n" % self.base_dn)

    def test_multi_by_account_name(self):
        (result, out, err) = self.runsubcmd("rodc", "preload", "sambatool1", "sambatool2",
                                            "--server", os.environ["DC_SERVER"])
        self.assertCmdSuccess(result, out, err, "ensuring rodc prefetch ran successfully")
        self.assertEqual(out, "Replicating DN CN=sambatool1,CN=Users,%s\nReplicating DN CN=sambatool2,CN=Users,%s\n" % (self.base_dn, self.base_dn))

    def test_multi_by_dn(self):
        (result, out, err) = self.runsubcmd("rodc", "preload", "cn=sambatool3,cn=users,%s" % self.base_dn, "cn=sambatool4,cn=users,%s" % self.base_dn,
                                            "--server", os.environ["DC_SERVER"])
        self.assertCmdSuccess(result, out, err, "ensuring rodc prefetch ran successfully")
        self.assertEqual(out, "Replicating DN CN=sambatool3,CN=Users,%s\nReplicating DN CN=sambatool4,CN=Users,%s\n" % (self.base_dn, self.base_dn))

    def test_multi_in_file(self):
        tempf = os.path.join(self.tempdir, "accountlist")
        open(tempf, 'w').write("sambatool1\nsambatool2")
        (result, out, err) = self.runsubcmd("rodc", "preload", "--file", tempf,
                                            "--server", os.environ["DC_SERVER"])
        self.assertCmdSuccess(result, out, err, "ensuring rodc prefetch ran successfully")
        self.assertEqual(out, "Replicating DN CN=sambatool1,CN=Users,%s\nReplicating DN CN=sambatool2,CN=Users,%s\n" % (self.base_dn, self.base_dn))
        os.unlink(tempf)

    def test_multi_with_missing_name_success(self):
        (result, out, err) = self.runsubcmd("rodc", "preload",
                                            "nonexistentuser1", "sambatool5",
                                            "nonexistentuser2",
                                            "--server", os.environ["DC_SERVER"],
                                            "--ignore-errors")
        self.assertCmdSuccess(result, out, err, "ensuring rodc prefetch ran successfully")
        self.assertEqual(out, "Replicating DN CN=sambatool5,CN=Users,%s\n" % self.base_dn)

    def test_multi_with_missing_name_failure(self):
        (result, out, err) = self.runsubcmd("rodc", "preload",
                                            "nonexistentuser1", "sambatool5",
                                            "nonexistentuser2",
                                            "--server", os.environ["DC_SERVER"])
        self.assertCmdFail(result, "ensuring rodc prefetch quit on missing user")

    def test_multi_without_group_success(self):
        (result, out, err) = self.runsubcmd("rodc", "preload",
                                            "sambatool6", "sambatool5",
                                            "--server", os.environ["DC_SERVER"],
                                            "--ignore-errors")
        self.assertCmdSuccess(result, out, err, "ensuring rodc prefetch ran successfully")
        self.assertEqual(out, "Replicating DN CN=sambatool6,CN=Users,%s\nReplicating DN CN=sambatool5,CN=Users,%s\n" % (self.base_dn, self.base_dn))

    def test_multi_without_group_failure(self):
        (result, out, err) = self.runsubcmd("rodc", "preload",
                                            "sambatool6", "sambatool5",
                                            "--server", os.environ["DC_SERVER"])
        self.assertCmdFail(result, "ensuring rodc prefetch quit on non-replicated user")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       # Unix SMB/CIFS implementation.
# Copyright (C) Catalyst.Net LTD 2015
# Copyright (C) Sean Dague <sdague@linux.vnet.ibm.com> 2011
#
# Catalyst.Net's contribution was written by Douglas Bagnall
# <douglas.bagnall@catalyst.net.nz>.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import os
import ldb
from samba.tests.samba_tool.base import SambaToolCmdTest
from samba import sites


class BaseSitesCmdTestCase(SambaToolCmdTest):
    """Tests for samba-tool sites subnets"""
    def setUp(self):
        super(BaseSitesCmdTestCase, self).setUp()
        self.dburl = "ldap://%s" % os.environ["DC_SERVER"]
        self.creds_string = "-U%s%%%s" % (os.environ["DC_USERNAME"],
                                          os.environ["DC_PASSWORD"])

        self.samdb = self.getSamDB("-H", self.dburl, self.creds_string)
        self.config_dn = str(self.samdb.get_config_basedn())


class SitesCmdTestCase(BaseSitesCmdTestCase):

    def test_site_create(self):
        sitename = 'new_site'

        result, out, err = self.runsubcmd("sites", "create", sitename,
                                          "-H", self.dburl, self.creds_string)
        self.assertCmdSuccess(result, out, err)

        dnsites = ldb.Dn(self.samdb, "CN=Sites,%s" % self.config_dn)
        dnsite = ldb.Dn(self.samdb, "CN=%s,%s" % (sitename, dnsites))

        ret = self.samdb.search(base=dnsites, scope=ldb.SCOPE_ONELEVEL,
                                expression='(dn=%s)' % str(dnsite))
        self.assertEquals(len(ret), 1)

        # now delete it
        self.samdb.delete(dnsite, ["tree_delete:0"])


class SitesSubnetCmdTestCase(BaseSitesCmdTestCase):
    def setUp(self):
        super(SitesSubnetCmdTestCase, self).setUp()
        self.sitename = "testsite"
        self.sitename2 = "testsite2"
        self.samdb.transaction_start()
        sites.create_site(self.samdb, self.config_dn, self.sitename)
        sites.create_site(self.samdb, self.config_dn, self.sitename2)
        self.samdb.transaction_commit()

    def tearDown(self):
        self.samdb.transaction_start()
        sites.delete_site(self.samdb, self.config_dn, self.sitename)
        sites.delete_site(self.samdb, self.config_dn, self.sitename2)
        self.samdb.transaction_commit()
        super(SitesSubnetCmdTestCase, self).tearDown()

    def test_site_subnet_create(self):
        cidrs = (("10.9.8.0/24", self.sitename),
                 ("50.60.0.0/16", self.sitename2),
                 ("50.61.0.0/16", self.sitename2), # second subnet on the site
                 ("50.0.0.0/8", self.sitename), # overlapping subnet, other site
                 ("50.62.1.2/32", self.sitename), # single IP
                 ("aaaa:bbbb:cccc:dddd:eeee:ffff:2222:1100/120",
                  self.sitename2),
             )

        for cidr, sitename in cidrs:
            result, out, err = self.runsubcmd("sites", "subnet", "create",
                                              cidr, sitename,
                                              "-H", self.dburl,
                                              self.creds_string)
            self.assertCmdSuccess(result, out, err)

            ret = self.samdb.search(base=self.config_dn,
                                    scope=ldb.SCOPE_SUBTREE,
                                    expression=('(&(objectclass=subnet)(cn=%s))'
                                                % cidr))
            self.assertIsNotNone(ret)
            self.assertEqual(len(ret), 1)

        dnsubnets = ldb.Dn(self.samdb,
                           "CN=Subnets,CN=Sites,%s" % self.config_dn)

        for cidr, sitename in cidrs:
            dnsubnet = ldb.Dn(self.samdb, ("Cn=%s,CN=Subnets,CN=Sites,%s" %
                                           (cidr, self.config_dn)))

            ret = self.samdb.search(base=dnsubnets, scope=ldb.SCOPE_ONELEVEL,
                                    expression='(dn=%s)' % dnsubnet)
            self.assertIsNotNone(ret)
            self.assertEqual(len(ret), 1)
            self.samdb.delete(dnsubnet, ["tree_delete:0"])

    def test_site_subnet_create_should_fail(self):
        cidrs = (("10.9.8.0/33", self.sitename),    # mask too big
                 ("50.60.0.0/8", self.sitename2),   # insufficient zeros
                 ("50.261.0.0/16", self.sitename2), # bad octet
                 ("7.0.0.0.0/0", self.sitename),    # insufficient zeros
                 ("aaaa:bbbb:cccc:dddd:eeee:ffff:2222:1100/119",
                  self.sitename),                   # insufficient zeros
             )

        for cidr, sitename in cidrs:
            result, out, err = self.runsubcmd("sites", "subnet", "create",
                                              cidr, sitename,
                                              "-H", self.dburl,
                                              self.creds_string)
            self.assertCmdFail(result)

            ret = self.samdb.search(base=self.config_dn,
                                    scope=ldb.SCOPE_SUBTREE,
                                    expression=('(&(objectclass=subnet)(cn=%s))'
                                                % cidr))

            self.assertIsNotNone(ret)
            self.assertEqual(len(ret), 0)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       # Unix SMB/CIFS implementation.
# Copyright (C) Sean Dague <sdague@linux.vnet.ibm.com> 2011
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import os
from time import localtime, strptime, mktime
from samba.tests.samba_tool.base import SambaToolCmdTest

class TimeCmdTestCase(SambaToolCmdTest):
    """Tests for samba-tool time subcommands"""

    def test_timeget(self):
        """Run time against the server and make sure it looks accurate"""
        (result, out, err) = self.runcmd("time", os.environ["SERVER"])
        self.assertCmdSuccess(result, out, err, "Ensuring time ran successfully")

        timefmt = strptime(out, "%a %b %d %H:%M:%S %Y %Z\n")
        servertime = int(mktime(timefmt))
        now = int(mktime(localtime()))

        # because there is a race here, allow up to 5 seconds difference in times
        delta = 5
        self.assertTrue((servertime > (now - delta) and (servertime < (now + delta)), "Time is now"))

    def test_timefail(self):
        """Run time against a non-existent server, and make sure it fails"""
        (result, out, err) = self.runcmd("time", "notaserver")
        self.assertEquals(result, -1, "check for result code")
        self.assertNotEqual(err.strip().find("NT_STATUS_OBJECT_NAME_NOT_FOUND"), -1, "ensure right error string")
        self.assertEquals(out, "", "ensure no output returned")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      # Unix SMB/CIFS implementation.
# Copyright (C) Sean Dague <sdague@linux.vnet.ibm.com> 2011
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import os
import time
import base64
import ldb
from samba.tests.samba_tool.base import SambaToolCmdTest
from samba import (
        credentials,
        nttime2unix,
        dsdb
        )
from samba.ndr import ndr_unpack
from samba.dcerpc import drsblobs

class UserCmdTestCase(SambaToolCmdTest):
    """Tests for samba-tool user subcommands"""
    users = []
    samdb = None

    def setUp(self):
        super(UserCmdTestCase, self).setUp()
        self.samdb = self.getSamDB("-H", "ldap://%s" % os.environ["DC_SERVER"],
            "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
        self.users = []
        self.users.append(self._randomUser({"name": "sambatool1", "company": "comp1"}))
        self.users.append(self._randomUser({"name": "sambatool2", "company": "comp1"}))
        self.users.append(self._randomUser({"name": "sambatool3", "company": "comp2"}))
        self.users.append(self._randomUser({"name": "sambatool4", "company": "comp2"}))
        self.users.append(self._randomPosixUser({"name": "posixuser1"}))
        self.users.append(self._randomPosixUser({"name": "posixuser2"}))
        self.users.append(self._randomPosixUser({"name": "posixuser3"}))
        self.users.append(self._randomPosixUser({"name": "posixuser4"}))

        # setup the 8 users and ensure they are correct
        for user in self.users:
            (result, out, err) = user["createUserFn"](user)

            self.assertCmdSuccess(result, out, err)
            self.assertEquals(err,"","Shouldn't be any error messages")
            self.assertIn("User '%s' created successfully" % user["name"], out)

            user["checkUserFn"](user)


    def tearDown(self):
        super(UserCmdTestCase, self).tearDown()
        # clean up all the left over users, just in case
        for user in self.users:
            if self._find_user(user["name"]):
                self.runsubcmd("user", "delete", user["name"])


    def test_newuser(self):
        # try to add all the users again, this should fail
        for user in self.users:
            (result, out, err) = self._create_user(user)
            self.assertCmdFail(result, "Ensure that create user fails")
            self.assertIn("LDAP error 68 LDAP_ENTRY_ALREADY_EXISTS", err)

        # try to delete all the 4 users we just added
        for user in self.users:
            (result, out, err) = self.runsubcmd("user", "delete", user["name"])
            self.assertCmdSuccess(result, out, err, "Can we delete users")
            found = self._find_user(user["name"])
            self.assertIsNone(found)

        # test adding users with --use-username-as-cn
        for user in self.users:
            (result, out, err) =  self.runsubcmd("user", "add", user["name"], user["password"],
                                                 "--use-username-as-cn",
                                                 "--surname=%s" % user["surname"],
                                                 "--given-name=%s" % user["given-name"],
                                                 "--job-title=%s" % user["job-title"],
                                                 "--department=%s" % user["department"],
                                                 "--description=%s" % user["description"],
                                                 "--company=%s" % user["company"],
                                                 "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                                 "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))

            self.assertCmdSuccess(result, out, err)
            self.assertEquals(err,"","Shouldn't be any error messages")
            self.assertIn("User '%s' created successfully" % user["name"], out)

            found = self._find_user(user["name"])

            self.assertEquals("%s" % found.get("cn"), "%(name)s" % user)
            self.assertEquals("%s" % found.get("name"), "%(name)s" % user)

    def _verify_supplementalCredentials(self, ldif,
                                        min_packages=3,
                                        max_packages=6):
        msgs = self.samdb.parse_ldif(ldif)
        (changetype, obj) = next(msgs)

        self.assertIn("supplementalCredentials", obj, "supplementalCredentials attribute required")
        sc_blob = obj["supplementalCredentials"][0]
        sc = ndr_unpack(drsblobs.supplementalCredentialsBlob, sc_blob)

        self.assertGreaterEqual(sc.sub.num_packages,
                                min_packages, "min_packages check")
        self.assertLessEqual(sc.sub.num_packages,
                             max_packages, "max_packages check")

        if max_packages == 0:
            return

        def find_package(packages, name, start_idx=0):
            for i in xrange(start_idx, len(packages)):
                if packages[i].name == name:
                    return (i, packages[i])
            return (None, None)

        # The ordering is this
        #
        # Primary:Kerberos-Newer-Keys (optional)
        # Primary:Kerberos
        # Primary:WDigest
        # Primary:CLEARTEXT (optional)
        # Primary:SambaGPG (optional)
        #
        # And the 'Packages' package is insert before the last
        # other package.

        nidx = 0
        (pidx, pp) = find_package(sc.sub.packages, "Packages", start_idx=nidx)
        self.assertIsNotNone(pp, "Packages required")
        self.assertEqual(pidx + 1, sc.sub.num_packages - 1,
                         "Packages needs to be at num_packages - 1")

        (knidx, knp) = find_package(sc.sub.packages, "Primary:Kerberos-Newer-Keys",
                                    start_idx=nidx)
        if knidx is not None:
            self.assertEqual(knidx, nidx, "Primary:Kerberos-Newer-Keys at wrong position")
            nidx = nidx + 1
            if nidx == pidx:
                nidx = nidx + 1

        (kidx, kp) = find_package(sc.sub.packages, "Primary:Kerberos",
                                    start_idx=nidx)
        self.assertIsNotNone(pp, "Primary:Kerberos required")
        self.assertEqual(kidx, nidx, "Primary:Kerberos at wrong position")
        nidx = nidx + 1
        if nidx == pidx:
            nidx = nidx + 1

        (widx, wp) = find_package(sc.sub.packages, "Primary:WDigest",
                                  start_idx=nidx)
        self.assertIsNotNone(pp, "Primary:WDigest required")
        self.assertEqual(widx, nidx, "Primary:WDigest at wrong position")
        nidx = nidx + 1
        if nidx == pidx:
            nidx = nidx + 1

        (cidx, cp) = find_package(sc.sub.packages, "Primary:CLEARTEXT",
                                    start_idx=nidx)
        if cidx is not None:
            self.assertEqual(cidx, nidx, "Primary:CLEARTEXT at wrong position")
            nidx = nidx + 1
            if nidx == pidx:
                nidx = nidx + 1

        (gidx, gp) = find_package(sc.sub.packages, "Primary:SambaGPG",
                                  start_idx=nidx)
        if gidx is not None:
            self.assertEqual(gidx, nidx, "Primary:SambaGPG at wrong position")
            nidx = nidx + 1
            if nidx == pidx:
                nidx = nidx + 1

        self.assertEqual(nidx, sc.sub.num_packages, "Unknown packages found")

    def test_setpassword(self):
        for user in self.users:
            newpasswd = self.randomPass()
            (result, out, err) = self.runsubcmd("user", "setpassword",
                                                user["name"],
                                                "--newpassword=%s" % newpasswd,
                                                "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                                "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
            self.assertCmdSuccess(result, out, err, "Ensure setpassword runs")
            self.assertEquals(err,"","setpassword with url")
            self.assertMatch(out, "Changed password OK", "setpassword with url")

        attributes = "sAMAccountName,unicodePwd,supplementalCredentials,virtualClearTextUTF8,virtualClearTextUTF16,virtualSSHA,virtualSambaGPG"
        (result, out, err) = self.runsubcmd("user", "syncpasswords",
                                            "--cache-ldb-initialize",
                                            "--attributes=%s" % attributes,
                                            "--decrypt-samba-gpg")
        self.assertCmdSuccess(result, out, err, "Ensure syncpasswords --cache-ldb-initialize runs")
        self.assertEqual(err,"","getpassword without url")
        cache_attrs = {
            "objectClass": { "value": "userSyncPasswords" },
            "samdbUrl": { },
            "dirsyncFilter": { },
            "dirsyncAttribute": { },
            "dirsyncControl": { "value": "dirsync:1:0:0"},
            "passwordAttribute": { },
            "decryptSambaGPG": { },
            "currentTime": { },
        }
        for a in cache_attrs.keys():
            v = cache_attrs[a].get("value", "")
            self.assertMatch(out, "%s: %s" % (a, v),
                "syncpasswords --cache-ldb-initialize: %s: %s out[%s]" % (a, v, out))

        (result, out, err) = self.runsubcmd("user", "syncpasswords", "--no-wait")
        self.assertCmdSuccess(result, out, err, "Ensure syncpasswords --no-wait runs")
        self.assertEqual(err,"","syncpasswords --no-wait")
        self.assertMatch(out, "dirsync_loop(): results 0",
            "syncpasswords --no-wait: 'dirsync_loop(): results 0': out[%s]" % (out))
        for user in self.users:
            self.assertMatch(out, "sAMAccountName: %s" % (user["name"]),
                "syncpasswords --no-wait: 'sAMAccountName': %s out[%s]" % (user["name"], out))

        for user in self.users:
            newpasswd = self.randomPass()
            creds = credentials.Credentials()
            creds.set_anonymous()
            creds.set_password(newpasswd)
            nthash = creds.get_nt_hash()
            unicodePwd = base64.b64encode(creds.get_nt_hash())
            virtualClearTextUTF8 = base64.b64encode(newpasswd)
            virtualClearTextUTF16 = base64.b64encode(unicode(newpasswd, 'utf-8').encode('utf-16-le'))

            (result, out, err) = self.runsubcmd("user", "setpassword",
                                                user["name"],
                                                "--newpassword=%s" % newpasswd)
            self.assertCmdSuccess(result, out, err, "Ensure setpassword runs")
            self.assertEquals(err,"","setpassword without url")
            self.assertMatch(out, "Changed password OK", "setpassword without url")

            (result, out, err) = self.runsubcmd("user", "syncpasswords", "--no-wait")
            self.assertCmdSuccess(result, out, err, "Ensure syncpasswords --no-wait runs")
            self.assertEqual(err,"","syncpasswords --no-wait")
            self.assertMatch(out, "dirsync_loop(): results 0",
                "syncpasswords --no-wait: 'dirsync_loop(): results 0': out[%s]" % (out))
            self.assertMatch(out, "sAMAccountName: %s" % (user["name"]),
                "syncpasswords --no-wait: 'sAMAccountName': %s out[%s]" % (user["name"], out))
            self.assertMatch(out, "# unicodePwd::: REDACTED SECRET ATTRIBUTE",
                    "getpassword '# unicodePwd::: REDACTED SECRET ATTRIBUTE': out[%s]" % out)
            self.assertMatch(out, "unicodePwd:: %s" % unicodePwd,
                    "getpassword unicodePwd: out[%s]" % out)
            self.assertMatch(out, "# supplementalCredentials::: REDACTED SECRET ATTRIBUTE",
                    "getpassword '# supplementalCredentials::: REDACTED SECRET ATTRIBUTE': out[%s]" % out)
            self.assertMatch(out, "supplementalCredentials:: ",
                    "getpassword supplementalCredentials: out[%s]" % out)
            if "virtualSambaGPG:: " in out:
                self.assertMatch(out, "virtualClearTextUTF8:: %s" % virtualClearTextUTF8,
                    "getpassword virtualClearTextUTF8: out[%s]" % out)
                self.assertMatch(out, "virtualClearTextUTF16:: %s" % virtualClearTextUTF16,
                    "getpassword virtualClearTextUTF16: out[%s]" % out)
                self.assertMatch(out, "virtualSSHA: ",
                    "getpassword virtualSSHA: out[%s]" % out)

            (result, out, err) = self.runsubcmd("user", "getpassword",
                                                user["name"],
                                                "--attributes=%s" % attributes,
                                                "--decrypt-samba-gpg")
            self.assertCmdSuccess(result, out, err, "Ensure getpassword runs")
            self.assertEqual(err,"","getpassword without url")
            self.assertMatch(out, "Got password OK", "getpassword without url")
            self.assertMatch(out, "sAMAccountName: %s" % (user["name"]),
                    "getpassword: 'sAMAccountName': %s out[%s]" % (user["name"], out))
            self.assertMatch(out, "unicodePwd:: %s" % unicodePwd,
                    "getpassword unicodePwd: out[%s]" % out)
            self.assertMatch(out, "supplementalCredentials:: ",
                    "getpassword supplementalCredentials: out[%s]" % out)
            self._verify_supplementalCredentials(out.replace("\nGot password OK\n", ""))
            if "virtualSambaGPG:: " in out:
                self.assertMatch(out, "virtualClearTextUTF8:: %s" % virtualClearTextUTF8,
                    "getpassword virtualClearTextUTF8: out[%s]" % out)
                self.assertMatch(out, "virtualClearTextUTF16:: %s" % virtualClearTextUTF16,
                    "getpassword virtualClearTextUTF16: out[%s]" % out)
                self.assertMatch(out, "virtualSSHA: ",
                    "getpassword virtualSSHA: out[%s]" % out)

        for user in self.users:
            newpasswd = self.randomPass()
            (result, out, err) = self.runsubcmd("user", "setpassword",
                                                user["name"],
                                                "--newpassword=%s" % newpasswd,
                                                "--must-change-at-next-login",
                                                "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                                "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
            self.assertCmdSuccess(result, out, err, "Ensure setpassword runs")
            self.assertEquals(err,"","setpassword with forced change")
            self.assertMatch(out, "Changed password OK", "setpassword with forced change")




    def test_setexpiry(self):
        twodays = time.time() + (2 * 24 * 60 * 60)

        for user in self.users:
            (result, out, err) = self.runsubcmd("user", "setexpiry", user["name"],
                                                "--days=2",
                                                "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                                "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
            self.assertCmdSuccess(result, out, err, "Can we run setexpiry with names")
            self.assertIn("Expiry for user '%s' set to 2 days." % user["name"], out)

        for user in self.users:
            found = self._find_user(user["name"])

            expires = nttime2unix(int("%s" % found.get("accountExpires")))
            self.assertWithin(expires, twodays, 5, "Ensure account expires is within 5 seconds of the expected time")

        # TODO: renable this after the filter case is sorted out
        if "filters are broken, bail now":
            return

        # now run the expiration based on a filter
        fourdays = time.time() + (4 * 24 * 60 * 60)
        (result, out, err) = self.runsubcmd("user", "setexpiry",
                                                "--filter", "(&(objectClass=user)(company=comp2))",
                                                "--days=4",
                                                "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                                "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
        self.assertCmdSuccess(result, out, err, "Can we run setexpiry with a filter")

        for user in self.users:
            found = self._find_user(user["name"])
            if ("%s" % found.get("company")) == "comp2":
                expires = nttime2unix(int("%s" % found.get("accountExpires")))
                self.assertWithin(expires, fourdays, 5, "Ensure account expires is within 5 seconds of the expected time")
            else:
                expires = nttime2unix(int("%s" % found.get("accountExpires")))
                self.assertWithin(expires, twodays, 5, "Ensure account expires is within 5 seconds of the expected time")


    def test_list(self):
        (result, out, err) = self.runsubcmd("user", "list",
                                            "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                            "-U%s%%%s" % (os.environ["DC_USERNAME"],
                                                          os.environ["DC_PASSWORD"]))
        self.assertCmdSuccess(result, out, err, "Error running list")

        search_filter = ("(&(objectClass=user)(userAccountControl:%s:=%u))" %
                         (ldb.OID_COMPARATOR_AND, dsdb.UF_NORMAL_ACCOUNT))

        userlist = self.samdb.search(base=self.samdb.domain_dn(),
                                     scope=ldb.SCOPE_SUBTREE,
                                     expression=search_filter,
                                     attrs=["samaccountname"])

        self.assertTrue(len(userlist) > 0, "no users found in samdb")

        for userobj in userlist:
            name = userobj.get("samaccountname", idx=0)
            found = self.assertMatch(out, name,
                                     "user '%s' not found" % name)
    def test_getpwent(self):
        try:
            import pwd
        except ImportError:
            self.skipTest("Skipping getpwent test, no 'pwd' module available")
            return

        # get the current user's data for the test
        uid = os.geteuid()
        try:
            u = pwd.getpwuid(uid)
        except KeyError:
            self.skipTest("Skipping getpwent test, current EUID not found in NSS")
            return


# samba-tool user add command didn't support users with empty gecos if none is
# specified on the command line and the user hasn't one in the passwd file it
# will fail, so let's add some contents

        gecos = u[4]
        if (gecos is None or len(gecos) == 0):
            gecos = "Foo GECOS"
        user = self._randomPosixUser({
                        "name": u[0],
                        "uid": u[0],
                        "uidNumber": u[2],
                        "gidNumber": u[3],
                        "gecos": gecos,
                        "loginShell": u[6],
                        })
        # check if --rfc2307-from-nss sets the same values as we got from pwd.getpwuid()
        (result, out, err) = self.runsubcmd("user", "add", user["name"], user["password"],
                                                "--surname=%s" % user["surname"],
                                                "--given-name=%s" % user["given-name"],
                                                "--job-title=%s" % user["job-title"],
                                                "--department=%s" % user["department"],
                                                "--description=%s" % user["description"],
                                                "--company=%s" % user["company"],
                                                "--gecos=%s" % user["gecos"],
                                                "--rfc2307-from-nss",
                                                "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                                "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))

        self.assertCmdSuccess(result, out, err)
        self.assertEquals(err,"","Shouldn't be any error messages")
        self.assertIn("User '%s' created successfully" % user["name"], out)

        self._check_posix_user(user)
        self.runsubcmd("user", "delete", user["name"])

        # Check if overriding the attributes from NSS with explicit values works
        #
        # get a user with all random posix attributes
        user = self._randomPosixUser({"name": u[0]})
        # create a user with posix attributes from nss but override all of them with the
        # random ones just obtained
        (result, out, err) = self.runsubcmd("user", "add", user["name"], user["password"],
                                                "--surname=%s" % user["surname"],
                                                "--given-name=%s" % user["given-name"],
                                                "--job-title=%s" % user["job-title"],
                                                "--department=%s" % user["department"],
                                                "--description=%s" % user["description"],
                                                "--company=%s" % user["company"],
                                                "--rfc2307-from-nss",
                                                "--gecos=%s" % user["gecos"],
                                                "--login-shell=%s" % user["loginShell"],
                                                "--uid=%s" % user["uid"],
                                                "--uid-number=%s" % user["uidNumber"],
                                                "--gid-number=%s" % user["gidNumber"],
                                                "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                                "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))

        self.assertCmdSuccess(result, out, err)
        self.assertEquals(err,"","Shouldn't be any error messages")
        self.assertIn("User '%s' created successfully" % user["name"], out)

        self._check_posix_user(user)
        self.runsubcmd("user", "delete", user["name"])

    def _randomUser(self, base={}):
        """create a user with random attribute values, you can specify base attributes"""
        user = {
            "name": self.randomName(),
            "password": self.randomPass(),
            "surname": self.randomName(),
            "given-name": self.randomName(),
            "job-title": self.randomName(),
            "department": self.randomName(),
            "company": self.randomName(),
            "description": self.randomName(count=100),
            "createUserFn": self._create_user,
            "checkUserFn": self._check_user,
            }
        user.update(base)
        return user

    def _randomPosixUser(self, base={}):
        """create a user with random attribute values and additional RFC2307
        attributes, you can specify base attributes"""
        user = self._randomUser({})
        user.update(base)
        posixAttributes = {
            "uid": self.randomName(),
            "loginShell": self.randomName(),
            "gecos": self.randomName(),
            "uidNumber": self.randomXid(),
            "gidNumber": self.randomXid(),
            "createUserFn": self._create_posix_user,
            "checkUserFn": self._check_posix_user,
        }
        user.update(posixAttributes)
        user.update(base)
        return user

    def _check_user(self, user):
        """ check if a user from SamDB has the same attributes as its template """
        found = self._find_user(user["name"])

        self.assertEquals("%s" % found.get("name"), "%(given-name)s %(surname)s" % user)
        self.assertEquals("%s" % found.get("title"), user["job-title"])
        self.assertEquals("%s" % found.get("company"), user["company"])
        self.assertEquals("%s" % found.get("description"), user["description"])
        self.assertEquals("%s" % found.get("department"), user["department"])

    def _check_posix_user(self, user):
        """ check if a posix_user from SamDB has the same attributes as its template """
        found = self._find_user(user["name"])

        self.assertEquals("%s" % found.get("loginShell"), user["loginShell"])
        self.assertEquals("%s" % found.get("gecos"), user["gecos"])
        self.assertEquals("%s" % found.get("uidNumber"), "%s" % user["uidNumber"])
        self.assertEquals("%s" % found.get("gidNumber"), "%s" % user["gidNumber"])
        self.assertEquals("%s" % found.get("uid"), user["uid"])
        self._check_user(user)

    def _create_user(self, user):
        return self.runsubcmd("user", "add", user["name"], user["password"],
                                                "--surname=%s" % user["surname"],
                                                "--given-name=%s" % user["given-name"],
                                                "--job-title=%s" % user["job-title"],
                                                "--department=%s" % user["department"],
                                                "--description=%s" % user["description"],
                                                "--company=%s" % user["company"],
                                                "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                                "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
    def _create_posix_user(self, user):
        """ create a new user with RFC2307 attributes """
        return self.runsubcmd("user", "create", user["name"], user["password"],
                                                "--surname=%s" % user["surname"],
                                                "--given-name=%s" % user["given-name"],
                                                "--job-title=%s" % user["job-title"],
                                                "--department=%s" % user["department"],
                                                "--description=%s" % user["description"],
                                                "--company=%s" % user["company"],
                                                "--gecos=%s" % user["gecos"],
                                                "--login-shell=%s" % user["loginShell"],
                                                "--uid=%s" % user["uid"],
                                                "--uid-number=%s" % user["uidNumber"],
                                                "--gid-number=%s" % user["gidNumber"],
                                                "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                                "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))

    def _find_user(self, name):
        search_filter = "(&(sAMAccountName=%s)(objectCategory=%s,%s))" % (ldb.binary_encode(name), "CN=Person,CN=Schema,CN=Configuration", self.samdb.domain_dn())
        userlist = self.samdb.search(base=self.samdb.domain_dn(),
                                  scope=ldb.SCOPE_SUBTREE,
                                  expression=search_filter, attrs=[])
        if userlist:
            return userlist[0]
        else:
            return None
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           # Unix SMB/CIFS implementation.
# Copyright (C) Sean Dague <sdague@linux.vnet.ibm.com> 2011
# Copyright (C) Andrew Bartlett <abartlet@samba.org> 2016
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import os
import time
import ldb
from samba.tests.samba_tool.base import SambaToolCmdTest
from samba import (
        nttime2unix,
        dsdb
        )

class UserCheckPwdTestCase(SambaToolCmdTest):
    """Tests for samba-tool user subcommands"""
    users = []
    samdb = None

    def setUp(self):
        super(UserCheckPwdTestCase, self).setUp()
        self.samdb = self.getSamDB("-H", "ldap://%s" % os.environ["DC_SERVER"],
            "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
        self.old_min_pwd_age = self.samdb.get_minPwdAge()
        self.samdb.set_minPwdAge("0")

    def tearDown(self):
        super(UserCheckPwdTestCase, self).tearDown()
        self.samdb.set_minPwdAge(self.old_min_pwd_age)

    def test_checkpassword(self):
        # Add
        user = self._randomUser()
        bad_password = os.environ["UNACCEPTABLE_PASSWORD"]
        good_password = bad_password[:-1]

        (result, out, err) = self.runsubcmd("user", "add", user["name"], bad_password,
                                            "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                            "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
        self.assertCmdFail(result, "Should fail adding a user with bad password.")
        (result, out, err) = self.runsubcmd("user", "delete", user["name"],
                                            "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                            "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
        self.assertCmdSuccess(result, out, err, "Should delete user with bad password.")

        (result, out, err) = self.runsubcmd("user", "add", user["name"], good_password,
                                            "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                            "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
        self.assertCmdSuccess(result, out, err, "Should succeed adding a user with good password.")

        # Set password
        (result, out, err) = self.runsubcmd("user", "setpassword", user["name"],
                                            "--newpassword=%s" % bad_password,
                                            "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                            "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
        self.assertCmdFail(result, "Should fail setting a user's password to a bad one.")

        (result, out, err) = self.runsubcmd("user", "setpassword", user["name"],
                                            "--newpassword=%s" % good_password,
                                            "-H", "ldap://%s" % os.environ["DC_SERVER"],
                                            "-U%s%%%s" % (os.environ["DC_USERNAME"], os.environ["DC_PASSWORD"]))
        self.assertCmdSuccess(result, out, err, "Should succeed setting a user's password to a good one.")

        # Password=

        (result, out, err) = self.runsubcmd("user", "password",
                                            "--newpassword=%s" % bad_password,
                                            "--ipaddress", os.environ["DC_SERVER_IP"],
                                            "-U%s%%%s" % (user["name"], good_password))
        self.assertCmdFail(result, "A user setting their own password to a bad one should fail.")

        (result, out, err) = self.runsubcmd("user", "password",
                                            "--newpassword=%s" % good_password + 'XYZ',
                                            "--ipaddress", os.environ["DC_SERVER_IP"],
                                            "-U%s%%%s" % (user["name"], good_password))
        self.assertCmdSuccess(result, out, err, "A user setting their own password to a good one should succeed.")

    def _randomUser(self, base={}):
        """create a user with random attribute values, you can specify base attributes"""
        user = {
            "name": self.randomName(),
        }
        user.update(base)
        return user
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # Unix SMB/CIFS implementation. Tests for SamDB
# Copyright (C) Jelmer Vernooij <jelmer@samba.org> 2008
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

"""Tests for samba.samdb."""

import logging
import os
import uuid

from samba.auth import system_session
from samba.provision import (setup_samdb, guess_names, make_smbconf,
    provision_paths_from_lp)
from samba.provision import DEFAULT_POLICY_GUID, DEFAULT_DC_POLICY_GUID
from samba.provision.backend import ProvisionBackend
from samba.tests import TestCaseInTempDir
from samba.dcerpc import security
from samba.schema import Schema
from samba import param


class SamDBTestCase(TestCaseInTempDir):
    """Base-class for tests with a Sam Database.

    This is used by the Samba SamDB-tests, but e.g. also by the OpenChange
    provisioning tests (which need a Sam).
    """

    def setUp(self):
        super(SamDBTestCase, self).setUp()
        invocationid = str(uuid.uuid4())
        domaindn = "DC=COM,DC=EXAMPLE"
        self.domaindn = domaindn
        configdn = "CN=Configuration," + domaindn
        schemadn = "CN=Schema," + configdn
        domainguid = str(uuid.uuid4())
        policyguid = DEFAULT_POLICY_GUID
        domainsid = security.random_sid()
        path = os.path.join(self.tempdir, "samdb.ldb")
        session_info = system_session()

        hostname="foo"
        domain="EXAMPLE"
        dnsdomain="example.com"
        serverrole="domain controller"
        policyguid_dc = DEFAULT_DC_POLICY_GUID

        smbconf = os.path.join(self.tempdir, "smb.conf")
        make_smbconf(smbconf, hostname, domain, dnsdomain,
                     self.tempdir, serverrole=serverrole)

        self.lp = param.LoadParm()
        self.lp.load(smbconf)

        names = guess_names(lp=self.lp, hostname=hostname,
                            domain=domain, dnsdomain=dnsdomain,
                            serverrole=serverrole,
                            domaindn=self.domaindn, configdn=configdn,
                            schemadn=schemadn)

        paths = provision_paths_from_lp(self.lp, names.dnsdomain)

        logger = logging.getLogger("provision")

        provision_backend = ProvisionBackend("ldb", paths=paths,
                lp=self.lp, credentials=None,
                names=names, logger=logger)

        schema = Schema(domainsid, invocationid=invocationid,
                schemadn=names.schemadn, serverdn=names.serverdn,
                am_rodc=False)

        self.samdb = setup_samdb(path, session_info,
                provision_backend, self.lp, names, logger,
                domainsid, domainguid, policyguid, policyguid_dc, False,
                "secret", "secret", "secret", invocationid, "secret",
                None, "domain controller", schema=schema)

    def tearDown(self):
        for f in ['schema.ldb', 'configuration.ldb',
                  'users.ldb', 'samdb.ldb', 'smb.conf']:
            os.remove(os.path.join(self.tempdir, f))
        super(SamDBTestCase, self).tearDown()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         # Unix SMB/CIFS implementation.
# Copyright (C) Jelmer Vernooij <jelmer@samba.org> 2007
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

"""Tests for samba.dcerpc.security."""

import samba.tests
from samba.dcerpc import security

class SecurityTokenTests(samba.tests.TestCase):

    def setUp(self):
        super(SecurityTokenTests, self).setUp()
        self.token = security.token()

    def test_is_system(self):
        self.assertFalse(self.token.is_system())

    def test_is_anonymous(self):
        self.assertFalse(self.token.is_anonymous())

    def test_has_builtin_administrators(self):
        self.assertFalse(self.token.has_builtin_administrators())

    def test_has_nt_authenticated_users(self):
        self.assertFalse(self.token.has_nt_authenticated_users())

    def test_has_priv(self):
        self.assertFalse(self.token.has_privilege(security.SEC_PRIV_SHUTDOWN))

    def test_set_priv(self):
        self.assertFalse(self.token.has_privilege(security.SEC_PRIV_SHUTDOWN))
        self.assertFalse(self.token.set_privilege(security.SEC_PRIV_SHUTDOWN))
        self.assertTrue(self.token.has_privilege(security.SEC_PRIV_SHUTDOWN))


class SecurityDescriptorTests(samba.tests.TestCase):

    def setUp(self):
        super(SecurityDescriptorTests, self).setUp()
        self.descriptor = security.descriptor()

    def test_from_sddl(self):
        desc = security.descriptor.from_sddl("O:AOG:DAD:(A;;RPWPCCDCLCSWRCWDWOGA;;;S-1-0-0)", security.dom_sid("S-2-0-0"))
        self.assertEquals(desc.group_sid, security.dom_sid('S-2-0-0-512'))
        self.assertEquals(desc.owner_sid, security.dom_sid('S-1-5-32-548'))
        self.assertEquals(desc.revision, 1)
        self.assertEquals(desc.sacl, None)
        self.assertEquals(desc.type, 0x8004)

    def test_from_sddl_invalidsddl(self):
        self.assertRaises(TypeError,security.descriptor.from_sddl, "foo",security.dom_sid("S-2-0-0"))

    def test_from_sddl_invalidtype1(self):
        self.assertRaises(TypeError, security.descriptor.from_sddl, security.dom_sid('S-2-0-0-512'),security.dom_sid("S-2-0-0"))

    def test_from_sddl_invalidtype2(self):
        sddl = "O:AOG:DAD:(A;;RPWPCCDCLCSWRCWDWOGA;;;S-1-0-0)"
        self.assertRaises(TypeError, security.descriptor.from_sddl, sddl,
                "S-2-0-0")

    def test_as_sddl(self):
        text = "O:AOG:DAD:(A;;RPWPCCDCLCSWRCWDWOGA;;;S-1-0-0)"
        dom = security.dom_sid("S-2-0-0")
        desc1 = security.descriptor.from_sddl(text, dom)
        desc2 = security.descriptor.from_sddl(desc1.as_sddl(dom), dom)
        self.assertEquals(desc1.group_sid, desc2.group_sid)
        self.assertEquals(desc1.owner_sid, desc2.owner_sid)
        self.assertEquals(desc1.sacl, desc2.sacl)
        self.assertEquals(desc1.type, desc2.type)

    def test_as_sddl_invalid(self):
        text = "O:AOG:DAD:(A;;RPWPCCDCLCSWRCWDWOGA;;;S-1-0-0)"
        dom = security.dom_sid("S-2-0-0")
        desc1 = security.descriptor.from_sddl(text, dom)
        self.assertRaises(TypeError, desc1.as_sddl,text)


    def test_as_sddl_no_domainsid(self):
        dom = security.dom_sid("S-2-0-0")
        text = "O:AOG:DAD:(A;;RPWPCCDCLCSWRCWDWOGA;;;S-1-0-0)"
        desc1 = security.descriptor.from_sddl(text, dom)
        desc2 = security.descriptor.from_sddl(desc1.as_sddl(), dom)
        self.assertEquals(desc1.group_sid, desc2.group_sid)
        self.assertEquals(desc1.owner_sid, desc2.owner_sid)
        self.assertEquals(desc1.sacl, desc2.sacl)
        self.assertEquals(desc1.type, desc2.type)

    def test_domsid_nodomsid_as_sddl(self):
        dom = security.dom_sid("S-2-0-0")
        text = "O:AOG:DAD:(A;;RPWPCCDCLCSWRCWDWOGA;;;S-1-0-0)"
        desc1 = security.descriptor.from_sddl(text, dom)
        self.assertNotEqual(desc1.as_sddl(), desc1.as_sddl(dom))

    def test_split(self):
        dom = security.dom_sid("S-2-0-7")
        self.assertEquals((security.dom_sid("S-2-0"), 7), dom.split())


class DomSidTests(samba.tests.TestCase):

    def test_parse_sid(self):
        sid = security.dom_sid("S-1-5-21")
        self.assertEquals("S-1-5-21", str(sid))

    def test_sid_equal(self):
        sid1 = security.dom_sid("S-1-5-21")
        sid2 = security.dom_sid("S-1-5-21")
        self.assertEquals(sid1, sid1)
        self.assertEquals(sid1, sid2)

    def test_random(self):
        sid = security.random_sid()
        self.assertTrue(str(sid).startswith("S-1-5-21-"))

    def test_repr(self):
        sid = security.random_sid()
        self.assertTrue(repr(sid).startswith("dom_sid('S-1-5-21-"))


class PrivilegeTests(samba.tests.TestCase):

    def test_privilege_name(self):
        self.assertEquals("SeShutdownPrivilege",
                security.privilege_name(security.SEC_PRIV_SHUTDOWN))

    def test_privilege_id(self):
        self.assertEquals(security.SEC_PRIV_SHUTDOWN,
                security.privilege_id("SeShutdownPrivilege"))

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           # Unix SMB/CIFS implementation.
# Copyright (C) Jelmer Vernooij <jelmer@samba.org> 2011
#
# Loosely based on bzrlib's test_source.py
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

"""Source level Python tests."""

import errno
import os
import re
import warnings

from samba.tests import (
    TestCase,
    )


def get_python_source_files():
    """Iterate over all Python source files."""
    library_dir = os.path.abspath(os.path.join(os.path.dirname(__file__), "..", "..", "samba"))
    assert os.path.isdir(library_dir), library_dir

    for root, dirs, files in os.walk(library_dir):
        for f in files:
            if f.endswith(".py"):
                yield os.path.abspath(os.path.join(root, f))

    bindir = os.path.abspath(os.path.join(os.path.dirname(__file__), "..", "..", "..", "..", "bin"))
    assert os.path.isdir(bindir), bindir
    for f in os.listdir(bindir):
        p = os.path.abspath(os.path.join(bindir, f))
        if not os.path.islink(p):
            continue
        target = os.readlink(p)
        if os.path.dirname(target).endswith("scripting/bin"):
            yield p
    wafsambadir = os.path.abspath(os.path.join(os.path.dirname(__file__), "..", "..", "..", "..", "buildtools", "wafsamba"))
    assert os.path.isdir(wafsambadir), wafsambadir
    for root, dirs, files in os.walk(wafsambadir):
        for f in files:
            if f.endswith(".py"):
                yield os.path.abspath(os.path.join(root, f))


def get_source_file_contents():
    """Iterate over the contents of all python files."""
    for fname in get_python_source_files():
        try:
            f = open(fname, 'rb')
        except IOError, e:
            if e.errno == errno.ENOENT:
                warnings.warn("source file %s broken link?" % fname)
                continue
            else:
                raise
        try:
            text = f.read()
        finally:
            f.close()
        yield fname, text


class TestSource(TestCase):

    def test_copyright(self):
        """Test that all Python files have a valid copyright statement."""
        incorrect = []

        copyright_re = re.compile('#\\s*copyright.*(?=\n)', re.I)

        for fname, text in get_source_file_contents():
            if fname.endswith("ms_schema.py"):
                # FIXME: Not sure who holds copyright on ms_schema.py
                continue
            if "wafsamba" in fname:
                # FIXME: No copyright headers in wafsamba
                continue
            match = copyright_re.search(text)
            if not match:
                incorrect.append((fname, 'no copyright line found\n'))

        if incorrect:
            help_text = [
                "Some files have missing or incorrect copyright"
                " statements.", ""]
            for fname, comment in incorrect:
                help_text.append(fname)
                help_text.append((' ' * 4) + comment)

            self.fail('\n'.join(help_text))

    def test_gpl(self):
        """Test that all .py files have a GPL disclaimer."""
        incorrect = []

        gpl_txt = """
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
"""
        gpl_re = re.compile(re.escape(gpl_txt), re.MULTILINE)

        for fname, text in get_source_file_contents():
            if "wafsamba" in fname:
                # FIXME: License to wafsamba hasn't been clarified yet
                continue
            if fname.endswith("/python/samba/subunit/run.py"):
                # Imported from subunit/testtools, which are dual
                # Apache2/BSD-3.
                continue
            if not gpl_re.search(text):
                incorrect.append(fname)

        if incorrect:
            help_text = ['Some files have missing or incomplete GPL statement',
                         gpl_txt]
            for fname in incorrect:
                help_text.append((' ' * 4) + fname)

            self.fail('\n'.join(help_text))

    def _push_file(self, dict_, fname, line_no):
        if fname not in dict_:
            dict_[fname] = [line_no]
        else:
            dict_[fname].append(line_no)

    def _format_message(self, dict_, message):
        files = ["%s: %s" % (f, ', '.join([str(i + 1) for i in lines]))
                for f, lines in dict_.items()]
        files.sort()
        return message + '\n\n    %s' % ('\n    '.join(files))

    def _iter_source_files_lines(self):
        for fname, text in get_source_file_contents():
            lines = text.splitlines(True)
            last_line_no = len(lines) - 1
            for line_no, line in enumerate(lines):
                yield fname, line_no, line

    def test_no_tabs(self):
        """Check that there are no tabs in Python files."""
        tabs = {}
        for fname, line_no, line in self._iter_source_files_lines():
            if '\t' in line:
                self._push_file(tabs, fname, line_no)
        if tabs:
            self.fail(self._format_message(tabs,
                'Tab characters were found in the following source files.'
                '\nThey should either be replaced by "\\t" or by spaces:'))

    def test_unix_newlines(self):
        """Check for unix new lines."""
        illegal_newlines = {}
        for fname, line_no, line in self._iter_source_files_lines():
            if not line.endswith('\n') or line.endswith('\r\n'):
                self._push_file(illegal_newlines, fname, line_no)
        if illegal_newlines:
            self.fail(self._format_message(illegal_newlines,
                'Non-unix newlines were found in the following source files:'))

    def test_trailing_whitespace(self):
        """Check that there is not trailing whitespace in Python files."""
        trailing_whitespace = {}
        for fname, line_no, line in self._iter_source_files_lines():
            if line.rstrip("\n").endswith(" "):
                self._push_file(trailing_whitespace, fname, line_no)
        if trailing_whitespace:
            self.fail(self._format_message(trailing_whitespace,
                'Trailing whitespace was found in the following source files.'))

    def test_shebang_lines(self):
        """Check that files with shebang lines and only those are executable."""
        files_with_shebang = {}
        files_without_shebang= {}
        for fname, line_no, line in self._iter_source_files_lines():
            if line_no >= 1:
                continue
            executable = (os.stat(fname).st_mode & 0111)
            has_shebang = line.startswith("#!")
            if has_shebang and not executable:
                self._push_file(files_with_shebang, fname, line_no)
            if not has_shebang and executable:
                self._push_file(files_without_shebang, fname, line_no)
        if files_with_shebang:
            self.fail(self._format_message(files_with_shebang,
                      'Files with shebang line that are not executable:'))
        if files_without_shebang:
            self.fail(self._format_message(files_without_shebang,
                      'Files without shebang line that are executable:'))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # subunit test cases for Samba string functions.

# Copyright (C) 2003 by Martin Pool <mbp@samba.org>
# Copyright (C) 2011 Andrew Bartlett
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

# XXX: All this code assumes that the Unix character set is UTF-8,
# which is the most common setting.  I guess it would be better to
# force it to that value while running the tests.  I'm not sure of the
# best way to do that yet.
#
# -- mbp

from unicodenames import *

import samba.tests
from samba import strcasecmp_m, strstr_m

def signum(a):
    if a < 0:
        return -1
    elif a > 0:
        return +1
    else:
        return 0


class strcasecmp_m_Tests(samba.tests.TestCase):
    """String comparisons in simple ASCII and unicode"""
    def test_strcasecmp_m(self):
        # A, B, strcasecmp(A, B)
        cases = [('hello', 'hello', 0),
                 ('hello', 'goodbye', +1),
                 ('goodbye', 'hello', -1),
                 ('hell', 'hello', -1),
                 ('', '', 0),
                 ('a', '', +1),
                 ('', 'a', -1),
                 ('a', 'A', 0),
                 ('aa', 'aA', 0),
                 ('Aa', 'aa', 0),
                 ('longstring ' * 100, 'longstring ' * 100, 0),
                 ('longstring ' * 100, 'longstring ' * 100 + 'a', -1),
                 ('longstring ' * 100 + 'a', 'longstring ' * 100, +1),
                 (KATAKANA_LETTER_A, KATAKANA_LETTER_A, 0),
                 (KATAKANA_LETTER_A, 'a', 1),
                 ]
        for a, b, expect in cases:
            self.assertEquals(signum(strcasecmp_m(a.encode('utf-8'),
                                                  b.encode('utf-8'))),
                              expect)

class strstr_m_Tests(samba.tests.TestCase):
    """strstr_m tests in simple ASCII and unicode strings"""

    def test_strstr_m(self):
        # A, B, strstr_m(A, B)
        cases = [('hello', 'hello', 'hello'),
                 ('hello', 'goodbye', None),
                 ('goodbye', 'hello', None),
                 ('hell', 'hello', None),
                 ('hello', 'hell', 'hello'),
                 ('', '', ''),
                 ('a', '', 'a'),
                 ('', 'a', None),
                 ('a', 'A', None),
                 ('aa', 'aA', None),
                 ('Aa', 'aa', None),
                 ('%v foo', '%v', '%v foo'),
                 ('foo %v foo', '%v', '%v foo'),
                 ('foo %v', '%v', '%v'),
                 ('longstring ' * 100, 'longstring ' * 99, 'longstring ' * 100),
                 ('longstring ' * 99, 'longstring ' * 100, None),
                 ('longstring a' * 99, 'longstring ' * 100 + 'a', None),
                 ('longstring ' * 100 + 'a', 'longstring ' * 100, 'longstring ' * 100 + 'a'),
                 (KATAKANA_LETTER_A, KATAKANA_LETTER_A + 'bcd', None),
                 (KATAKANA_LETTER_A + 'bcde', KATAKANA_LETTER_A + 'bcd', KATAKANA_LETTER_A + 'bcde'),
                 ('d'+KATAKANA_LETTER_A + 'bcd', KATAKANA_LETTER_A + 'bcd', KATAKANA_LETTER_A + 'bcd'),
                 ('d'+KATAKANA_LETTER_A + 'bd', KATAKANA_LETTER_A + 'bcd', None),

                 ('e'+KATAKANA_LETTER_A + 'bcdf', KATAKANA_LETTER_A + 'bcd', KATAKANA_LETTER_A + 'bcdf'),
                 (KATAKANA_LETTER_A, KATAKANA_LETTER_A + 'bcd', None),
                 (KATAKANA_LETTER_A*3, 'a', None),
                 ]
        for a, b, expect in cases:
            if expect is not None:
                expect = expect.encode('utf-8')
            self.assertEquals(strstr_m(a.encode('utf-8'),
                                       b.encode('utf-8')),
                              expect)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  #!/usr/bin/env python

# Simple subunit testrunner for python

# NOTE: DO NOT USE THIS MODULE FOR NEW CODE.
#
# Instead, use the standard subunit runner - e.g. "python -m subunit.run
# YOURMODULE".
#
# This wrapper will be removed once all tests can be run
# without it. At the moment there are various tests which still
# get e.g. credentials passed via command-line options to this
# script.

# Copyright (C) Jelmer Vernooij <jelmer@samba.org> 2007-2014
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

# make sure the script dies immediately when hitting control-C,
# rather than raising KeyboardInterrupt. As we do all database
# operations using transactions, this is safe.
import signal
signal.signal(signal.SIGINT, signal.SIG_DFL)

import optparse
import sys

from samba.subunit.run import TestProgram as BaseTestProgram


class SubunitOptions(optparse.OptionGroup):
    """Command line options for subunit test runners."""

    def __init__(self, parser):
        optparse.OptionGroup.__init__(self, parser, "Subunit Options")
        self.add_option('-l', '--list', dest='listtests', default=False,
                  help='List tests rather than running them.',
                  action="store_true")
        self.add_option('--load-list', dest='load_list', default=None,
                  help='Specify a filename containing the test ids to use.')


class TestProgram(BaseTestProgram):

    def __init__(self, module=None, args=None, opts=None):
        if args is None:
            args = []
        if getattr(opts, "listtests", False):
            args.insert(0, "--list")
        if getattr(opts, 'load_list', None):
            args.insert(0, "--load-list=%s" % opts.load_list)
        argv = [sys.argv[0]] + args
        super(TestProgram, self).__init__(module=module, argv=argv)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             # Copyright (C) 2003 by Martin Pool <mbp@samba.org>

# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

"""Symbolic names for unicode characters.

Defines symbolic names for a few UNICODE characters, to make test
source code more readable on machines that don't have all the
necessary fonts.
"""

LATIN_CAPITAL_LETTER_N_WITH_TILDE         = u'\u004e'
LATIN_CAPITAL_LETTER_O_WITH_DIARESIS      = u'\u00d6'
LATIN_SMALL_LETTER_O_WITH_DIARESIS        = u'\u00f6'

KATAKANA_LETTER_A                         = u'\u30a2'
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    # Unix SMB/CIFS implementation.
# Copyright (C) Jelmer Vernooij <jelmer@samba.org> 2007
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

"""Tests for samba.upgrade."""

from samba.upgrade import import_wins
from samba.tests import LdbTestCase


class WinsUpgradeTests(LdbTestCase):

    def test_upgrade(self):
        winsdb = {
            "FOO#20": (200, ["127.0.0.1", "127.0.0.2"], 0x60)
        }
        import_wins(self.ldb, winsdb)

        self.assertEquals(
            ['name=FOO,type=0x20'],
            [str(m.dn) for m in
                self.ldb.search(expression="(objectClass=winsRecord)")])

    def test_version(self):
        import_wins(self.ldb, {})
        self.assertEquals("VERSION",
                str(self.ldb.search(expression="(objectClass=winsMaxVersion)")[0]["cn"]))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   # Unix SMB/CIFS implementation.
# Copyright (C) Jelmer Vernooij <jelmer@samba.org> 2007-2008
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

"""Tests for samba.upgradeprovision."""

import os
from samba.upgradehelpers import (usn_in_range, dn_sort,
                                  update_secrets,
                                  construct_existor_expr)
from samba.descriptor import get_diff_sds
from samba.tests.provision import create_dummy_secretsdb
from samba.tests import TestCaseInTempDir
from samba import Ldb
from ldb import SCOPE_BASE
import samba.tests
from samba.dcerpc import security

def dummymessage(a=None, b=None):
    pass


class UpgradeProvisionTestCase(TestCaseInTempDir):
    """Some simple tests for individual functions in the provisioning code.
    """
    def test_usn_in_range(self):
        range = [5, 25, 35, 55]

        vals = [3, 26, 56]

        for v in vals:
            self.assertFalse(usn_in_range(v, range))

        vals = [5, 20, 25, 35, 36]

        for v in vals:
            self.assertTrue(usn_in_range(v, range))

    def test_dn_sort(self):
        # higher level comes after lower even if lexicographicaly closer
        # ie dc=tata,dc=toto (2 levels), comes after dc=toto
        # even if dc=toto is lexicographicaly after dc=tata, dc=toto
        self.assertEquals(dn_sort("dc=tata,dc=toto", "dc=toto"), 1)
        self.assertEquals(dn_sort("dc=zata", "dc=tata"), 1)
        self.assertEquals(dn_sort("dc=toto,dc=tata",
                                    "cn=foo,dc=toto,dc=tata"), -1)
        self.assertEquals(dn_sort("cn=bar, dc=toto,dc=tata",
                                    "cn=foo, dc=toto,dc=tata"), -1)

    def test_get_diff_sds(self):
        domsid = security.dom_sid('S-1-5-21')

        sddl = "O:SAG:DUD:AI(A;CI;RPWPCRCCLCLORCWOWDSW;;;SA)\
(A;CI;RP LCLORC;;;AU)(A;CI;RPWPCRCCDCLCLORCWOWDSDDTSW;;;SY)S:AI(AU;CISA;WP;;;WD)"
        sddl1 = "O:SAG:DUD:AI(A;CI;RPWPCRCCLCLORCWOWDSW;;;SA)\
(A;CI;RP LCLORC;;;AU)(A;CI;RPWPCRCCDCLCLORCWOWDSDDTSW;;;SY)S:AI(AU;CISA;WP;;;WD)"
        sddl2 = "O:BAG:DUD:AI(A;CI;RPWPCRCCLCLORCWOWDSW;;;SA)\
(A;CI;RP LCLORC;;;AU)(A;CI;RPWPCRCCDCLCLORCWOWDSDDTSW;;;SY)S:AI(AU;CISA;WP;;;WD)"
        sddl3 = "O:SAG:BAD:AI(A;CI;RPWPCRCCLCLORCWOWDSW;;;SA)\
(A;CI;RP LCLORC;;;AU)(A;CI;RPWPCRCCDCLCLORCWOWDSDDTSW;;;SY)S:AI(AU;CISA;WP;;;WD)"
        sddl4 = "O:SAG:DUD:AI(A;CI;RPWPCRCCLCLORCWOWDSW;;;BA)\
(A;CI;RP LCLORC;;;AU)(A;CI;RPWPCRCCDCLCLORCWOWDSDDTSW;;;SY)S:AI(AU;CISA;WP;;;WD)"
        sddl5 = "O:SAG:DUD:AI(A;CI;RPWPCRCCLCLORCWOWDSW;;;SA)\
(A;CI;RP LCLORC;;;AU)(A;CI;RPWPCRCCDCLCLORCWOWDSDDTSW;;;SY)"
        sddl6 = "O:SAG:DUD:AI(A;CIID;RPWPCRCCLCLORCWOWDSW;;;SA)\
(A;CIID;RP LCLORC;;;AU)(A;CIID;RPWPCRCCDCLCLORCWOWDSDDTSW;;;SY)\
(A;CI;RPWPCRCCLCLORCWOWDSW;;;SA)\
(A;CI;RP LCLORC;;;AU)(A;CI;RPWPCRCCDCLCLORCWOWDSDDTSW;;;SY)S:AI(AU;CISA;WP;;;WD)(AU;CIIDSA;WP;;;WD)"

        self.assertEquals(get_diff_sds(security.descriptor.from_sddl(sddl, domsid),
                                       security.descriptor.from_sddl(sddl1, domsid),
                                       domsid), "")
        txt = get_diff_sds(security.descriptor.from_sddl(sddl, domsid),
                           security.descriptor.from_sddl(sddl2, domsid),
                           domsid)
        self.assertEquals(txt, "\tOwner mismatch: SA (in ref) BA(in current)\n")
        txt = get_diff_sds(security.descriptor.from_sddl(sddl, domsid),
                           security.descriptor.from_sddl(sddl3, domsid),
                           domsid)
        self.assertEquals(txt, "\tGroup mismatch: DU (in ref) BA(in current)\n")
        txt = get_diff_sds(security.descriptor.from_sddl(sddl, domsid),
                           security.descriptor.from_sddl(sddl4, domsid),
                           domsid)
        txtmsg = "\tPart dacl is different between reference and current here\
 is the detail:\n\t\t(A;CI;RPWPCRCCLCLORCWOWDSW;;;BA) ACE is not present in\
 the reference\n\t\t(A;CI;RPWPCRCCLCLORCWOWDSW;;;SA) ACE is not present in\
 the current\n"
        self.assertEquals(txt, txtmsg)

        txt = get_diff_sds(security.descriptor.from_sddl(sddl, domsid),
                           security.descriptor.from_sddl(sddl5, domsid),
                           domsid)
        self.assertEquals(txt, "\tCurrent ACL hasn't a sacl part\n")
        self.assertEquals(get_diff_sds(security.descriptor.from_sddl(sddl, domsid),
                                       security.descriptor.from_sddl(sddl6, domsid),
                                       domsid), "")

    def test_construct_existor_expr(self):
        res = construct_existor_expr([])
        self.assertEquals(res, "")

        res = construct_existor_expr(["foo"])
        self.assertEquals(res, "(|(foo=*))")

        res = construct_existor_expr(["foo", "bar"])
        self.assertEquals(res, "(|(foo=*)(bar=*))")


class UpdateSecretsTests(samba.tests.TestCaseInTempDir):

    def setUp(self):
        super(UpdateSecretsTests, self).setUp()
        self.referencedb = create_dummy_secretsdb(
            os.path.join(self.tempdir, "ref.ldb"))

    def _getEmptyDb(self):
        return Ldb(os.path.join(self.tempdir, "secrets.ldb"))

    def _getCurrentFormatDb(self):
        return create_dummy_secretsdb(
            os.path.join(self.tempdir, "secrets.ldb"))

    def test_trivial(self):
        # Test that updating an already up-to-date secretsdb works fine
        self.secretsdb = self._getCurrentFormatDb()
        self.assertEquals(None,
            update_secrets(self.referencedb, self.secretsdb, dummymessage))

    def test_update_modules(self):
        empty_db = self._getEmptyDb()
        update_secrets(self.referencedb, empty_db, dummymessage)
        newmodules = empty_db.search(base="@MODULES", scope=SCOPE_BASE)
        refmodules = self.referencedb.search(base="@MODULES", scope=SCOPE_BASE)
        self.assertEquals(newmodules.msgs, refmodules.msgs)

    def tearDown(self):
        for name in ["ref.ldb", "secrets.ldb", "secrets.tdb", "secrets.tdb.bak", "secrets.ntdb"]:
            path = os.path.join(self.tempdir, name)
            if os.path.exists(path):
                os.unlink(path)
        super(UpdateSecretsTests, self).tearDown()


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               # Unix SMB/CIFS implementation.
# Copyright (C) Jelmer Vernooij <jelmer@samba.org> 2007-2008
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

"""Tests for samba.upgradeprovision that need a DC."""

import os
import re
import shutil

from samba import param
from samba.credentials import Credentials
from samba.auth import system_session
from samba.provision import getpolicypath,find_provision_key_parameters
from samba.upgradehelpers import (get_paths, get_ldbs,
                                 identic_rename,
                                 updateOEMInfo, getOEMInfo, update_gpo,
                                 delta_update_basesamdb,
                                 update_dns_account_password,
                                 search_constructed_attrs_stored,
                                 increment_calculated_keyversion_number)
from samba.tests import env_loadparm, TestCaseInTempDir
from samba.tests.provision import create_dummy_secretsdb
import ldb


def dummymessage(a=None, b=None):
    pass

smb_conf_path = "%s/%s/%s" % (os.environ["SELFTEST_PREFIX"], "ad_dc_ntvfs", "etc/smb.conf")

class UpgradeProvisionBasicLdbHelpersTestCase(TestCaseInTempDir):
    """Some simple tests for individual functions in the provisioning code.
    """

    def test_get_ldbs(self):
        paths = get_paths(param, None, smb_conf_path)
        creds = Credentials()
        lp = env_loadparm()
        creds.guess(lp)
        get_ldbs(paths, creds, system_session(), lp)

    def test_find_key_param(self):
        paths = get_paths(param, None, smb_conf_path)
        creds = Credentials()
        lp = env_loadparm()
        creds.guess(lp)
        rootdn = "dc=samba,dc=example,dc=com"
        ldbs = get_ldbs(paths, creds, system_session(), lp)
        names = find_provision_key_parameters(ldbs.sam, ldbs.secrets, ldbs.idmap,
                                                paths, smb_conf_path, lp)
        self.assertEquals(names.realm, "SAMBA.EXAMPLE.COM")
        self.assertEquals(str(names.rootdn).lower(), rootdn.lower())
        self.assertNotEquals(names.policyid_dc, None)
        self.assertNotEquals(names.ntdsguid, "")


class UpgradeProvisionWithLdbTestCase(TestCaseInTempDir):

    def _getEmptyDbName(self):
        return os.path.join(self.tempdir, "sam.ldb")

    def setUp(self):
        super(UpgradeProvisionWithLdbTestCase, self).setUp()
        paths = get_paths(param, None, smb_conf_path)
        self.creds = Credentials()
        self.lp = env_loadparm()
        self.creds.guess(self.lp)
        self.paths = paths
        self.ldbs = get_ldbs(paths, self.creds, system_session(), self.lp)
        self.names = find_provision_key_parameters(self.ldbs.sam,
                self.ldbs.secrets, self.ldbs.idmap, paths, smb_conf_path,
                self.lp)
        self.referencedb = create_dummy_secretsdb(
            os.path.join(self.tempdir, "ref.ldb"))

    def test_search_constructed_attrs_stored(self):
        hashAtt = search_constructed_attrs_stored(self.ldbs.sam,
                                                  self.names.rootdn,
                                                  ["msds-KeyVersionNumber"])
        self.assertFalse(hashAtt.has_key("msds-KeyVersionNumber"))

    def test_increment_calculated_keyversion_number(self):
        dn = "CN=Administrator,CN=Users,%s" % self.names.rootdn
        # We conctruct a simple hash for the user administrator
        hash = {}
        # And we want the version to be 140
        hash[dn.lower()] = 140

        increment_calculated_keyversion_number(self.ldbs.sam,
                                               self.names.rootdn,
                                               hash)
        self.assertEqual(self.ldbs.sam.get_attribute_replmetadata_version(dn,
                            "unicodePwd"),
                            140)
        # This function should not decrement the version
        hash[dn.lower()] = 130

        increment_calculated_keyversion_number(self.ldbs.sam,
                                               self.names.rootdn,
                                               hash)
        self.assertEqual(self.ldbs.sam.get_attribute_replmetadata_version(dn,
                            "unicodePwd"),
                            140)

    def test_identic_rename(self):
        rootdn = "DC=samba,DC=example,DC=com"

        guestDN = ldb.Dn(self.ldbs.sam, "CN=Guest,CN=Users,%s" % rootdn)
        identic_rename(self.ldbs.sam, guestDN)
        res = self.ldbs.sam.search(expression="(name=Guest)", base=rootdn,
                                scope=ldb.SCOPE_SUBTREE, attrs=["dn"])
        self.assertEquals(len(res), 1)
        self.assertEquals(str(res[0]["dn"]), "CN=Guest,CN=Users,%s" % rootdn)

    def test_delta_update_basesamdb(self):
        dummysampath = self._getEmptyDbName()
        delta_update_basesamdb(self.paths.samdb, dummysampath,
                                self.creds, system_session(), self.lp,
                                dummymessage)

    def test_update_gpo_simple(self):
        dir = getpolicypath(self.paths.sysvol, self.names.dnsdomain,
                self.names.policyid)
        shutil.rmtree(dir)
        self.assertFalse(os.path.isdir(dir))
        update_gpo(self.paths, self.ldbs.sam, self.names, self.lp, dummymessage)
        self.assertTrue(os.path.isdir(dir))

    def test_update_gpo_acl(self):
        path = os.path.join(self.tempdir, "testupdategpo")
        save = self.paths.sysvol
        self.paths.sysvol = path
        os.mkdir(path)
        os.mkdir(os.path.join(path, self.names.dnsdomain))
        os.mkdir(os.path.join(os.path.join(path, self.names.dnsdomain),
            "Policies"))
        update_gpo(self.paths, self.ldbs.sam, self.names, self.lp, dummymessage)
        shutil.rmtree(path)
        self.paths.sysvol = save

    def test_getOEMInfo(self):
        realm = self.lp.get("realm")
        basedn = "DC=%s" % realm.replace(".", ", DC=")
        oem = getOEMInfo(self.ldbs.sam, basedn)
        self.assertNotEquals(oem, "")

    def test_update_dns_account(self):
        update_dns_account_password(self.ldbs.sam, self.ldbs.secrets,
            self.names)

    def test_updateOEMInfo(self):
        realm = self.lp.get("realm")
        basedn = "DC=%s" % realm.replace(".", ", DC=")
        oem = getOEMInfo(self.ldbs.sam, basedn)
        updateOEMInfo(self.ldbs.sam, basedn)
        oem2 = getOEMInfo(self.ldbs.sam, basedn)
        self.assertNotEquals(str(oem), str(oem2))
        self.assertTrue(re.match(".*upgrade to.*", str(oem2)))

    def tearDown(self):
        for name in ["ref.ldb", "secrets.ldb", "secrets.tdb", "secrets.tdb.bak", "secrets.ntdb", "sam.ldb"]:
            path = os.path.join(self.tempdir, name)
            if os.path.exists(path):
                os.unlink(path)
        super(UpgradeProvisionWithLdbTestCase, self).tearDown()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           # Unix SMB/CIFS implementation. Tests for xattr manipulation
# Copyright (C) Matthieu Patou <mat@matws.net> 2009
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

"""Tests for samba.xattr_native and samba.xattr_tdb."""

import samba.xattr_native, samba.xattr_tdb
from samba.xattr import copytree_with_xattrs
from samba.dcerpc import xattr
from samba.ndr import ndr_pack
from samba.tests import (
    SkipTest,
    TestCase,
    TestCaseInTempDir,
    )
import random
import shutil
import os

class XattrTests(TestCase):

    def _tmpfilename(self):
        random.seed()
        path = os.environ['SELFTEST_PREFIX']
        return os.path.join(path, "pytests"+str(int(100000*random.random())))

    def _eadbpath(self):
        return os.path.join(os.environ['SELFTEST_PREFIX'], "eadb.tdb")

    def test_set_xattr_native(self):
        if not samba.xattr_native.is_xattr_supported():
            raise SkipTest()
        ntacl = xattr.NTACL()
        ntacl.version = 1
        tempf = self._tmpfilename()
        open(tempf, 'w').write("empty")
        try:
            samba.xattr_native.wrap_setxattr(tempf, "user.unittests",
                ndr_pack(ntacl))
        except IOError:
            raise SkipTest("the filesystem where the tests are runned do not support XATTR")
        os.unlink(tempf)

    def test_set_and_get_native(self):
        if not samba.xattr_native.is_xattr_supported():
            raise SkipTest()
        tempf = self._tmpfilename()
        reftxt = "this is a test"
        open(tempf, 'w').write("empty")
        try:
            samba.xattr_native.wrap_setxattr(tempf, "user.unittests", reftxt)
            text = samba.xattr_native.wrap_getxattr(tempf, "user.unittests")
            self.assertEquals(text, reftxt)
        except IOError:
            raise SkipTest("the filesystem where the tests are runned do not support XATTR")
        os.unlink(tempf)

    def test_set_xattr_tdb(self):
        tempf = self._tmpfilename()
        eadb_path = self._eadbpath()
        ntacl = xattr.NTACL()
        ntacl.version = 1
        open(tempf, 'w').write("empty")
        try:
            samba.xattr_tdb.wrap_setxattr(eadb_path,
                tempf, "user.unittests", ndr_pack(ntacl))
        finally:
            os.unlink(tempf)
        os.unlink(eadb_path)

    def test_set_tdb_not_open(self):
        tempf = self._tmpfilename()
        ntacl = xattr.NTACL()
        ntacl.version = 1
        open(tempf, 'w').write("empty")
        try:
            self.assertRaises(IOError, samba.xattr_tdb.wrap_setxattr,
                    os.path.join("nonexistent", "eadb.tdb"), tempf,
                    "user.unittests", ndr_pack(ntacl))
        finally:
            os.unlink(tempf)

    def test_set_and_get_tdb(self):
        tempf = self._tmpfilename()
        eadb_path = self._eadbpath()
        reftxt = "this is a test"
        open(tempf, 'w').write("empty")
        try:
            samba.xattr_tdb.wrap_setxattr(eadb_path, tempf, "user.unittests",
                reftxt)
            text = samba.xattr_tdb.wrap_getxattr(eadb_path, tempf,
                "user.unittests")
            self.assertEquals(text, reftxt)
        finally:
            os.unlink(tempf)
        os.unlink(eadb_path)


class TestCopyTreeWithXattrs(TestCaseInTempDir):

    def test_simple(self):
        os.chdir(self.tempdir)
        os.mkdir("a")
        os.mkdir("a/b")
        os.mkdir("a/b/c")
        f = open('a/b/c/d', 'w')
        try:
            f.write("foo")
        finally:
            f.close()
        copytree_with_xattrs("a", "b")
        shutil.rmtree("a")
        shutil.rmtree("b")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           from .iso8601 import *
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         """ISO 8601 date time string parsing

Basic usage:
>>> import iso8601
>>> iso8601.parse_date("2007-01-25T12:00:00Z")
datetime.datetime(2007, 1, 25, 12, 0, tzinfo=<iso8601.iso8601.Utc ...>)
>>>

"""

from datetime import (
    datetime,
    timedelta,
    tzinfo
)
from decimal import Decimal
import logging
import sys
import re

__all__ = ["parse_date", "ParseError", "UTC"]

LOG = logging.getLogger(__name__)

if sys.version_info >= (3, 0, 0):
    _basestring = str
else:
    _basestring = basestring


# Adapted from http://delete.me.uk/2005/03/iso8601.html
ISO8601_REGEX = re.compile(
    r"""
    (?P<year>[0-9]{4})
    (
        (
            (-(?P<monthdash>[0-9]{1,2}))
            |
            (?P<month>[0-9]{2})
            (?!$)  # Don't allow YYYYMM
        )
        (
            (
                (-(?P<daydash>[0-9]{1,2}))
                |
                (?P<day>[0-9]{2})
            )
            (
                (
                    (?P<separator>[ T])
                    (?P<hour>[0-9]{2})
                    (:{0,1}(?P<minute>[0-9]{2})){0,1}
                    (
                        :{0,1}(?P<second>[0-9]{1,2})
                        (\.(?P<second_fraction>[0-9]+)){0,1}
                    ){0,1}
                    (?P<timezone>
                        Z
                        |
                        (
                            (?P<tz_sign>[-+])
                            (?P<tz_hour>[0-9]{2})
                            :{0,1}
                            (?P<tz_minute>[0-9]{2}){0,1}
                        )
                    ){0,1}
                ){0,1}
            )
        ){0,1}  # YYYY-MM
    ){0,1}  # YYYY only
    $
    """,
    re.VERBOSE
)

class ParseError(Exception):
    """Raised when there is a problem parsing a date string"""

# Yoinked from python docs
ZERO = timedelta(0)
class Utc(tzinfo):
    """UTC Timezone

    """
    def utcoffset(self, dt):
        return ZERO

    def tzname(self, dt):
        return "UTC"

    def dst(self, dt):
        return ZERO

    def __repr__(self):
        return "<iso8601.Utc>"

UTC = Utc()

class FixedOffset(tzinfo):
    """Fixed offset in hours and minutes from UTC

    """
    def __init__(self, offset_hours, offset_minutes, name):
        self.__offset_hours = offset_hours  # Keep for later __getinitargs__
        self.__offset_minutes = offset_minutes  # Keep for later __getinitargs__
        self.__offset = timedelta(hours=offset_hours, minutes=offset_minutes)
        self.__name = name

    def __eq__(self, other):
        if isinstance(other, FixedOffset):
            return (
                (other.__offset == self.__offset)
                and
                (other.__name == self.__name)
            )
        if isinstance(other, tzinfo):
            return other == self
        return False

    def __getinitargs__(self):
        return (self.__offset_hours, self.__offset_minutes, self.__name)

    def utcoffset(self, dt):
        return self.__offset

    def tzname(self, dt):
        return self.__name

    def dst(self, dt):
        return ZERO

    def __repr__(self):
        return "<FixedOffset %r %r>" % (self.__name, self.__offset)

def to_int(d, key, default_to_zero=False, default=None, required=True):
    """Pull a value from the dict and convert to int

    :param default_to_zero: If the value is None or empty, treat it as zero
    :param default: If the value is missing in the dict use this default

    """
    value = d.get(key) or default
    LOG.debug("Got %r for %r with default %r", value, key, default)
    if (value in ["", None]) and default_to_zero:
        return 0
    if value is None:
        if required:
            raise ParseError("Unable to read %s from %s" % (key, d))
    else:
        return int(value)

def parse_timezone(matches, default_timezone=UTC):
    """Parses ISO 8601 time zone specs into tzinfo offsets

    """

    if matches["timezone"] == "Z":
        return UTC
    # This isn't strictly correct, but it's common to encounter dates without
    # timezones so I'll assume the default (which defaults to UTC).
    # Addresses issue 4.
    if matches["timezone"] is None:
        return default_timezone
    sign = matches["tz_sign"]
    hours = to_int(matches, "tz_hour")
    minutes = to_int(matches, "tz_minute", default_to_zero=True)
    description = "%s%02d:%02d" % (sign, hours, minutes)
    if sign == "-":
        hours = -hours
        minutes = -minutes
    return FixedOffset(hours, minutes, description)

def parse_date(datestring, default_timezone=UTC):
    """Parses ISO 8601 dates into datetime objects

    The timezone is parsed from the date string. However it is quite common to
    have dates without a timezone (not strictly correct). In this case the
    default timezone specified in default_timezone is used. This is UTC by
    default.

    :param datestring: The date to parse as a string
    :param default_timezone: A datetime tzinfo instance to use when no timezone
                             is specified in the datestring. If this is set to
                             None then a naive datetime object is returned.
    :returns: A datetime.datetime instance
    :raises: ParseError when there is a problem parsing the date or
             constructing the datetime instance.

    """
    if not isinstance(datestring, _basestring):
        raise ParseError("Expecting a string %r" % datestring)
    m = ISO8601_REGEX.match(datestring)
    if not m:
        raise ParseError("Unable to parse date string %r" % datestring)
    groups = m.groupdict()
    LOG.debug("Parsed %s into %s with default timezone %s", datestring, groups, default_timezone)

    tz = parse_timezone(groups, default_timezone=default_timezone)

    groups["second_fraction"] = int(Decimal("0.%s" % (groups["second_fraction"] or 0)) * Decimal("1000000.0"))

    try:
        return datetime(
            year=to_int(groups, "year"),
            month=to_int(groups, "month", default=to_int(groups, "monthdash", required=False, default=1)),
            day=to_int(groups, "day", default=to_int(groups, "daydash", required=False, default=1)),
            hour=to_int(groups, "hour", default_to_zero=True),
            minute=to_int(groups, "minute", default_to_zero=True),
            second=to_int(groups, "second", default_to_zero=True),
            microsecond=groups["second_fraction"],
            tzinfo=tz,
        )
    except Exception as e:
        raise ParseError(e)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                # coding=UTF-8
from __future__ import absolute_import

import copy
import datetime
import pickle

import pytest

from iso8601 import iso8601

def test_iso8601_regex():
    assert iso8601.ISO8601_REGEX.match("2006-10-11T00:14:33Z")

def test_parse_no_timezone_different_default():
    tz = iso8601.FixedOffset(2, 0, "test offset")
    d = iso8601.parse_date("2007-01-01T08:00:00", default_timezone=tz)
    assert d == datetime.datetime(2007, 1, 1, 8, 0, 0, 0, tz)
    assert d.tzinfo == tz

def test_parse_utc_different_default():
    """Z should mean 'UTC', not 'default'.

    """
    tz = iso8601.FixedOffset(2, 0, "test offset")
    d = iso8601.parse_date("2007-01-01T08:00:00Z", default_timezone=tz)
    assert d == datetime.datetime(2007, 1, 1, 8, 0, 0, 0, iso8601.UTC)

@pytest.mark.parametrize("invalid_date, error_string", [
    ("2013-10-", "Unable to parse date string"),
    ("2013-", "Unable to parse date string"),
    ("", "Unable to parse date string"),
    (None, "Expecting a string"),
    ("wibble", "Unable to parse date string"),
    ("23", "Unable to parse date string"),
    ("131015T142533Z", "Unable to parse date string"),
    ("131015", "Unable to parse date string"),
    ("20141", "Unable to parse date string"),
    ("201402", "Unable to parse date string"),
    ("2007-06-23X06:40:34.00Z", "Unable to parse date string"),  # https://code.google.com/p/pyiso8601/issues/detail?id=14
    ("2007-06-23 06:40:34.00Zrubbish", "Unable to parse date string"),  # https://code.google.com/p/pyiso8601/issues/detail?id=14
    ("20114-01-03T01:45:49", "Unable to parse date string"),
])
def test_parse_invalid_date(invalid_date, error_string):
    assert isinstance(invalid_date, str) or invalid_date is None  # Why? 'cos I've screwed up the parametrize before :)
    with pytest.raises(iso8601.ParseError) as exc:
        iso8601.parse_date(invalid_date)
    assert exc.errisinstance(iso8601.ParseError)
    assert str(exc.value).startswith(error_string)

@pytest.mark.parametrize("valid_date,expected_datetime,isoformat", [
    ("2007-06-23 06:40:34.00Z", datetime.datetime(2007, 6, 23, 6, 40, 34, 0, iso8601.UTC), "2007-06-23T06:40:34+00:00"),  # Handle a separator other than T
    ("1997-07-16T19:20+01:00", datetime.datetime(1997, 7, 16, 19, 20, 0, 0, iso8601.FixedOffset(1, 0, "+01:00")), "1997-07-16T19:20:00+01:00"),  # Parse with no seconds
    ("2007-01-01T08:00:00", datetime.datetime(2007, 1, 1, 8, 0, 0, 0, iso8601.UTC), "2007-01-01T08:00:00+00:00"),  # Handle timezone-less dates. Assumes UTC. http://code.google.com/p/pyiso8601/issues/detail?id=4
    ("2006-10-20T15:34:56.123+02:30", datetime.datetime(2006, 10, 20, 15, 34, 56, 123000, iso8601.FixedOffset(2, 30, "+02:30")), None),
    ("2006-10-20T15:34:56Z", datetime.datetime(2006, 10, 20, 15, 34, 56, 0, iso8601.UTC), "2006-10-20T15:34:56+00:00"),
    ("2007-5-7T11:43:55.328Z", datetime.datetime(2007, 5, 7, 11, 43, 55, 328000, iso8601.UTC), "2007-05-07T11:43:55.328000+00:00"),  # http://code.google.com/p/pyiso8601/issues/detail?id=6
    ("2006-10-20T15:34:56.123Z", datetime.datetime(2006, 10, 20, 15, 34, 56, 123000, iso8601.UTC), "2006-10-20T15:34:56.123000+00:00"),
    ("2013-10-15T18:30Z", datetime.datetime(2013, 10, 15, 18, 30, 0, 0, iso8601.UTC), "2013-10-15T18:30:00+00:00"),
    ("2013-10-15T22:30+04", datetime.datetime(2013, 10, 15, 22, 30, 0, 0, iso8601.FixedOffset(4, 0, "+04:00")), "2013-10-15T22:30:00+04:00"),  # <time>hh:mm
    ("2013-10-15T1130-0700", datetime.datetime(2013, 10, 15, 11, 30, 0, 0, iso8601.FixedOffset(-7, 0, "-07:00")), "2013-10-15T11:30:00-07:00"),  # <time>hhmm
    ("2013-10-15T1130+0700", datetime.datetime(2013, 10, 15, 11, 30, 0, 0, iso8601.FixedOffset(+7, 0, "+07:00")), "2013-10-15T11:30:00+07:00"),  # <time>hhmm
    ("2013-10-15T1130+07", datetime.datetime(2013, 10, 15, 11, 30, 0, 0, iso8601.FixedOffset(+7, 0, "+07:00")), "2013-10-15T11:30:00+07:00"),  # <time>hh
    ("2013-10-15T1130-07", datetime.datetime(2013, 10, 15, 11, 30, 0, 0, iso8601.FixedOffset(-7, 0, "-07:00")), "2013-10-15T11:30:00-07:00"),  # <time>hh
    ("2013-10-15T15:00-03:30", datetime.datetime(2013, 10, 15, 15, 0, 0, 0, iso8601.FixedOffset(-3, -30, "-03:30")), "2013-10-15T15:00:00-03:30"),
    ("2013-10-15T183123Z", datetime.datetime(2013, 10, 15, 18, 31, 23, 0, iso8601.UTC), "2013-10-15T18:31:23+00:00"),  # hhmmss
    ("2013-10-15T1831Z", datetime.datetime(2013, 10, 15, 18, 31, 0, 0, iso8601.UTC), "2013-10-15T18:31:00+00:00"),  # hhmm
    ("2013-10-15T18Z", datetime.datetime(2013, 10, 15, 18, 0, 0, 0, iso8601.UTC), "2013-10-15T18:00:00+00:00"),  # hh
    ("2013-10-15", datetime.datetime(2013, 10, 15, 0, 0, 0, 0, iso8601.UTC), "2013-10-15T00:00:00+00:00"),  # YYYY-MM-DD
    ("20131015T18:30Z", datetime.datetime(2013, 10, 15, 18, 30, 0, 0, iso8601.UTC), "2013-10-15T18:30:00+00:00"),  # YYYYMMDD
    ("2012-12-19T23:21:28.512400+00:00", datetime.datetime(2012, 12, 19, 23, 21, 28, 512400, iso8601.FixedOffset(0, 0, "+00:00")), "2012-12-19T23:21:28.512400+00:00"),  # https://code.google.com/p/pyiso8601/issues/detail?id=21
    ("2006-10-20T15:34:56.123+0230", datetime.datetime(2006, 10, 20, 15, 34, 56, 123000, iso8601.FixedOffset(2, 30, "+02:30")), "2006-10-20T15:34:56.123000+02:30"),  # https://code.google.com/p/pyiso8601/issues/detail?id=18
    ("19950204", datetime.datetime(1995, 2, 4, tzinfo=iso8601.UTC), "1995-02-04T00:00:00+00:00"),  # https://code.google.com/p/pyiso8601/issues/detail?id=1
    ("2010-07-20 15:25:52.520701+00:00", datetime.datetime(2010, 7, 20, 15, 25, 52, 520701, iso8601.FixedOffset(0, 0, "+00:00")), "2010-07-20T15:25:52.520701+00:00"),  # https://code.google.com/p/pyiso8601/issues/detail?id=17
    ("2010-06-12", datetime.datetime(2010, 6, 12, tzinfo=iso8601.UTC), "2010-06-12T00:00:00+00:00"),  # https://code.google.com/p/pyiso8601/issues/detail?id=16
    ("1985-04-12T23:20:50.52-05:30", datetime.datetime(1985, 4, 12, 23, 20, 50, 520000, iso8601.FixedOffset(-5, -30, "-05:30")), "1985-04-12T23:20:50.520000-05:30"),  # https://bitbucket.org/micktwomey/pyiso8601/issue/8/015-parses-negative-timezones-incorrectly
    ("1997-08-29T06:14:00.000123Z", datetime.datetime(1997, 8, 29, 6, 14, 0, 123, iso8601.UTC), "1997-08-29T06:14:00.000123+00:00"),  # https://bitbucket.org/micktwomey/pyiso8601/issue/9/regression-parsing-microseconds
    ("2014-02", datetime.datetime(2014, 2, 1, 0, 0, 0, 0, iso8601.UTC), "2014-02-01T00:00:00+00:00"),  # https://bitbucket.org/micktwomey/pyiso8601/issue/14/regression-yyyy-mm-no-longer-parses
    ("2014", datetime.datetime(2014, 1, 1, 0, 0, 0, 0, iso8601.UTC), "2014-01-01T00:00:00+00:00"),  # YYYY
])
def test_parse_valid_date(valid_date, expected_datetime, isoformat):
    parsed = iso8601.parse_date(valid_date)
    assert parsed.year == expected_datetime.year
    assert parsed.month == expected_datetime.month
    assert parsed.day == expected_datetime.day
    assert parsed.hour == expected_datetime.hour
    assert parsed.minute == expected_datetime.minute
    assert parsed.second == expected_datetime.second
    assert parsed.microsecond == expected_datetime.microsecond
    assert parsed.tzinfo == expected_datetime.tzinfo
    assert parsed == expected_datetime
    assert parsed.isoformat() == expected_datetime.isoformat()
    copy.deepcopy(parsed)  # ensure it's deep copy-able
    pickle.dumps(parsed)  # ensure it pickles
    if isoformat:
        assert parsed.isoformat() == isoformat
    assert iso8601.parse_date(parsed.isoformat()) == parsed  # Test round trip
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                # backend code for upgrading from Samba3
# Copyright Jelmer Vernooij 2005-2007
# Copyright Andrew Bartlett 2011
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

"""Support code for upgrading from Samba 3 to Samba 4."""

__docformat__ = "restructuredText"

import ldb
import time
import pwd

from samba import Ldb, registry
from samba.param import LoadParm
from samba.provision import provision, ProvisioningError, setsysvolacl
from samba.provision.common import FILL_FULL
from samba.samba3 import passdb
from samba.samba3 import param as s3param
from samba.dcerpc import lsa, samr, security
from samba.dcerpc.security import dom_sid
from samba.credentials import Credentials
from samba import dsdb
from samba.ndr import ndr_pack
from samba import unix2nttime
from samba import generate_random_password


def import_sam_policy(samdb, policy, logger):
    """Import a Samba 3 policy.

    :param samdb: Samba4 SAM database
    :param policy: Samba3 account policy
    :param logger: Logger object
    """

    # Following entries are used -
    #    min password length, password history, minimum password age,
    #    maximum password age, lockout duration
    #
    # Following entries are not used -
    #    reset count minutes, user must logon to change password,
    #    bad lockout minutes, disconnect time

    m = ldb.Message()
    m.dn = samdb.get_default_basedn()

    if 'min password length' in policy:
        m['a01'] = ldb.MessageElement(str(policy['min password length']),
            ldb.FLAG_MOD_REPLACE, 'minPwdLength')

    if 'password history' in policy:
        m['a02'] = ldb.MessageElement(str(policy['password history']),
            ldb.FLAG_MOD_REPLACE, 'pwdHistoryLength')

    if 'minimum password age' in policy:
        min_pw_age_unix = policy['minimum password age']
        min_pw_age_nt = int(-min_pw_age_unix * (1e7))
        m['a03'] = ldb.MessageElement(str(min_pw_age_nt), ldb.FLAG_MOD_REPLACE,
            'minPwdAge')

    if 'maximum password age' in policy:
        max_pw_age_unix = policy['maximum password age']
        if max_pw_age_unix == -1 or max_pw_age_unix == 0:
            max_pw_age_nt = -0x8000000000000000
        else:
            max_pw_age_nt = int(-max_pw_age_unix * (1e7))

        m['a04'] = ldb.MessageElement(str(max_pw_age_nt), ldb.FLAG_MOD_REPLACE,
                                      'maxPwdAge')

    if 'lockout duration' in policy:
        lockout_duration_mins = policy['lockout duration']
        lockout_duration_nt = unix2nttime(lockout_duration_mins * 60)

        m['a05'] = ldb.MessageElement(str(lockout_duration_nt),
            ldb.FLAG_MOD_REPLACE, 'lockoutDuration')

    try:
        samdb.modify(m)
    except ldb.LdbError, e:
        logger.warn("Could not set account policy, (%s)", str(e))


def add_posix_attrs(logger, samdb, sid, name, nisdomain, xid_type, home=None,
        shell=None, pgid=None):
    """Add posix attributes for the user/group

    :param samdb: Samba4 sam.ldb database
    :param sid: user/group sid
    :param sid: user/group name
    :param nisdomain: name of the (fake) NIS domain
    :param xid_type: type of id (ID_TYPE_UID/ID_TYPE_GID)
    :param home: user homedir (Unix homepath)
    :param shell: user shell
    :param pgid: users primary group id
    """

    try:
        m = ldb.Message()
        m.dn = ldb.Dn(samdb, "<SID=%s>" % str(sid))
        if xid_type == "ID_TYPE_UID":
            m['unixHomeDirectory'] = ldb.MessageElement(
                str(home), ldb.FLAG_MOD_REPLACE, 'unixHomeDirectory')
            m['loginShell'] = ldb.MessageElement(
                str(shell), ldb.FLAG_MOD_REPLACE, 'loginShell')
            m['gidNumber'] = ldb.MessageElement(
                str(pgid), ldb.FLAG_MOD_REPLACE, 'gidNumber')

        m['msSFU30NisDomain'] = ldb.MessageElement(
            str(nisdomain), ldb.FLAG_MOD_REPLACE, 'msSFU30NisDomain')

        samdb.modify(m)
    except ldb.LdbError, e:
        logger.warn(
            'Could not add posix attrs for AD entry for sid=%s, (%s)',
            str(sid), str(e))

def add_ad_posix_idmap_entry(samdb, sid, xid, xid_type, logger):
    """Create idmap entry

    :param samdb: Samba4 sam.ldb database
    :param sid: user/group sid
    :param xid: user/group id
    :param xid_type: type of id (ID_TYPE_UID/ID_TYPE_GID)
    :param logger: Logger object
    """

    try:
        m = ldb.Message()
        m.dn = ldb.Dn(samdb, "<SID=%s>" % str(sid))
        if xid_type == "ID_TYPE_UID":
            m['uidNumber'] = ldb.MessageElement(
                str(xid), ldb.FLAG_MOD_REPLACE, 'uidNumber')
            m['objectClass'] = ldb.MessageElement(
                "posixAccount", ldb.FLAG_MOD_ADD, 'objectClass')
        elif xid_type == "ID_TYPE_GID":
            m['gidNumber'] = ldb.MessageElement(
                str(xid), ldb.FLAG_MOD_REPLACE, 'gidNumber')
            m['objectClass'] = ldb.MessageElement(
                "posixGroup", ldb.FLAG_MOD_ADD, 'objectClass')

        samdb.modify(m)
    except ldb.LdbError, e:
        logger.warn(
            'Could not modify AD idmap entry for sid=%s, id=%s, type=%s (%s)',
            str(sid), str(xid), xid_type, str(e))


def add_idmap_entry(idmapdb, sid, xid, xid_type, logger):
    """Create idmap entry

    :param idmapdb: Samba4 IDMAP database
    :param sid: user/group sid
    :param xid: user/group id
    :param xid_type: type of id (ID_TYPE_UID/ID_TYPE_GID)
    :param logger: Logger object
    """

    # First try to see if we already have this entry
    found = False
    msg = idmapdb.search(expression='objectSid=%s' % str(sid))
    if msg.count == 1:
        found = True

    if found:
        try:
            m = ldb.Message()
            m.dn = msg[0]['dn']
            m['xidNumber'] = ldb.MessageElement(
                str(xid), ldb.FLAG_MOD_REPLACE, 'xidNumber')
            m['type'] = ldb.MessageElement(
                xid_type, ldb.FLAG_MOD_REPLACE, 'type')
            idmapdb.modify(m)
        except ldb.LdbError, e:
            logger.warn(
                'Could not modify idmap entry for sid=%s, id=%s, type=%s (%s)',
                str(sid), str(xid), xid_type, str(e))
    else:
        try:
            idmapdb.add({"dn": "CN=%s" % str(sid),
                        "cn": str(sid),
                        "objectClass": "sidMap",
                        "objectSid": ndr_pack(sid),
                        "type": xid_type,
                        "xidNumber": str(xid)})
        except ldb.LdbError, e:
            logger.warn(
                'Could not add idmap entry for sid=%s, id=%s, type=%s (%s)',
                str(sid), str(xid), xid_type, str(e))


def import_idmap(idmapdb, samba3, logger):
    """Import idmap data.

    :param idmapdb: Samba4 IDMAP database
    :param samba3_idmap: Samba3 IDMAP database to import from
    :param logger: Logger object
    """

    try:
        samba3_idmap = samba3.get_idmap_db()
    except IOError, e:
        logger.warn('Cannot open idmap database, Ignoring: %s', str(e))
        return

    currentxid = max(samba3_idmap.get_user_hwm(), samba3_idmap.get_group_hwm())
    lowerbound = currentxid
    # FIXME: upperbound

    m = ldb.Message()
    m.dn = ldb.Dn(idmapdb, 'CN=CONFIG')
    m['lowerbound'] = ldb.MessageElement(
        str(lowerbound), ldb.FLAG_MOD_REPLACE, 'lowerBound')
    m['xidNumber'] = ldb.MessageElement(
        str(currentxid), ldb.FLAG_MOD_REPLACE, 'xidNumber')
    idmapdb.modify(m)

    for id_type, xid in samba3_idmap.ids():
        if id_type == 'UID':
            xid_type = 'ID_TYPE_UID'
        elif id_type == 'GID':
            xid_type = 'ID_TYPE_GID'
        else:
            logger.warn('Wrong type of entry in idmap (%s), Ignoring', id_type)
            continue

        sid = samba3_idmap.get_sid(xid, id_type)
        add_idmap_entry(idmapdb, dom_sid(sid), xid, xid_type, logger)


def add_group_from_mapping_entry(samdb, groupmap, logger):
    """Add or modify group from group mapping entry

    param samdb: Samba4 SAM database
    param groupmap: Groupmap entry
    param logger: Logger object
    """

    # First try to see if we already have this entry
    try:
        msg = samdb.search(
            base='<SID=%s>' % str(groupmap.sid), scope=ldb.SCOPE_BASE)
        found = True
    except ldb.LdbError, (ecode, emsg):
        if ecode == ldb.ERR_NO_SUCH_OBJECT:
            found = False
        else:
            raise ldb.LdbError(ecode, emsg)

    if found:
        logger.warn('Group already exists sid=%s, groupname=%s existing_groupname=%s, Ignoring.',
                            str(groupmap.sid), groupmap.nt_name, msg[0]['sAMAccountName'][0])
    else:
        if groupmap.sid_name_use == lsa.SID_NAME_WKN_GRP:
            # In a lot of Samba3 databases, aliases are marked as well known groups
            (group_dom_sid, rid) = groupmap.sid.split()
            if (group_dom_sid != security.dom_sid(security.SID_BUILTIN)):
                return

        m = ldb.Message()
        # We avoid using the format string to avoid needing to escape the CN values
        m.dn = ldb.Dn(samdb, "CN=X,CN=Users")
        m.dn.set_component(0, "CN", groupmap.nt_name)
        m.dn.add_base(samdb.get_default_basedn())
        m['objectClass'] = ldb.MessageElement('group', ldb.FLAG_MOD_ADD, 'objectClass')
        m['objectSid'] = ldb.MessageElement(ndr_pack(groupmap.sid), ldb.FLAG_MOD_ADD,
            'objectSid')
        m['sAMAccountName'] = ldb.MessageElement(groupmap.nt_name, ldb.FLAG_MOD_ADD,
            'sAMAccountName')

        if groupmap.comment:
            m['description'] = ldb.MessageElement(groupmap.comment, ldb.FLAG_MOD_ADD,
                'description')

        # Fix up incorrect 'well known' groups that are actually builtin (per test above) to be aliases
        if groupmap.sid_name_use == lsa.SID_NAME_ALIAS or groupmap.sid_name_use == lsa.SID_NAME_WKN_GRP:
            m['groupType'] = ldb.MessageElement(str(dsdb.GTYPE_SECURITY_DOMAIN_LOCAL_GROUP),
                ldb.FLAG_MOD_ADD, 'groupType')

        try:
            samdb.add(m, controls=["relax:0"])
        except ldb.LdbError, e:
            logger.warn('Could not add group name=%s (%s)', groupmap.nt_name, str(e))


def add_users_to_group(samdb, group, members, logger):
    """Add user/member to group/alias

    param samdb: Samba4 SAM database
    param group: Groupmap object
    param members: List of member SIDs
    param logger: Logger object
    """
    for member_sid in members:
        m = ldb.Message()
        m.dn = ldb.Dn(samdb, "<SID=%s>" % str(group.sid))
        m['a01'] = ldb.MessageElement("<SID=%s>" % str(member_sid), ldb.FLAG_MOD_ADD, 'member')

        try:
            samdb.modify(m)
        except ldb.LdbError, (ecode, emsg):
            if ecode == ldb.ERR_ENTRY_ALREADY_EXISTS:
                logger.debug("skipped re-adding member '%s' to group '%s': %s", member_sid, group.sid, emsg)
            elif ecode == ldb.ERR_NO_SUCH_OBJECT:
                raise ProvisioningError("Could not add member '%s' to group '%s' as either group or user record doesn't exist: %s" % (member_sid, group.sid, emsg))
            else:
                raise ProvisioningError("Could not add member '%s' to group '%s': %s" % (member_sid, group.sid, emsg))


def import_wins(samba4_winsdb, samba3_winsdb):
    """Import settings from a Samba3 WINS database.

    :param samba4_winsdb: WINS database to import to
    :param samba3_winsdb: WINS database to import from
    """

    version_id = 0

    for (name, (ttl, ips, nb_flags)) in samba3_winsdb.items():
        version_id += 1

        type = int(name.split("#", 1)[1], 16)

        if type == 0x1C:
            rType = 0x2
        elif type & 0x80:
            if len(ips) > 1:
                rType = 0x2
            else:
                rType = 0x1
        else:
            if len(ips) > 1:
                rType = 0x3
            else:
                rType = 0x0

        if ttl > time.time():
            rState = 0x0 # active
        else:
            rState = 0x1 # released

        nType = ((nb_flags & 0x60) >> 5)

        samba4_winsdb.add({"dn": "name=%s,type=0x%s" % tuple(name.split("#")),
                           "type": name.split("#")[1],
                           "name": name.split("#")[0],
                           "objectClass": "winsRecord",
                           "recordType": str(rType),
                           "recordState": str(rState),
                           "nodeType": str(nType),
                           "expireTime": ldb.timestring(ttl),
                           "isStatic": "0",
                           "versionID": str(version_id),
                           "address": ips})

    samba4_winsdb.add({"dn": "cn=VERSION",
                       "cn": "VERSION",
                       "objectClass": "winsMaxVersion",
                       "maxVersion": str(version_id)})


SAMBA3_PREDEF_NAMES = {
        'HKLM': registry.HKEY_LOCAL_MACHINE,
}


def import_registry(samba4_registry, samba3_regdb):
    """Import a Samba 3 registry database into the Samba 4 registry.

    :param samba4_registry: Samba 4 registry handle.
    :param samba3_regdb: Samba 3 registry database handle.
    """
    def ensure_key_exists(keypath):
        (predef_name, keypath) = keypath.split("/", 1)
        predef_id = SAMBA3_PREDEF_NAMES[predef_name]
        keypath = keypath.replace("/", "\\")
        return samba4_registry.create_key(predef_id, keypath)

    for key in samba3_regdb.keys():
        key_handle = ensure_key_exists(key)
        for subkey in samba3_regdb.subkeys(key):
            ensure_key_exists(subkey)
        for (value_name, (value_type, value_data)) in samba3_regdb.values(key).items():
            key_handle.set_value(value_name, value_type, value_data)

def get_posix_attr_from_ldap_backend(logger, ldb_object, base_dn, user, attr):
    """Get posix attributes from a samba3 ldap backend
    :param ldbs: a list of ldb connection objects
    :param base_dn: the base_dn of the connection
    :param user: the user to get the attribute for
    :param attr: the attribute to be retrieved
    """
    try:
        msg = ldb_object.search(base_dn, scope=ldb.SCOPE_SUBTREE,
                        expression=("(&(objectClass=posixAccount)(uid=%s))"
                        % (user)), attrs=[attr])
    except ldb.LdbError, e:
        raise ProvisioningError("Failed to retrieve attribute %s for user %s, the error is: %s" % (attr, user, e))
    else:
        if msg.count <= 1:
            # This will raise KeyError (which is what we want) if there isn't a entry for this user
            return msg[0][attr][0]
        else:
            logger.warning("LDAP entry for user %s contains more than one %s", user, attr)
            raise KeyError


def upgrade_from_samba3(samba3, logger, targetdir, session_info=None,
        useeadb=False, dns_backend=None, use_ntvfs=False):
    """Upgrade from samba3 database to samba4 AD database

    :param samba3: samba3 object
    :param logger: Logger object
    :param targetdir: samba4 database directory
    :param session_info: Session information
    """
    serverrole = samba3.lp.server_role()

    domainname = samba3.lp.get("workgroup")
    realm = samba3.lp.get("realm")
    netbiosname = samba3.lp.get("netbios name")

    if samba3.lp.get("ldapsam:trusted") is None:
        samba3.lp.set("ldapsam:trusted", "yes")

    # secrets db
    try:
        secrets_db = samba3.get_secrets_db()
    except IOError, e:
        raise ProvisioningError("Could not open '%s', the Samba3 secrets database: %s.  Perhaps you specified the incorrect smb.conf, --testparm or --dbdir option?" % (samba3.privatedir_path("secrets.tdb"), str(e)))

    if not domainname:
        domainname = secrets_db.domains()[0]
        logger.warning("No workgroup specified in smb.conf file, assuming '%s'",
                domainname)

    if not realm:
        if serverrole == "ROLE_DOMAIN_BDC" or serverrole == "ROLE_DOMAIN_PDC":
            raise ProvisioningError("No realm specified in smb.conf file and being a DC. That upgrade path doesn't work! Please add a 'realm' directive to your old smb.conf to let us know which one you want to use (it is the DNS name of the AD domain you wish to create.")
        else:
            realm = domainname.upper()
            logger.warning("No realm specified in smb.conf file, assuming '%s'",
                    realm)

    # Find machine account and password
    next_rid = 1000

    try:
        machinepass = secrets_db.get_machine_password(netbiosname)
    except KeyError:
        machinepass = None

    if samba3.lp.get("passdb backend").split(":")[0].strip() == "ldapsam":
        base_dn =  samba3.lp.get("ldap suffix")
        ldapuser = samba3.lp.get("ldap admin dn")
        ldappass = secrets_db.get_ldap_bind_pw(ldapuser)
        if ldappass is None:
            raise ProvisioningError("ldapsam passdb backend detected but no LDAP Bind PW found in secrets.tdb for user %s.  Please point this tool at the secrets.tdb that was used by the previous installation.")
        ldappass = ldappass.strip('\x00')
        ldap = True
    else:
        ldapuser = None
        ldappass = None
        ldap = False

    # We must close the direct pytdb database before the C code loads it
    secrets_db.close()

    # Connect to old password backend
    passdb.set_secrets_dir(samba3.lp.get("private dir"))
    s3db = samba3.get_sam_db()

    # Get domain sid
    try:
        domainsid = passdb.get_global_sam_sid()
    except passdb.error:
        raise Exception("Can't find domain sid for '%s', Exiting." % domainname)

    # Get machine account, sid, rid
    try:
        machineacct = s3db.getsampwnam('%s$' % netbiosname)
    except passdb.error:
        machinerid = None
        machinesid = None
    else:
        machinesid, machinerid = machineacct.user_sid.split()

    # Export account policy
    logger.info("Exporting account policy")
    policy = s3db.get_account_policy()

    # Export groups from old passdb backend
    logger.info("Exporting groups")
    grouplist = s3db.enum_group_mapping()
    groupmembers = {}
    for group in grouplist:
        sid, rid = group.sid.split()
        if sid == domainsid:
            if rid >= next_rid:
                next_rid = rid + 1

        # Get members for each group/alias
        if group.sid_name_use == lsa.SID_NAME_ALIAS:
            try:
                members = s3db.enum_aliasmem(group.sid)
                groupmembers[str(group.sid)] = members
            except passdb.error, e:
                logger.warn("Ignoring group '%s' %s listed but then not found: %s",
                            group.nt_name, group.sid, e)
                continue
        elif group.sid_name_use == lsa.SID_NAME_DOM_GRP:
            try:
                members = s3db.enum_group_members(group.sid)
                groupmembers[str(group.sid)] = members
            except passdb.error, e:
                logger.warn("Ignoring group '%s' %s listed but then not found: %s",
                            group.nt_name, group.sid, e)
                continue
        elif group.sid_name_use == lsa.SID_NAME_WKN_GRP:
            (group_dom_sid, rid) = group.sid.split()
            if (group_dom_sid != security.dom_sid(security.SID_BUILTIN)):
                logger.warn("Ignoring 'well known' group '%s' (should already be in AD, and have no members)",
                            group.nt_name)
                continue
            # A number of buggy databases mix up well known groups and aliases.
            try:
                members = s3db.enum_aliasmem(group.sid)
                groupmembers[str(group.sid)] = members
            except passdb.error, e:
                logger.warn("Ignoring group '%s' %s listed but then not found: %s",
                            group.nt_name, group.sid, e)
                continue
        else:
            logger.warn("Ignoring group '%s' %s with sid_name_use=%d",
                        group.nt_name, group.sid, group.sid_name_use)
            continue

    # Export users from old passdb backend
    logger.info("Exporting users")
    userlist = s3db.search_users(0)
    userdata = {}
    uids = {}
    admin_user = None
    for entry in userlist:
        if machinerid and machinerid == entry['rid']:
            continue
        username = entry['account_name']
        if entry['rid'] < 1000:
            logger.info("  Skipping wellknown rid=%d (for username=%s)", entry['rid'], username)
            continue
        if entry['rid'] >= next_rid:
            next_rid = entry['rid'] + 1

        user = s3db.getsampwnam(username)
        acct_type = (user.acct_ctrl & (samr.ACB_NORMAL|samr.ACB_WSTRUST|samr.ACB_SVRTRUST|samr.ACB_DOMTRUST))
        if acct_type == samr.ACB_SVRTRUST:
            logger.warn("  Demoting BDC account trust for %s, this DC must be elevated to an AD DC using 'samba-tool domain dcpromo'" % username[:-1])
            user.acct_ctrl = (user.acct_ctrl & ~samr.ACB_SVRTRUST) | samr.ACB_WSTRUST

        elif acct_type == samr.ACB_DOMTRUST:
            logger.warn("  Skipping inter-domain trust from domain %s, this trust must be re-created as an AD trust" % username[:-1])
            continue

        elif acct_type == (samr.ACB_WSTRUST) and username[-1] != '$':
            logger.warn("  Skipping account %s that has ACB_WSTRUST (W) set but does not end in $.  This account can not have worked, and is probably left over from a misconfiguration." % username)
            continue

        elif acct_type == (samr.ACB_NORMAL|samr.ACB_WSTRUST) and username[-1] == '$':
            logger.warn("  Fixing account %s which had both ACB_NORMAL (U) and ACB_WSTRUST (W) set.  Account will be marked as ACB_WSTRUST (W), i.e. as a domain member" % username)
            user.acct_ctrl = (user.acct_ctrl & ~samr.ACB_NORMAL)

        elif acct_type == (samr.ACB_NORMAL|samr.ACB_SVRTRUST) and username[-1] == '$':
            logger.warn("  Fixing account %s which had both ACB_NORMAL (U) and ACB_SVRTRUST (S) set.  Account will be marked as ACB_WSTRUST (S), i.e. as a domain member" % username)
            user.acct_ctrl = (user.acct_ctrl & ~samr.ACB_NORMAL)

        elif acct_type == 0 and username[-1] != '$':
            user.acct_ctrl = (user.acct_ctrl | samr.ACB_NORMAL)

        elif (acct_type == samr.ACB_NORMAL or acct_type == samr.ACB_WSTRUST):
            pass

        else:
            raise ProvisioningError("""Failed to upgrade due to invalid account %s, account control flags 0x%08X must have exactly one of
ACB_NORMAL (N, 0x%08X), ACB_WSTRUST (W 0x%08X), ACB_SVRTRUST (S 0x%08X) or ACB_DOMTRUST (D 0x%08X).

Please fix this account before attempting to upgrade again
"""
                                    % (username, user.acct_ctrl,
                                       samr.ACB_NORMAL, samr.ACB_WSTRUST, samr.ACB_SVRTRUST, samr.ACB_DOMTRUST))

        userdata[username] = user
        try:
            uids[username] = s3db.sid_to_id(user.user_sid)[0]
        except passdb.error:
            try:
                uids[username] = pwd.getpwnam(username).pw_uid
            except KeyError:
                pass

        if not admin_user and username.lower() == 'root':
            admin_user = username
        if username.lower() == 'administrator':
            admin_user = username

        try:
            group_memberships = s3db.enum_group_memberships(user);
            for group in group_memberships:
                if str(group) in groupmembers:
                    if user.user_sid not in groupmembers[str(group)]:
                        groupmembers[str(group)].append(user.user_sid)
                else:
                    groupmembers[str(group)] = [user.user_sid];
        except passdb.error, e:
            logger.warn("Ignoring group memberships of '%s' %s: %s",
                        username, user.user_sid, e)

    logger.info("Next rid = %d", next_rid)

    # Check for same username/groupname
    group_names = set([g.nt_name for g in grouplist])
    user_names = set([u['account_name'] for u in userlist])
    common_names = group_names.intersection(user_names)
    if common_names:
        logger.error("Following names are both user names and group names:")
        for name in common_names:
            logger.error("   %s" % name)
        raise ProvisioningError("Please remove common user/group names before upgrade.")

    # Check for same user sid/group sid
    group_sids = set([str(g.sid) for g in grouplist])
    if len(grouplist) != len(group_sids):
        raise ProvisioningError("Please remove duplicate group sid entries before upgrade.")
    user_sids = set(["%s-%u" % (domainsid, u['rid']) for u in userlist])
    if len(userlist) != len(user_sids):
        raise ProvisioningError("Please remove duplicate user sid entries before upgrade.")
    common_sids = group_sids.intersection(user_sids)
    if common_sids:
        logger.error("Following sids are both user and group sids:")
        for sid in common_sids:
            logger.error("   %s" % str(sid))
        raise ProvisioningError("Please remove duplicate sid entries before upgrade.")

    # Get posix attributes from ldap or the os
    homes = {}
    shells = {}
    pgids = {}
    if ldap:
        creds = Credentials()
        creds.guess(samba3.lp)
        creds.set_bind_dn(ldapuser)
        creds.set_password(ldappass)
        urls = samba3.lp.get("passdb backend").split(":",1)[1].strip('"')
        for url in urls.split():
            try:
                ldb_object = Ldb(url, credentials=creds)
            except ldb.LdbError, e:
                raise ProvisioningError("Could not open ldb connection to %s, the error message is: %s" % (url, e))
            else:
                break
    logger.info("Exporting posix attributes")
    userlist = s3db.search_users(0)
    for entry in userlist:
        username = entry['account_name']
        if username in uids.keys():
            try:
                if ldap:
                    homes[username] = get_posix_attr_from_ldap_backend(logger, ldb_object, base_dn, username, "homeDirectory")
                else:
                    homes[username] = pwd.getpwnam(username).pw_dir
            except KeyError:
                pass
            except IndexError:
                pass

            try:
                if ldap:
                    shells[username] = get_posix_attr_from_ldap_backend(logger, ldb_object, base_dn, username, "loginShell")
                else:
                    shells[username] = pwd.getpwnam(username).pw_shell
            except KeyError:
                pass
            except IndexError:
                pass

            try:
                if ldap:
                    pgids[username] = get_posix_attr_from_ldap_backend(logger, ldb_object, base_dn, username, "gidNumber")
                else:
                    pgids[username] = pwd.getpwnam(username).pw_gid
            except KeyError:
                pass
            except IndexError:
                pass

    logger.info("Reading WINS database")
    samba3_winsdb = None
    try:
        samba3_winsdb = samba3.get_wins_db()
    except IOError, e:
        logger.warn('Cannot open wins database, Ignoring: %s', str(e))

    if not (serverrole == "ROLE_DOMAIN_BDC" or serverrole == "ROLE_DOMAIN_PDC"):
        dns_backend = "NONE"

    # If we found an admin user, set a fake pw that we will override.
    # This avoids us printing out an admin password that we won't actually
    # set.
    if admin_user:
        adminpass = generate_random_password(12, 32)
    else:
        adminpass = None

    # Do full provision
    result = provision(logger, session_info,
                       targetdir=targetdir, realm=realm, domain=domainname,
                       domainsid=domainsid, next_rid=next_rid,
                       dc_rid=machinerid, adminpass = adminpass,
                       dom_for_fun_level=dsdb.DS_DOMAIN_FUNCTION_2003,
                       hostname=netbiosname.lower(), machinepass=machinepass,
                       serverrole=serverrole, samdb_fill=FILL_FULL,
                       useeadb=useeadb, dns_backend=dns_backend, use_rfc2307=True,
                       use_ntvfs=use_ntvfs, skip_sysvolacl=True)
    result.report_logger(logger)

    # Import WINS database
    logger.info("Importing WINS database")

    if samba3_winsdb:
        import_wins(Ldb(result.paths.winsdb), samba3_winsdb)

    # Set Account policy
    logger.info("Importing Account policy")
    import_sam_policy(result.samdb, policy, logger)

    # Migrate IDMAP database
    logger.info("Importing idmap database")
    import_idmap(result.idmap, samba3, logger)

    # Set the s3 context for samba4 configuration
    new_lp_ctx = s3param.get_context()
    new_lp_ctx.load(result.lp.configfile)
    new_lp_ctx.set("private dir", result.lp.get("private dir"))
    new_lp_ctx.set("state directory", result.lp.get("state directory"))
    new_lp_ctx.set("lock directory", result.lp.get("lock directory"))

    # Connect to samba4 backend
    s4_passdb = passdb.PDB(new_lp_ctx.get("passdb backend"))

    # Start a new transaction (should speed this up a little, due to index churn)
    result.samdb.transaction_start()

    logger.info("Adding groups")
    try:
        # Export groups to samba4 backend
        logger.info("Importing groups")
        for g in grouplist:
            # Ignore uninitialized groups (gid = -1)
            if g.gid != -1:
                add_group_from_mapping_entry(result.samdb, g, logger)
                add_ad_posix_idmap_entry(result.samdb, g.sid, g.gid, "ID_TYPE_GID", logger)
                add_posix_attrs(samdb=result.samdb, sid=g.sid, name=g.nt_name, nisdomain=domainname.lower(), xid_type="ID_TYPE_GID", logger=logger)

    except:
        # We need this, so that we do not give even more errors due to not cancelling the transaction
        result.samdb.transaction_cancel()
        raise

    logger.info("Committing 'add groups' transaction to disk")
    result.samdb.transaction_commit()

    logger.info("Adding users")
    # Start a new transaction (should speed this up a little, due to index churn)
    result.samdb.transaction_start()

    try:
        # Export users to samba4 backend
        logger.info("Importing users")
        for username in userdata:
            if username.lower() == 'administrator':
                if userdata[username].user_sid != dom_sid(str(domainsid) + "-500"):
                    logger.error("User 'Administrator' in your existing directory has SID %s, expected it to be %s" % (userdata[username].user_sid, dom_sid(str(domainsid) + "-500")))
                    raise ProvisioningError("User 'Administrator' in your existing directory does not have SID ending in -500")
            if username.lower() == 'root':
                if userdata[username].user_sid == dom_sid(str(domainsid) + "-500"):
                    logger.warn('User root has been replaced by Administrator')
                else:
                    logger.warn('User root has been kept in the directory, it should be removed in favour of the Administrator user')

            s4_passdb.add_sam_account(userdata[username])
            if username in uids:
                add_ad_posix_idmap_entry(result.samdb, userdata[username].user_sid, uids[username], "ID_TYPE_UID", logger)
                if (username in homes) and (homes[username] is not None) and \
                   (username in shells) and (shells[username] is not None) and \
                   (username in pgids) and (pgids[username] is not None):
                    add_posix_attrs(samdb=result.samdb, sid=userdata[username].user_sid, name=username, nisdomain=domainname.lower(), xid_type="ID_TYPE_UID", home=homes[username], shell=shells[username], pgid=pgids[username], logger=logger)

    except:
        # We need this, so that we do not give even more errors due to not cancelling the transaction
        result.samdb.transaction_cancel()
        raise

    logger.info("Committing 'add users' transaction to disk")
    result.samdb.transaction_commit()

    logger.info("Adding users to groups")
    # Start a new transaction (should speed this up a little, due to index churn)
    result.samdb.transaction_start()

    try:
        for g in grouplist:
            if str(g.sid) in groupmembers:
                add_users_to_group(result.samdb, g, groupmembers[str(g.sid)], logger)

    except:
        # We need this, so that we do not give even more errors due to not cancelling the transaction
        result.samdb.transaction_cancel()
        raise

    logger.info("Committing 'add users to groups' transaction to disk")
    result.samdb.transaction_commit()

    # Set password for administrator
    if admin_user:
        logger.info("Setting password for administrator")
        admin_userdata = s4_passdb.getsampwnam("administrator")
        admin_userdata.nt_passwd = userdata[admin_user].nt_passwd
        if userdata[admin_user].lanman_passwd:
            admin_userdata.lanman_passwd = userdata[admin_user].lanman_passwd
        admin_userdata.pass_last_set_time = userdata[admin_user].pass_last_set_time
        if userdata[admin_user].pw_history:
            admin_userdata.pw_history = userdata[admin_user].pw_history
        s4_passdb.update_sam_account(admin_userdata)
        logger.info("Administrator password has been set to password of user '%s'", admin_user)

    if result.server_role == "active directory domain controller":
        setsysvolacl(result.samdb, result.paths.netlogon, result.paths.sysvol,
                result.paths.root_uid, result.paths.root_gid,
                security.dom_sid(result.domainsid), result.names.dnsdomain,
                result.names.domaindn, result.lp, use_ntvfs)

    # FIXME: import_registry(registry.Registry(), samba3.get_registry())
    # FIXME: shares
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        # Helpers for provision stuff
# Copyright (C) Matthieu Patou <mat@matws.net> 2009-2012
#
# Based on provision a Samba4 server by
# Copyright (C) Jelmer Vernooij <jelmer@samba.org> 2007-2008
# Copyright (C) Andrew Bartlett <abartlet@samba.org> 2008
#
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

"""Helpers used for upgrading between different database formats."""

import os
import re
import shutil
import samba

from samba import Ldb, version, ntacls
from ldb import SCOPE_SUBTREE, SCOPE_ONELEVEL, SCOPE_BASE
import ldb
from samba.provision import (provision_paths_from_lp,
                            getpolicypath, set_gpos_acl, create_gpo_struct,
                            provision, ProvisioningError,
                            setsysvolacl, secretsdb_self_join)
from samba.provision.common import FILL_FULL
from samba.dcerpc import xattr, drsblobs, security
from samba.dcerpc.misc import SEC_CHAN_BDC
from samba.ndr import ndr_unpack
from samba.samdb import SamDB
from samba import _glue
import tempfile

# All the ldb related to registry are commented because the path for them is
# relative in the provisionPath object
# And so opening them create a file in the current directory which is not what
# we want
# I still keep them commented because I plan soon to make more cleaner
ERROR =     -1
SIMPLE =     0x00
CHANGE =     0x01
CHANGESD =     0x02
GUESS =     0x04
PROVISION =    0x08
CHANGEALL =    0xff

hashAttrNotCopied = set(["dn", "whenCreated", "whenChanged", "objectGUID",
    "uSNCreated", "replPropertyMetaData", "uSNChanged", "parentGUID",
    "objectCategory", "distinguishedName", "nTMixedDomain",
    "showInAdvancedViewOnly", "instanceType", "msDS-Behavior-Version",
    "nextRid", "cn", "versionNumber", "lmPwdHistory", "pwdLastSet",
    "ntPwdHistory", "unicodePwd","dBCSPwd", "supplementalCredentials",
    "gPCUserExtensionNames", "gPCMachineExtensionNames","maxPwdAge", "secret",
    "possibleInferiors", "privilege", "sAMAccountType"])


class ProvisionLDB(object):

    def __init__(self):
        self.sam = None
        self.secrets = None
        self.idmap = None
        self.privilege = None
        self.hkcr = None
        self.hkcu = None
        self.hku = None
        self.hklm = None

    def dbs(self):
        return (self.sam, self.secrets, self.idmap, self.privilege)

    def startTransactions(self):
        for db in self.dbs():
            db.transaction_start()
# TO BE DONE
#        self.hkcr.transaction_start()
#        self.hkcu.transaction_start()
#        self.hku.transaction_start()
#        self.hklm.transaction_start()

    def groupedRollback(self):
        ok = True
        for db in self.dbs():
            try:
                db.transaction_cancel()
            except Exception:
                ok = False
        return ok
# TO BE DONE
#        self.hkcr.transaction_cancel()
#        self.hkcu.transaction_cancel()
#        self.hku.transaction_cancel()
#        self.hklm.transaction_cancel()

    def groupedCommit(self):
        try:
            for db in self.dbs():
                db.transaction_prepare_commit()
        except Exception:
            return self.groupedRollback()
# TO BE DONE
#        self.hkcr.transaction_prepare_commit()
#        self.hkcu.transaction_prepare_commit()
#        self.hku.transaction_prepare_commit()
#        self.hklm.transaction_prepare_commit()
        try:
            for db in self.dbs():
                db.transaction_commit()
        except Exception:
            return self.groupedRollback()

# TO BE DONE
#        self.hkcr.transaction_commit()
#        self.hkcu.transaction_commit()
#        self.hku.transaction_commit()
#        self.hklm.transaction_commit()
        return True


def get_ldbs(paths, creds, session, lp):
    """Return LDB object mapped on most important databases

    :param paths: An object holding the different importants paths for provision object
    :param creds: Credential used for openning LDB files
    :param session: Session to use for openning LDB files
    :param lp: A loadparam object
    :return: A ProvisionLDB object that contains LDB object for the different LDB files of the provision"""

    ldbs = ProvisionLDB()

    ldbs.sam = SamDB(paths.samdb, session_info=session, credentials=creds, lp=lp, options=["modules:samba_dsdb"])
    ldbs.secrets = Ldb(paths.secrets, session_info=session, credentials=creds, lp=lp)
    ldbs.idmap = Ldb(paths.idmapdb, session_info=session, credentials=creds, lp=lp)
    ldbs.privilege = Ldb(paths.privilege, session_info=session, credentials=creds, lp=lp)
#    ldbs.hkcr = Ldb(paths.hkcr, session_info=session, credentials=creds, lp=lp)
#    ldbs.hkcu = Ldb(paths.hkcu, session_info=session, credentials=creds, lp=lp)
#    ldbs.hku = Ldb(paths.hku, session_info=session, credentials=creds, lp=lp)
#    ldbs.hklm = Ldb(paths.hklm, session_info=session, credentials=creds, lp=lp)

    return ldbs


def usn_in_range(usn, range):
    """Check if the usn is in one of the range provided.
    To do so, the value is checked to be between the lower bound and
    higher bound of a range

    :param usn: A integer value corresponding to the usn that we want to update
    :param range: A list of integer representing ranges, lower bounds are in
                  the even indices, higher in odd indices
    :return: True if the usn is in one of the range, False otherwise
    """

    idx = 0
    cont = True
    ok = False
    while cont:
        if idx ==  len(range):
            cont = False
            continue
        if usn < int(range[idx]):
            if idx %2 == 1:
                ok = True
            cont = False
        if usn == int(range[idx]):
            cont = False
            ok = True
        idx = idx + 1
    return ok


def get_paths(param, targetdir=None, smbconf=None):
    """Get paths to important provision objects (smb.conf, ldb files, ...)

    :param param: Param object
    :param targetdir: Directory where the provision is (or will be) stored
    :param smbconf: Path to the smb.conf file
    :return: A list with the path of important provision objects"""
    if targetdir is not None:
        if not os.path.exists(targetdir):
            os.mkdir(targetdir)
        etcdir = os.path.join(targetdir, "etc")
        if not os.path.exists(etcdir):
            os.makedirs(etcdir)
        smbconf = os.path.join(etcdir, "smb.conf")
    if smbconf is None:
        smbconf = param.default_path()

    if not os.path.exists(smbconf):
        raise ProvisioningError("Unable to find smb.conf at %s" % smbconf)

    lp = param.LoadParm()
    lp.load(smbconf)
    paths = provision_paths_from_lp(lp, lp.get("realm"))
    return paths

def update_policyids(names, samdb):
    """Update policy ids that could have changed after sam update

    :param names: List of key provision parameters
    :param samdb: An Ldb object conntected with the sam DB
    """
    # policy guid
    res = samdb.search(expression="(displayName=Default Domain Policy)",
                        base="CN=Policies,CN=System," + str(names.rootdn),
                        scope=SCOPE_ONELEVEL, attrs=["cn","displayName"])
    names.policyid = str(res[0]["cn"]).replace("{","").replace("}","")
    # dc policy guid
    res2 = samdb.search(expression="(displayName=Default Domain Controllers"
                                   " Policy)",
                            base="CN=Policies,CN=System," + str(names.rootdn),
                            scope=SCOPE_ONELEVEL, attrs=["cn","displayName"])
    if len(res2) == 1:
        names.policyid_dc = str(res2[0]["cn"]).replace("{","").replace("}","")
    else:
        names.policyid_dc = None


def newprovision(names, session, smbconf, provdir, logger):
    """Create a new provision.

    This provision will be the reference for knowing what has changed in the
    since the latest upgrade in the current provision

    :param names: List of provision parameters
    :param creds: Credentials for the authentification
    :param session: Session object
    :param smbconf: Path to the smb.conf file
    :param provdir: Directory where the provision will be stored
    :param logger: A Logger
    """
    if os.path.isdir(provdir):
        shutil.rmtree(provdir)
    os.mkdir(provdir)
    logger.info("Provision stored in %s", provdir)
    return provision(logger, session, smbconf=smbconf,
            targetdir=provdir, samdb_fill=FILL_FULL, realm=names.realm,
            domain=names.domain, domainguid=names.domainguid,
            domainsid=names.domainsid, ntdsguid=names.ntdsguid,
            policyguid=names.policyid, policyguid_dc=names.policyid_dc,
            hostname=names.netbiosname.lower(), hostip=None, hostip6=None,
            invocationid=names.invocation, adminpass=names.adminpass,
            krbtgtpass=None, machinepass=None, dnspass=None, root=None,
            nobody=None, users=None,
            serverrole="domain controller",
            backend_type=None, ldapadminpass=None, ol_mmr_urls=None,
            slapd_path=None,
            dom_for_fun_level=names.domainlevel, dns_backend=names.dns_backend,
            useeadb=True, use_ntvfs=True)


def dn_sort(x, y):
    """Sorts two DNs in the lexicographical order it and put higher level DN
    before.

    So given the dns cn=bar,cn=foo and cn=foo the later will be return as
    smaller

    :param x: First object to compare
    :param y: Second object to compare
    """
    p = re.compile(r'(?<!\\), ?')
    tab1 = p.split(str(x))
    tab2 = p.split(str(y))
    minimum = min(len(tab1), len(tab2))
    len1 = len(tab1)-1
    len2 = len(tab2)-1
    # Note: python range go up to upper limit but do not include it
    for i in range(0, minimum):
        ret = cmp(tab1[len1-i], tab2[len2-i])
        if ret != 0:
            return ret
        else:
            if i == minimum-1:
                assert len1!=len2,"PB PB PB" + " ".join(tab1)+" / " + " ".join(tab2)
                if len1 > len2:
                    return 1
                else:
                    return -1
    return ret


def identic_rename(ldbobj, dn):
    """Perform a back and forth rename to trigger renaming on attribute that
    can't be directly modified.

    :param lbdobj: An Ldb Object
    :param dn: DN of the object to manipulate
    """
    (before, after) = str(dn).split('=', 1)
    # we need to use relax to avoid the subtree_rename constraints
    ldbobj.rename(dn, ldb.Dn(ldbobj, "%s=foo%s" % (before, after)), ["relax:0"])
    ldbobj.rename(ldb.Dn(ldbobj, "%s=foo%s" % (before, after)), dn, ["relax:0"])


def update_secrets(newsecrets_ldb, secrets_ldb, messagefunc):
    """Update secrets.ldb

    :param newsecrets_ldb: An LDB object that is connected to the secrets.ldb
        of the reference provision
    :param secrets_ldb: An LDB object that is connected to the secrets.ldb
        of the updated provision
    """

    messagefunc(SIMPLE, "Update of secrets.ldb")
    reference = newsecrets_ldb.search(base="@MODULES", scope=SCOPE_BASE)
    current = secrets_ldb.search(base="@MODULES", scope=SCOPE_BASE)
    assert reference, "Reference modules list can not be empty"
    if len(current) == 0:
        # No modules present
        delta = secrets_ldb.msg_diff(ldb.Message(), reference[0])
        delta.dn = reference[0].dn
        secrets_ldb.add(reference[0])
    else:
        delta = secrets_ldb.msg_diff(current[0], reference[0])
        delta.dn = current[0].dn
        secrets_ldb.modify(delta)

    reference = newsecrets_ldb.search(expression="objectClass=top", base="",
                                        scope=SCOPE_SUBTREE, attrs=["dn"])
    current = secrets_ldb.search(expression="objectClass=top", base="",
                                        scope=SCOPE_SUBTREE, attrs=["dn"])
    hash_new = {}
    hash = {}
    listMissing = []
    listPresent = []

    empty = ldb.Message()
    for i in range(0, len(reference)):
        hash_new[str(reference[i]["dn"]).lower()] = reference[i]["dn"]

    # Create a hash for speeding the search of existing object in the
    # current provision
    for i in range(0, len(current)):
        hash[str(current[i]["dn"]).lower()] = current[i]["dn"]

    for k in hash_new.keys():
        if not hash.has_key(k):
            listMissing.append(hash_new[k])
        else:
            listPresent.append(hash_new[k])

    for entry in listMissing:
        reference = newsecrets_ldb.search(expression="distinguishedName=%s" % entry,
                                            base="", scope=SCOPE_SUBTREE)
        current = secrets_ldb.search(expression="distinguishedName=%s" % entry,
                                            base="", scope=SCOPE_SUBTREE)
        delta = secrets_ldb.msg_diff(empty, reference[0])
        for att in hashAttrNotCopied:
            delta.remove(att)
        messagefunc(CHANGE, "Entry %s is missing from secrets.ldb" %
                    reference[0].dn)
        for att in delta:
            messagefunc(CHANGE, " Adding attribute %s" % att)
        delta.dn = reference[0].dn
        secrets_ldb.add(delta)

    for entry in listPresent:
        reference = newsecrets_ldb.search(expression="distinguishedName=%s" % entry,
                                            base="", scope=SCOPE_SUBTREE)
        current = secrets_ldb.search(expression="distinguishedName=%s" % entry, base="",
                                            scope=SCOPE_SUBTREE)
        delta = secrets_ldb.msg_diff(current[0], reference[0])
        for att in hashAttrNotCopied:
            delta.remove(att)
        for att in delta:
            if att == "name":
                messagefunc(CHANGE, "Found attribute name on  %s,"
                                    " must rename the DN" % (current[0].dn))
                identic_rename(secrets_ldb, reference[0].dn)
            else:
                delta.remove(att)

    for entry in listPresent:
        reference = newsecrets_ldb.search(expression="distinguishedName=%s" % entry, base="",
                                            scope=SCOPE_SUBTREE)
        current = secrets_ldb.search(expression="distinguishedName=%s" % entry, base="",
                                            scope=SCOPE_SUBTREE)
        delta = secrets_ldb.msg_diff(current[0], reference[0])
        for att in hashAttrNotCopied:
            delta.remove(att)
        for att in delta:
            if att == "msDS-KeyVersionNumber":
                delta.remove(att)
            if att != "dn":
                messagefunc(CHANGE,
                            "Adding/Changing attribute %s to %s" %
                            (att, current[0].dn))

        delta.dn = current[0].dn
        secrets_ldb.modify(delta)

    res2 = secrets_ldb.search(expression="(samaccountname=dns)",
                                scope=SCOPE_SUBTREE, attrs=["dn"])

    if len(res2) == 1:
            messagefunc(SIMPLE, "Remove old dns account")
            secrets_ldb.delete(res2[0]["dn"])


def getOEMInfo(samdb, rootdn):
    """Return OEM Information on the top level Samba4 use to store version
    info in this field

    :param samdb: An LDB object connect to sam.ldb
    :param rootdn: Root DN of the domain
    :return: The content of the field oEMInformation (if any)
    """
    res = samdb.search(expression="(objectClass=*)", base=str(rootdn),
                            scope=SCOPE_BASE, attrs=["dn", "oEMInformation"])
    if len(res) > 0 and res[0].get("oEMInformation"):
        info = res[0]["oEMInformation"]
        return info
    else:
        return ""


def updateOEMInfo(samdb, rootdn):
    """Update the OEMinfo field to add information about upgrade

    :param samdb: an LDB object connected to the sam DB
    :param rootdn: The string representation of the root DN of
        the provision (ie. DC=...,DC=...)
    """
    res = samdb.search(expression="(objectClass=*)", base=rootdn,
                            scope=SCOPE_BASE, attrs=["dn", "oEMInformation"])
    if len(res) > 0:
        if res[0].get("oEMInformation"):
            info = str(res[0]["oEMInformation"])
        else:
            info = ""
        info = "%s, upgrade to %s" % (info, version)
        delta = ldb.Message()
        delta.dn = ldb.Dn(samdb, str(res[0]["dn"]))
        delta["oEMInformation"] = ldb.MessageElement(info, ldb.FLAG_MOD_REPLACE,
                                                        "oEMInformation" )
        samdb.modify(delta)

def update_gpo(paths, samdb, names, lp, message):
    """Create missing GPO file object if needed
    """
    dir = getpolicypath(paths.sysvol, names.dnsdomain, names.policyid)
    if not os.path.isdir(dir):
        create_gpo_struct(dir)

    if names.policyid_dc is None:
        raise ProvisioningError("Policy ID for Domain controller is missing")
    dir = getpolicypath(paths.sysvol, names.dnsdomain, names.policyid_dc)
    if not os.path.isdir(dir):
        create_gpo_struct(dir)

def increment_calculated_keyversion_number(samdb, rootdn, hashDns):
    """For a given hash associating dn and a number, this function will
    update the replPropertyMetaData of each dn in the hash, so that the
    calculated value of the msDs-KeyVersionNumber is equal or superior to the
    one associated to the given dn.

    :param samdb: An SamDB object pointing to the sam
    :param rootdn: The base DN where we want to start
    :param hashDns: A hash with dn as key and number representing the
                 minimum value of msDs-KeyVersionNumber that we want to
                 have
    """
    entry = samdb.search(expression='(objectClass=user)',
                         base=ldb.Dn(samdb,str(rootdn)),
                         scope=SCOPE_SUBTREE, attrs=["msDs-KeyVersionNumber"],
                         controls=["search_options:1:2"])
    done = 0
    hashDone = {}
    if len(entry) == 0:
        raise ProvisioningError("Unable to find msDs-KeyVersionNumber")
    else:
        for e in entry:
            if hashDns.has_key(str(e.dn).lower()):
                val = e.get("msDs-KeyVersionNumber")
                if not val:
                    val = "0"
                version = int(str(hashDns[str(e.dn).lower()]))
                if int(str(val)) < version:
                    done = done + 1
                    samdb.set_attribute_replmetadata_version(str(e.dn),
                                                              "unicodePwd",
                                                              version, True)
def delta_update_basesamdb(refsampath, sampath, creds, session, lp, message):
    """Update the provision container db: sam.ldb
    This function is aimed for alpha9 and newer;

    :param refsampath: Path to the samdb in the reference provision
    :param sampath: Path to the samdb in the upgraded provision
    :param creds: Credential used for openning LDB files
    :param session: Session to use for openning LDB files
    :param lp: A loadparam object
    :return: A msg_diff object with the difference between the @ATTRIBUTES
             of the current provision and the reference provision
    """

    message(SIMPLE,
            "Update base samdb by searching difference with reference one")
    refsam = Ldb(refsampath, session_info=session, credentials=creds,
                    lp=lp, options=["modules:"])
    sam = Ldb(sampath, session_info=session, credentials=creds, lp=lp,
                options=["modules:"])

    empty = ldb.Message()
    deltaattr = None
    reference = refsam.search(expression="")

    for refentry in reference:
        entry = sam.search(expression="distinguishedName=%s" % refentry["dn"],
                            scope=SCOPE_SUBTREE)
        if not len(entry):
            delta = sam.msg_diff(empty, refentry)
            message(CHANGE, "Adding %s to sam db" % str(refentry.dn))
            if str(refentry.dn) == "@PROVISION" and\
                delta.get(samba.provision.LAST_PROVISION_USN_ATTRIBUTE):
                delta.remove(samba.provision.LAST_PROVISION_USN_ATTRIBUTE)
            delta.dn = refentry.dn
            sam.add(delta)
        else:
            delta = sam.msg_diff(entry[0], refentry)
            if str(refentry.dn) == "@ATTRIBUTES":
                deltaattr = sam.msg_diff(refentry, entry[0])
            if str(refentry.dn) == "@PROVISION" and\
                delta.get(samba.provision.LAST_PROVISION_USN_ATTRIBUTE):
                delta.remove(samba.provision.LAST_PROVISION_USN_ATTRIBUTE)
            if len(delta.items()) > 1:
                delta.dn = refentry.dn
                sam.modify(delta)

    return deltaattr


def construct_existor_expr(attrs):
    """Construct a exists or LDAP search expression.

    :param attrs: List of attribute on which we want to create the search
        expression.
    :return: A string representing the expression, if attrs is empty an
        empty string is returned
    """
    expr = ""
    if len(attrs) > 0:
        expr = "(|"
        for att in attrs:
            expr = "%s(%s=*)"%(expr,att)
        expr = "%s)"%expr
    return expr

def update_machine_account_password(samdb, secrets_ldb, names):
    """Update (change) the password of the current DC both in the SAM db and in
       secret one

    :param samdb: An LDB object related to the sam.ldb file of a given provision
    :param secrets_ldb: An LDB object related to the secrets.ldb file of a given
                        provision
    :param names: List of key provision parameters"""

    expression = "samAccountName=%s$" % names.netbiosname
    secrets_msg = secrets_ldb.search(expression=expression,
                                        attrs=["secureChannelType"])
    if int(secrets_msg[0]["secureChannelType"][0]) == SEC_CHAN_BDC:
        res = samdb.search(expression=expression, attrs=[])
        assert(len(res) == 1)

        msg = ldb.Message(res[0].dn)
        machinepass = samba.generate_random_machine_password(128, 255)
        mputf16 = machinepass.encode('utf-16-le')
        msg["clearTextPassword"] = ldb.MessageElement(mputf16,
                                                ldb.FLAG_MOD_REPLACE,
                                                "clearTextPassword")
        samdb.modify(msg)

        res = samdb.search(expression=("samAccountName=%s$" % names.netbiosname),
                     attrs=["msDs-keyVersionNumber"])
        assert(len(res) == 1)
        kvno = int(str(res[0]["msDs-keyVersionNumber"]))
        secChanType = int(secrets_msg[0]["secureChannelType"][0])

        secretsdb_self_join(secrets_ldb, domain=names.domain,
                    realm=names.realm,
                    domainsid=names.domainsid,
                    dnsdomain=names.dnsdomain,
                    netbiosname=names.netbiosname,
                    machinepass=machinepass,
                    key_version_number=kvno,
                    secure_channel_type=secChanType)
    else:
        raise ProvisioningError("Unable to find a Secure Channel"
                                "of type SEC_CHAN_BDC")

def update_dns_account_password(samdb, secrets_ldb, names):
    """Update (change) the password of the dns both in the SAM db and in
       secret one

    :param samdb: An LDB object related to the sam.ldb file of a given provision
    :param secrets_ldb: An LDB object related to the secrets.ldb file of a given
                        provision
    :param names: List of key provision parameters"""

    expression = "samAccountName=dns-%s" % names.netbiosname
    secrets_msg = secrets_ldb.search(expression=expression)
    if len(secrets_msg) == 1:
        res = samdb.search(expression=expression, attrs=[])
        assert(len(res) == 1)

        msg = ldb.Message(res[0].dn)
        machinepass = samba.generate_random_password(128, 255)
        mputf16 = machinepass.encode('utf-16-le')
        msg["clearTextPassword"] = ldb.MessageElement(mputf16,
                                                ldb.FLAG_MOD_REPLACE,
                                                "clearTextPassword")

        samdb.modify(msg)

        res = samdb.search(expression=expression,
                     attrs=["msDs-keyVersionNumber"])
        assert(len(res) == 1)
        kvno = str(res[0]["msDs-keyVersionNumber"])

        msg = ldb.Message(secrets_msg[0].dn)
        msg["secret"] = ldb.MessageElement(machinepass,
                                                ldb.FLAG_MOD_REPLACE,
                                                "secret")
        msg["msDS-KeyVersionNumber"] = ldb.MessageElement(kvno,
                                                ldb.FLAG_MOD_REPLACE,
                                                "msDS-KeyVersionNumber")

        secrets_ldb.modify(msg)

def update_krbtgt_account_password(samdb, names):
    """Update (change) the password of the krbtgt account

    :param samdb: An LDB object related to the sam.ldb file of a given provision
    :param names: List of key provision parameters"""

    expression = "samAccountName=krbtgt"
    res = samdb.search(expression=expression, attrs=[])
    assert(len(res) == 1)

    msg = ldb.Message(res[0].dn)
    machinepass = samba.generate_random_machine_password(128, 255)
    mputf16 = machinepass.encode('utf-16-le')
    msg["clearTextPassword"] = ldb.MessageElement(mputf16,
                                                  ldb.FLAG_MOD_REPLACE,
                                                  "clearTextPassword")

    samdb.modify(msg)

def search_constructed_attrs_stored(samdb, rootdn, attrs):
    """Search a given sam DB for calculated attributes that are
    still stored in the db.

    :param samdb: An LDB object pointing to the sam
    :param rootdn: The base DN where the search should start
    :param attrs: A list of attributes to be searched
    :return: A hash with attributes as key and an array of
             array. Each array contains the dn and the associated
             values for this attribute as they are stored in the
             sam."""

    hashAtt = {}
    expr = construct_existor_expr(attrs)
    if expr == "":
        return hashAtt
    entry = samdb.search(expression=expr, base=ldb.Dn(samdb, str(rootdn)),
                         scope=SCOPE_SUBTREE, attrs=attrs,
                         controls=["search_options:1:2","bypassoperational:0"])
    if len(entry) == 0:
        # Nothing anymore
        return hashAtt

    for ent in entry:
        for att in attrs:
            if ent.get(att):
                if hashAtt.has_key(att):
                    hashAtt[att][str(ent.dn).lower()] = str(ent[att])
                else:
                    hashAtt[att] = {}
                    hashAtt[att][str(ent.dn).lower()] = str(ent[att])

    return hashAtt

def findprovisionrange(samdb, basedn):
    """ Find ranges of usn grouped by invocation id and then by timestamp
        rouned at 1 minute

        :param samdb: An LDB object pointing to the samdb
        :param basedn: The DN of the forest

        :return: A two level dictionary with invoication id as the
                first level, timestamp as the second one and then
                max, min, and number as subkeys, representing respectivily
                the maximum usn for the range, the minimum usn and the number
                of object with usn in this range.
    """
    nb_obj = 0
    hash_id = {}

    res = samdb.search(base=basedn, expression="objectClass=*",
                                    scope=ldb.SCOPE_SUBTREE,
                                    attrs=["replPropertyMetaData"],
                                    controls=["search_options:1:2"])

    for e in res:
        nb_obj = nb_obj + 1
        obj = ndr_unpack(drsblobs.replPropertyMetaDataBlob,
                            str(e["replPropertyMetaData"])).ctr

        for o in obj.array:
            # like a timestamp but with the resolution of 1 minute
            minutestamp =_glue.nttime2unix(o.originating_change_time)/60
            hash_ts = hash_id.get(str(o.originating_invocation_id))

            if hash_ts is None:
                ob = {}
                ob["min"] = o.originating_usn
                ob["max"] = o.originating_usn
                ob["num"] = 1
                ob["list"] = [str(e.dn)]
                hash_ts = {}
            else:
                ob = hash_ts.get(minutestamp)
                if ob is None:
                    ob = {}
                    ob["min"] = o.originating_usn
                    ob["max"] = o.originating_usn
                    ob["num"] = 1
                    ob["list"] = [str(e.dn)]
                else:
                    if ob["min"] > o.originating_usn:
                        ob["min"] = o.originating_usn
                    if ob["max"] < o.originating_usn:
                        ob["max"] = o.originating_usn
                    if not (str(e.dn) in ob["list"]):
                        ob["num"] = ob["num"] + 1
                        ob["list"].append(str(e.dn))
            hash_ts[minutestamp] = ob
            hash_id[str(o.originating_invocation_id)] = hash_ts

    return (hash_id, nb_obj)

def print_provision_ranges(dic, limit_print, dest, samdb_path, invocationid):
    """ print the differents ranges passed as parameter

        :param dic: A dictionnary as returned by findprovisionrange
        :param limit_print: minimum number of object in a range in order to print it
        :param dest: Destination directory
        :param samdb_path: Path to the sam.ldb file
        :param invoicationid: Invocation ID for the current provision
    """
    ldif = ""

    for id in dic:
        hash_ts = dic[id]
        sorted_keys = []
        sorted_keys.extend(hash_ts.keys())
        sorted_keys.sort()

        kept_record = []
        for k in sorted_keys:
            obj = hash_ts[k]
            if obj["num"] > limit_print:
                dt = _glue.nttime2string(_glue.unix2nttime(k*60))
                print "%s # of modification: %d  \tmin: %d max: %d" % (dt , obj["num"],
                                                                    obj["min"],
                                                                    obj["max"])
            if hash_ts[k]["num"] > 600:
                kept_record.append(k)

        # Let's try to concatenate consecutive block if they are in the almost same minutestamp
        for i in range(0, len(kept_record)):
            if i != 0:
                key1 = kept_record[i]
                key2 = kept_record[i-1]
                if key1 - key2 == 1:
                    # previous record is just 1 minute away from current
                    if int(hash_ts[key1]["min"]) == int(hash_ts[key2]["max"]) + 1:
                        # Copy the highest USN in the previous record
                        # and mark the current as skipped
                        hash_ts[key2]["max"] = hash_ts[key1]["max"]
                        hash_ts[key1]["skipped"] = True

        for k in kept_record:
                obj = hash_ts[k]
                if obj.get("skipped") is None:
                    ldif = "%slastProvisionUSN: %d-%d;%s\n" % (ldif, obj["min"],
                                obj["max"], id)

    if ldif != "":
        file = tempfile.mktemp(dir=dest, prefix="usnprov", suffix=".ldif")
        print
        print "To track the USNs modified/created by provision and upgrade proivsion,"
        print " the following ranges are proposed to be added to your provision sam.ldb: \n%s" % ldif
        print "We recommend to review them, and if it's correct to integrate the following ldif: %s in your sam.ldb" % file
        print "You can load this file like this: ldbadd -H %s %s\n"%(str(samdb_path),file)
        ldif = "dn: @PROVISION\nprovisionnerID: %s\n%s" % (invocationid, ldif)
        open(file,'w').write(ldif)

def int64range2str(value):
    """Display the int64 range stored in value as xxx-yyy

    :param value: The int64 range
    :return: A string of the representation of the range
    """

    lvalue = long(value)
    str = "%d-%d" % (lvalue&0xFFFFFFFF, lvalue>>32)
    return str
                                                                                                                                                                                # -*- coding: utf-8 -*-
#
# Unix SMB/CIFS implementation.
# Copyright  Jelmer Vernooij <jelmer@samba.org> 2008
#
# Implementation of SWAT that uses WSGI
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

def render_placeholder(environ, start_response):
    """Send the user a simple placeholder about missing SWAT."""
    status = '200 OK'
    response_headers = [('Content-type', 'text/html')]
    start_response(status, response_headers)

    yield "<!doctype html>\n"
    yield "<html>\n"
    yield "  <title>The Samba web service</title>\n"
    yield "</html>\n"

    yield "<body>\n"
    yield "<p>Welcome to this Samba web server.</p>\n"
    yield "<p>This page is a simple placeholder. You probably want to install "
    yield "SWAT. More information can be found "
    yield "<a href='http://wiki.samba.org/index.php/SWAT2'>on the wiki</a>.</p>"
    yield "</p>\n"
    yield "</body>\n"
    yield "</html>\n"


def __call__(environ, start_response):
    """Handle a HTTP request."""
    from wsgiref.util import application_uri, shift_path_info
    from urlparse import urljoin

    try:
        import swat
    except ImportError, e:
        print "NO SWAT: %r" % e
        have_swat = False
    else:
        have_swat = True

    orig_path = environ['PATH_INFO']
    name = shift_path_info(environ)

    if name == "":
        if have_swat:
            start_response('301 Redirect',
                [('Location', urljoin(application_uri(environ), 'swat')),])
            return []
        else:
            return render_placeholder(environ, start_response)
    elif have_swat and name == "swat":
        return swat.__call__(environ, start_response)
    else:
        status = '404 Not found'
        response_headers = [('Content-type', 'text/html')]
        start_response(status, response_headers)
        return ["The path %s (%s) was not found" % (orig_path, name)]


if __name__ == '__main__':
    from wsgiref import simple_server
    httpd = simple_server.make_server('localhost', 8090, __call__)
    print "Serving HTTP on port 8090..."
    httpd.serve_forever()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             # Utility code for dealing with POSIX extended attributes
#
# Copyright (C) Jelmer Vernooij <jelmer@samba.org> 2012
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

from samba.dcerpc import xattr
import os
import samba.xattr_native
import shutil


def copyattrs(frompath, topath):
    """Copy ACL related attributes from a path to another path."""
    for attr_name in (xattr.XATTR_NTACL_NAME, "system.posix_acl_access"):
        # Get the xattr attributes if any
        try:
            attribute = samba.xattr_native.wrap_getxattr(frompath,
                                         xattr.XATTR_NTACL_NAME)
            samba.xattr_native.wrap_setxattr(topath,
                                         xattr.XATTR_NTACL_NAME,
                                         attribute)
        except Exception:
            pass
            # FIXME:Catch a specific exception


def copytree_with_xattrs(src, dst):
    """Recursively copy a directory tree using shutil.copy2(), preserving xattrs.

    The destination directory must not already exist.
    If exception(s) occur, an Error is raised with a list of reasons.
    """
    names = os.listdir(src)

    os.makedirs(dst)
    errors = []
    for name in names:
        srcname = os.path.join(src, name)
        dstname = os.path.join(dst, name)
        if os.path.islink(srcname):
            linkto = os.readlink(srcname)
            os.symlink(linkto, dstname)
        elif os.path.isdir(srcname):
            copytree_with_xattrs(srcname, dstname)
        else:
            # Will raise a SpecialFileError for unsupported file types
            shutil.copy2(srcname, dstname)
    shutil.copystat(src, dst)
    copyattrs(src, dst)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ELF          (    (  4   !    4    (                               t  t t                                          $   $         Qtd                          Rtdt  t t                    GNU Q9d>-D&             $1 B          4BE|WqXRvT<Yy                    x       	     |                                   R           "                                                          ^             '                                                                      5             >             u              a                             8                 H          D          H          H          D           x       	 M    H       D           \          H         __gmon_start__ _init _fini _ITM_deregisterTMCloneTable _ITM_registerTMCloneTable __cxa_finalize _Jv_RegisterClasses _Py_TrueStruct _PyArg_ParseTuple_SizeT talloc_named_const getxattr _talloc_zero_array PyString_FromStringAndSize _talloc_free __errno_location PyErr_SetFromErrno PyExc_TypeError PyExc_IOError setxattr _Py_NoneStruct initxattr_native Py_InitModule4 libpthread.so.0 libpython2.7.so.1.0 libtalloc.so.2 libattr.so.1 libc.so.6 _edata __bss_start __bss_start__ __bss_end__ __end__ _end samba/xattr_native.so /usr/lib/arm-linux-gnueabihf/samba GLIBC_2.4 TALLOC_2.0.2 ATTR_1.0                                                    m         ii   *                 "   4                 ii   *                 p(	   A      t    x                                         $     (     0            	                                    
                    @-)  -             0 0   R/h L   404 0  0 0C S 00/ 0  S//  , @   88    A,0A0/ 0  S//   \   L0L 0  0  S/80@-0  S  
(0 0 0  L  <     8 80    0  R     0  S
@-3/@ 8 X   0 0 / T    H@-M0 0a` @P  
$!    0  P a @P  0 0 e0   p T P   S @ f _ 0_ S  
00  I W @Q 0_ S	  
\00  ;T I @@00  1,00  ,   l      D       H   0@-$M 000 0 0"PP  P  
 @  0 @ P  d00      $0 0_ S  
800   $0 00     4 P   D   H   -M( (  $ $  0      8    @-ss  talloc_new: ../source4/ntvfs/posix/python/pyxattr_native.c:71   ../source4/ntvfs/posix/python/pyxattr_native.c:79   char    ../source4/ntvfs/posix/python/pyxattr_native.c:91   ../source4/ntvfs/posix/python/pyxattr_native.c:95   sss#    Python bindings for xattr manipulation. xattr_native    wrap_getxattr   wrap_getxattr(filename,attribute) -> blob
Retrieve given attribute on the given file.   wrap_setxattr   wrap_setxattr(filename,attribute,value)
Set the given attribute to the given value on the given file.   is_xattr_supported  Return true if xattr are supported on this system
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  P	           m     }                              x     \     t          x       o     d     d  
   J               `                 p                     o   o  o   o  o                                                                                                                     	         0       l  	                       A,   aeabi "   6 	
"3916d907ecfdca98a7643edb9b2d4426a3ec8f.debug     .shstrtab .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .eh_frame .init_array .fini_array .jcr .dynamic .got .data .bss .ARM.attributes .gnu_debuglink                                                        $                     o       L                (         d  d                 0         d  d  J                 8   o       @                E   o                       T   	      p  p                  ]   	   B       `               f         x  x                    a                              l         (  (  4                 r         \  \                    x      2   d  d  P                                                        t t                            x x                            | |                                                            `                                 D                           D  D                          p        D   -                                q   4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ELF          (    0	  4   !    4    (                               \  \ \              h  h h 0  0                    $   $         Qtd                          Rtd\  \ \                    GNU Db32J`cK4              1 B          4BE|WqXvT<Yy                    h       	     d       b             R           "                               P             @                                        2                                                       #             u              a                                           8                                                         8  H          D        K  H        }  `  H     7  H          D           h       	 )  D                   C  H         __gmon_start__ _init _fini _ITM_deregisterTMCloneTable _ITM_registerTMCloneTable __cxa_finalize _Jv_RegisterClasses _Py_TrueStruct _PyArg_ParseTuple_SizeT talloc_named_const py_default_loadparm_context lpcfg_tdb_flags db_open_tdb __xstat64 xattr_tdb_setattr _talloc_free PyErr_SetFromErrno _Py_NoneStruct PyExc_IOError PyExc_TypeError xattr_tdb_getattr PyString_FromStringAndSize initxattr_tdb Py_InitModule4 libsamba-python.so.0 libsamba-hostconfig.so.0 libxattr-tdb.so.0 libdbwrap.so.0 libpython2.7.so.1.0 libtalloc.so.2 libc.so.6 _edata __bss_start __bss_start__ __bss_end__ __end__ _end samba/xattr_tdb.so /usr/lib/arm-linux-gnueabihf/samba SAMBA_4.5.16_DEBIAN SAMBA_HOSTCONFIG_0.0.1 TALLOC_2.0.2 GLIBC_2.4                                                                                 Q5                    "                                                            ii         \    `                                         $     (     0                                             	   
                          @-/  -               0 0   R/X T   404 0  0 0C S 00/ 0  S//   H   88    A,0A0/ 0  S//   d   L0L 0  0  S/80@-0  S  
(0 0 0  D  D     8 80    0  R     0  S
@-3/@ ( `   0 0 / \   G-M$0 0(000 0  0xQP  P<  
t!$0   ,0v e  @n   0!-B0 0$! 0
 j @P7  
H  g  P  ,j 0 @ (0 @c@@D@O P  
 @00      00  "|
 0  h00  \
 & 800  8
       P    X   P      L       G- M| 0 0$ 0d
 @P6  
X!    P $@   0!-B0 0! 0  @P3  
H    P  j( 0    @ 0 c@@D@ P  (  @  |0 @0  l \00  P 000  0      P    P   8  L   D    -M( (  $ $  0     x L  ,  @-ssss#   talloc_new: ../source4/ntvfs/posix/python/pyxattr_tdb.c:59  ../source4/ntvfs/posix/python/pyxattr_tdb.c:69  ../source4/ntvfs/posix/python/pyxattr_tdb.c:76  ../source4/ntvfs/posix/python/pyxattr_tdb.c:87  ../source4/ntvfs/posix/python/pyxattr_tdb.c:90  sss talloc_new: ../source4/ntvfs/posix/python/pyxattr_tdb.c:110 ../source4/ntvfs/posix/python/pyxattr_tdb.c:120 ../source4/ntvfs/posix/python/pyxattr_tdb.c:127 ../source4/ntvfs/posix/python/pyxattr_tdb.c:138 ../source4/ntvfs/posix/python/pyxattr_tdb.c:142 Python bindings for xattr manipulation. xattr_tdb   wrap_getxattr   wrap_getxattr(filename,attribute) -> blob
Retrieve given attribute on the given file.   wrap_setxattr   wrap_setxattr(filename,attribute,value)
Set the given attribute to the given value on the given file.   is_xattr_supported  Return true if xattr are supported on this system
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              X
  	                                            P     c     h          \          `       o          d  
                  p                 P                     o   o  o   oL  o                                           h         t  t  t  t  t  t  t  t  t  t  t  t  t  t                                                  P  
     `    
                       A,   aeabi "   6 	
"b56285b2ee338ee8328d851adc4a60b9634b34.debug    H .shstrtab .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .eh_frame .init_array .fini_array .jcr .dynamic .got .data .bss .ARM.attributes .gnu_debuglink                                                        $                     o       L                (         d  d                 0                              8   o   L  L  D                E   o                       T   	      P  P                  ]   	   B       p               f         h  h                    a         t  t                   l         0	  0	  x                 r                               x      2       `                                                        \ \                            ` `                            d d                             h h  0                           h                                 D                           D  D                          p        D   -                                q   4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Yr7}WbiM)J,&lw%Y3`\9+E@OVc)4:~.rt|$SJV7.$7kz}p J[1V%uiZ*kq^2Zf"_*7:QBTH#aJ:3t!oIcU"YIp.2E	(BEsc)LUR VN*UXFuiETt#J&VF`11#ecPH&L>ULHu!+VJ)2	7{I<K6_T[YKl
G$8mTOBY%zY+kJ)	UL^'xCT=Ubbmq'lViM"+m*(o Y5Aq~>95qy%yl'Id.vwr,Fi0jn]yYq|.!="	JJ"BeYlF=C8vJ%d,*ZUc`(.|Y
QAI_xzluP; e*)r91fPq+*Kl'IO#T#k/HaSR!*yX[2c*s88y4Dr`B% asR8mmCX:{XAo\LXi//UfP-
e4OjFcVrYS.)H@i2_~N@F{Hto7>oe|hk8<;kijhLJqaB<Cr
K|@r/zC)dO|2EootKP t(
L/pl<G }7$mL}Kqh_Q=&am1@t9"7o>~nGKsz1SZ* ;06j+ [5C?`
LEGax"	(&Fa'?<[bYTEF5hMbGje	*3x}MN 2j!}ObdU7+Tym HgI:	 ,Q}'#F>9\= +*vYr U^_#u\>Qw`8x`#t0"m7 K GN&KDp'++tt|U)Jr608bhwEDt/]64SF UfaiJg%8m}w`X(r4-HqT0(4/>4$XoOG~TcH:6E3! q5^XG#qt^h!.Rr Ux#M9#]qt%9PzrUp#4>V&L"4! VNL t1fRdH-T+5FqkVRu:$: SsB`jDCXH\[VU}|XK]"1Ol!#Ajx*.$8~5;~=;;/Al;NPOD|*P.0* ^?Z%G>X\M4>#|'Z-&i(:=&]DW(6h%>SATv! 	Y"5H-U[vvs5Scvi+WF'0mZ }e;M@#'
'&)C79>Vo }W/XN';Itvv*^NyY1:M7cnsiT6ySd:.zEY5o#51t	;Z!PjI$d18Y6:cBYwB3"ejK(P{ULT)q@
Pv 7"jEphP'g"xOTMG?W7[wo7GuW	Q|K T?VJj;v&d+4 N]41=c<y[a,P^ry@v d*!yfp`/dzBz%H0Bb)R(eCva4R$H_LKMR\/{JfG7)6l{7[RHvy~$rPN,&!(J>Mtmov)_s8e<= 364yJa(Rv>Z(J ^_DJu@]^P,/cz.=(MRx6<Ww}L{$0WJL@r	mz=/
dOt<n/AOsvr$\xsq6x=yhwHivCpeL?NAW
M2uu"# QO.	56!
$t5s0U@td^EU[?M9Zmg%VX'rgbu&gzz`I(NxdB2 V8==0?OyOC@tx
]wugA)\6vS`!]4syw/9ga$NbRA+l2!3I1A_0l^k,U36~sJT$g9W}4% *+\NA~Ay56\&1a~!+2g}4U[ni<# a&G.[Bb{}:M:O~L/CC17^PIjh9Y'=@A0	f[X  N$REu"+ie>H>(BCtuUav}`Vqw{B`@+\ ~)(Hg:qjcHx[R(3toN	{Uw0B>=>#_rsY!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Format: http://www.debian.org/doc/packaging-manuals/copyright-format/1.0/
Upstream-Name: samba
Upstream-Contact: Samba Developers <samba-technical@lists.samba.org>
Source: http://www.samba.org/
Files-Excluded:
  source4/heimdal/lib/wind/rfc*.txt
  source4/ldap_server/devdocs

Files: *
Copyright: 1992-2012 Andrew Tridgell and the Samba Team
License: GPL-3+
 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 3 of the License, or
 (at your option) any later version.
 .
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 .
 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
 Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
 .
 On Debian systems, the full text of the GPL v3 can be found in
 /usr/share/common-licenses/GPL-3

Files: source4/heimdal/*
Copyright:
 1996-2005 Kungliga Tekniska Hgskolan
 (Royal Institute of Technology, Stockholm, Sweden).
License: BSD-3
 All rights reserved.
 .
 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions
 are met:
 .
 1. Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.
 .
 2. Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the
    documentation and/or other materials provided with the distribution.
 .
 3. Neither the name of the Institute nor the names of its contributors
    may be used to endorse or promote products derived from this software
    without specific prior written permission.
 .
 THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND
 ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE
 FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 SUCH DAMAGE.

Files:
 lib/talloc/*
 lib/tdb/*
 lib/ldb/*
Copyright: 1992-2012 Andrew Tridgell and the Samba Team
License: LGPL-3+
 This library is free software; you can redistribute it and/or
 modify it under the terms of the GNU Lesser General Public
 License as published by the Free Software Foundation; either
 version 3 of the License, or (at your option) any later version.
 .
 This library is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 Lesser General Public License for more details.
 .
 You should have received a copy of the GNU Lesser General Public
 License along with this library; if not, write to the Free Software
 Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 .
 On Debian systems, the full text of the LGPL v3 can be found in
 /usr/share/common-licenses/LGPL-3

Files: source4/setup/ad-schema/*.txt
Comment: part of the Microsoft protocol documentation
Copyright: Microsoft Corporation
License: MS-ADSL
 License for the Active Directory schemas:
 .
 Intellectual Property Rights Notice for Protocol Documentation.
 .
 Copyrights.
 This protocol documentation is covered by Microsoft copyrights. Regardless
 of any other terms that are contained in the terms of use for the Microsoft
 website that hosts this documentation, you may make copies of it in order to
 develop implementations of the protocols, and may distribute portions of it
 in your implementations of the protocols or your documentation as necessary
 to properly document the implementation. You may also distribute in your
 implementation, with or without modification, any schema, IDLs, or code
 samples that are included in the documentation. This permission also applies
 to any documents that are referenced in the protocol documentation.
 .
 No Trade Secrets.
 Microsoft does not claim any trade secret rights in this documentation.
 .
 Patents.
 Microsoft has patents that may cover your implementations of the protocols.
 Neither this notice nor Microsoft's delivery of the documentation grants any
 licenses under those or any other Microsoft patents. However, the protocols
 may be covered by Microsoft's Open Specification Promise (available here:
 http://www.microsoft.com/interop/osp). If you would prefer a written
 license, or if the protocols are not covered by the OSP, patent
 licenses are available by contacting protocol@microsoft.com.
 .
 Trademarks.
 The names of companies and products contained in this documentation may be
 covered by trademarks or similar intellectual property rights. This notice
 does not grant any licenses under those rights.
 .
 Reservation of Rights.
 All other rights are reserved, and this notice does not grant any rights
 other than specifically described above, whether by implication, estoppel,
 or otherwise.
 .
 Tools.
 This protocol documentation is intended for use in conjunction with
 publicly available standard specifications and network programming art,
 and assumes that the reader either is familiar with the aforementioned
 material or has immediate access to it. A protocol specification does not
 require the use of Microsoft programming tools or programming environments
 in order for you to develop an implementation. If you have access to
 Microsoft programming tools and environments you are free to take
 advantage of them.

Files: debian/*
Copyright:
  2005-2012 Jelmer Vernooij <jelmer@debian.org>
  2005-2006 Steinar H. Gunderson
  2001-2011 Steve Langasek <vorlon@debian.org>,
  2005-2012 Christian Perrier <bubulle@debian.org>,
  2005-2008 Nol Kthe <noel@debian.org>,
  2005-2008 Peter Eisentraut <petere@debian.org>, et al.
License: GPL-3
 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; version 3 dated June, 2007.
 .
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 .
 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
 Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
 .
 On Debian systems, the full text of the GPL v3 can be found in
 /usr/share/common-licenses/GPL-3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /.
/usr
/usr/lib
/usr/lib/python2.7
/usr/lib/python2.7/dist-packages
/usr/lib/python2.7/dist-packages/samba
/usr/lib/python2.7/dist-packages/samba/__init__.py
/usr/lib/python2.7/dist-packages/samba/_glue.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/_ldb.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/auth.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/com.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/common.py
/usr/lib/python2.7/dist-packages/samba/credentials.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dbchecker.py
/usr/lib/python2.7/dist-packages/samba/dcerpc
/usr/lib/python2.7/dist-packages/samba/dcerpc/__init__.py
/usr/lib/python2.7/dist-packages/samba/dcerpc/atsvc.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/auth.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/base.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/dcerpc.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/dfs.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/dns.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/dnsp.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/dnsserver.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/drsblobs.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/drsuapi.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/echo.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/epmapper.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/idmap.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/initshutdown.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/irpc.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/krb5pac.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/lsa.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/mgmt.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/misc.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/nbt.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/netlogon.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/samr.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/security.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/server_id.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/smb_acl.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/srvsvc.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/svcctl.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/unixinfo.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/winbind.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/winreg.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/wkssvc.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dcerpc/xattr.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/descriptor.py
/usr/lib/python2.7/dist-packages/samba/drs_utils.py
/usr/lib/python2.7/dist-packages/samba/dsdb.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/dsdb_dns.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/gensec.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/getopt.py
/usr/lib/python2.7/dist-packages/samba/hostconfig.py
/usr/lib/python2.7/dist-packages/samba/idmap.py
/usr/lib/python2.7/dist-packages/samba/join.py
/usr/lib/python2.7/dist-packages/samba/kcc
/usr/lib/python2.7/dist-packages/samba/kcc/__init__.py
/usr/lib/python2.7/dist-packages/samba/kcc/debug.py
/usr/lib/python2.7/dist-packages/samba/kcc/graph.py
/usr/lib/python2.7/dist-packages/samba/kcc/graph_utils.py
/usr/lib/python2.7/dist-packages/samba/kcc/kcc_utils.py
/usr/lib/python2.7/dist-packages/samba/kcc/ldif_import_export.py
/usr/lib/python2.7/dist-packages/samba/messaging.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/ms_display_specifiers.py
/usr/lib/python2.7/dist-packages/samba/ms_schema.py
/usr/lib/python2.7/dist-packages/samba/ndr.py
/usr/lib/python2.7/dist-packages/samba/net.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/netbios.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/netcmd
/usr/lib/python2.7/dist-packages/samba/netcmd/__init__.py
/usr/lib/python2.7/dist-packages/samba/netcmd/common.py
/usr/lib/python2.7/dist-packages/samba/netcmd/dbcheck.py
/usr/lib/python2.7/dist-packages/samba/netcmd/delegation.py
/usr/lib/python2.7/dist-packages/samba/netcmd/dns.py
/usr/lib/python2.7/dist-packages/samba/netcmd/domain.py
/usr/lib/python2.7/dist-packages/samba/netcmd/drs.py
/usr/lib/python2.7/dist-packages/samba/netcmd/dsacl.py
/usr/lib/python2.7/dist-packages/samba/netcmd/fsmo.py
/usr/lib/python2.7/dist-packages/samba/netcmd/gpo.py
/usr/lib/python2.7/dist-packages/samba/netcmd/group.py
/usr/lib/python2.7/dist-packages/samba/netcmd/ldapcmp.py
/usr/lib/python2.7/dist-packages/samba/netcmd/main.py
/usr/lib/python2.7/dist-packages/samba/netcmd/nettime.py
/usr/lib/python2.7/dist-packages/samba/netcmd/ntacl.py
/usr/lib/python2.7/dist-packages/samba/netcmd/processes.py
/usr/lib/python2.7/dist-packages/samba/netcmd/rodc.py
/usr/lib/python2.7/dist-packages/samba/netcmd/sites.py
/usr/lib/python2.7/dist-packages/samba/netcmd/spn.py
/usr/lib/python2.7/dist-packages/samba/netcmd/testparm.py
/usr/lib/python2.7/dist-packages/samba/netcmd/user.py
/usr/lib/python2.7/dist-packages/samba/ntacls.py
/usr/lib/python2.7/dist-packages/samba/param.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/policy.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/posix_eadb.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/provision
/usr/lib/python2.7/dist-packages/samba/provision/__init__.py
/usr/lib/python2.7/dist-packages/samba/provision/backend.py
/usr/lib/python2.7/dist-packages/samba/provision/common.py
/usr/lib/python2.7/dist-packages/samba/provision/sambadns.py
/usr/lib/python2.7/dist-packages/samba/registry.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/remove_dc.py
/usr/lib/python2.7/dist-packages/samba/samba3
/usr/lib/python2.7/dist-packages/samba/samba3/__init__.py
/usr/lib/python2.7/dist-packages/samba/samba3/libsmb_samba_internal.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/samba3/param.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/samba3/passdb.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/samba3/smbd.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/samdb.py
/usr/lib/python2.7/dist-packages/samba/schema.py
/usr/lib/python2.7/dist-packages/samba/sd_utils.py
/usr/lib/python2.7/dist-packages/samba/security.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/sites.py
/usr/lib/python2.7/dist-packages/samba/smb.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/subnets.py
/usr/lib/python2.7/dist-packages/samba/subunit
/usr/lib/python2.7/dist-packages/samba/subunit/__init__.py
/usr/lib/python2.7/dist-packages/samba/subunit/run.py
/usr/lib/python2.7/dist-packages/samba/tdb_util.py
/usr/lib/python2.7/dist-packages/samba/tests
/usr/lib/python2.7/dist-packages/samba/tests/__init__.py
/usr/lib/python2.7/dist-packages/samba/tests/auth.py
/usr/lib/python2.7/dist-packages/samba/tests/blackbox
/usr/lib/python2.7/dist-packages/samba/tests/blackbox/__init__.py
/usr/lib/python2.7/dist-packages/samba/tests/blackbox/ndrdump.py
/usr/lib/python2.7/dist-packages/samba/tests/blackbox/samba_dnsupdate.py
/usr/lib/python2.7/dist-packages/samba/tests/blackbox/samba_tool_drs.py
/usr/lib/python2.7/dist-packages/samba/tests/common.py
/usr/lib/python2.7/dist-packages/samba/tests/core.py
/usr/lib/python2.7/dist-packages/samba/tests/credentials.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/__init__.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/array.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/bare.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/dnsserver.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/integer.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/misc.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/raw_protocol.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/registry.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/rpc_talloc.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/rpcecho.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/sam.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/srvsvc.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/string.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/testrpc.py
/usr/lib/python2.7/dist-packages/samba/tests/dcerpc/unix.py
/usr/lib/python2.7/dist-packages/samba/tests/dns.py
/usr/lib/python2.7/dist-packages/samba/tests/dns_forwarder.py
/usr/lib/python2.7/dist-packages/samba/tests/dns_forwarder_helpers
/usr/lib/python2.7/dist-packages/samba/tests/dns_forwarder_helpers/server.py
/usr/lib/python2.7/dist-packages/samba/tests/dns_tkey.py
/usr/lib/python2.7/dist-packages/samba/tests/docs.py
/usr/lib/python2.7/dist-packages/samba/tests/dsdb.py
/usr/lib/python2.7/dist-packages/samba/tests/gensec.py
/usr/lib/python2.7/dist-packages/samba/tests/get_opt.py
/usr/lib/python2.7/dist-packages/samba/tests/hostconfig.py
/usr/lib/python2.7/dist-packages/samba/tests/kcc
/usr/lib/python2.7/dist-packages/samba/tests/kcc/__init__.py
/usr/lib/python2.7/dist-packages/samba/tests/kcc/graph.py
/usr/lib/python2.7/dist-packages/samba/tests/kcc/graph_utils.py
/usr/lib/python2.7/dist-packages/samba/tests/kcc/kcc_utils.py
/usr/lib/python2.7/dist-packages/samba/tests/kcc/ldif_import_export.py
/usr/lib/python2.7/dist-packages/samba/tests/libsmb_samba_internal.py
/usr/lib/python2.7/dist-packages/samba/tests/messaging.py
/usr/lib/python2.7/dist-packages/samba/tests/netcmd.py
/usr/lib/python2.7/dist-packages/samba/tests/ntacls.py
/usr/lib/python2.7/dist-packages/samba/tests/param.py
/usr/lib/python2.7/dist-packages/samba/tests/policy.py
/usr/lib/python2.7/dist-packages/samba/tests/posixacl.py
/usr/lib/python2.7/dist-packages/samba/tests/provision.py
/usr/lib/python2.7/dist-packages/samba/tests/registry.py
/usr/lib/python2.7/dist-packages/samba/tests/samba3.py
/usr/lib/python2.7/dist-packages/samba/tests/samba3sam.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/__init__.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/base.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/fsmo.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/gpo.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/group.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/join.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/ntacl.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/processes.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/rodc.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/sites.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/timecmd.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/user.py
/usr/lib/python2.7/dist-packages/samba/tests/samba_tool/user_check_password_script.py
/usr/lib/python2.7/dist-packages/samba/tests/samdb.py
/usr/lib/python2.7/dist-packages/samba/tests/security.py
/usr/lib/python2.7/dist-packages/samba/tests/source.py
/usr/lib/python2.7/dist-packages/samba/tests/strings.py
/usr/lib/python2.7/dist-packages/samba/tests/subunitrun.py
/usr/lib/python2.7/dist-packages/samba/tests/unicodenames.py
/usr/lib/python2.7/dist-packages/samba/tests/upgrade.py
/usr/lib/python2.7/dist-packages/samba/tests/upgradeprovision.py
/usr/lib/python2.7/dist-packages/samba/tests/upgradeprovisionneeddc.py
/usr/lib/python2.7/dist-packages/samba/tests/xattr.py
/usr/lib/python2.7/dist-packages/samba/third_party
/usr/lib/python2.7/dist-packages/samba/third_party/__init__.py
/usr/lib/python2.7/dist-packages/samba/third_party/iso8601
/usr/lib/python2.7/dist-packages/samba/third_party/iso8601/__init__.py
/usr/lib/python2.7/dist-packages/samba/third_party/iso8601/iso8601.py
/usr/lib/python2.7/dist-packages/samba/third_party/iso8601/test_iso8601.py
/usr/lib/python2.7/dist-packages/samba/upgrade.py
/usr/lib/python2.7/dist-packages/samba/upgradehelpers.py
/usr/lib/python2.7/dist-packages/samba/web_server
/usr/lib/python2.7/dist-packages/samba/web_server/__init__.py
/usr/lib/python2.7/dist-packages/samba/xattr.py
/usr/lib/python2.7/dist-packages/samba/xattr_native.arm-linux-gnueabihf.so
/usr/lib/python2.7/dist-packages/samba/xattr_tdb.arm-linux-gnueabihf.so
/usr/share
/usr/share/doc
/usr/share/doc/python-samba
/usr/share/doc/python-samba/NEWS.Debian.gz
/usr/share/doc/python-samba/changelog.Debian.gz
/usr/share/doc/python-samba/copyright
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  8ab5ceb5d57b2a8e6db80d56b6d96dea  usr/share/doc/samba-common/NEWS.Debian.gz
0123bd1cb58c2d0dfe406a771872dc88  usr/share/doc/samba-common/README.gz
de70e072a689459a62281b64b3a27d28  usr/share/doc/samba-common/Roadmap
c3a21802cabc0e08d58795ea1e418f23  usr/share/doc/samba-common/WHATSNEW.txt.gz
2fbce5c68b65182ca7f4d3212860b290  usr/share/doc/samba-common/changelog.Debian.gz
bedf99aa0e71d2c782cac8958701a721  usr/share/doc/samba-common/copyright
322437a9494ff2fb39654f28ab4813d6  usr/share/doc/samba-common/examples/smb.conf.default.gz
0904acf51aed18eb09a0f3b7b41ae277  usr/share/lintian/overrides/samba-common
e0677a7a3415f9b7717821b0db416520  usr/share/samba/panic-action
95b44915e267400669b2724e0cce5967  usr/share/samba/smb.conf
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #!/bin/sh
set -e
# Automatically added by dh_installdeb
dpkg-maintscript-helper mv_conffile /etc/dhcp3/dhclient-enter-hooks.d/samba /etc/dhcp/dhclient-enter-hooks.d/samba 2:4.1.4+dfsg-2~ -- "$@"
# End automatically added section
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           #!/bin/sh

set -e
# Source debconf library.
. /usr/share/debconf/confmodule

# Function for grabbing a parameter from an smb.conf file
smbconf_retr() {
	if [ -z "$1" ]; then
		return
	fi

	if [ -n "$2" ]; then
		local FILE="$2"
	fi

	if [ -z "$FILE" ]; then
		return
	fi

	sed -n -e"
		s/^[[:space:]]*\[global\]/\[global\]/i
		/^\[global\]/,/^[[:space:]]*\[/ {
			s/^[[:space:]]*$1[[:space:]]*=[[:space:]]*//pi
		}" $FILE \
	| tail -n 1
}

FILE=/etc/samba/smb.conf

db_settitle samba-common/title

# We ask the question IFF the config contains complex options that could
# cause us to break the config.
if [ -f "$FILE" ] && grep -v dhcp.conf $FILE \
                     | grep -qEi '\\$|^[[:space:]]*include[[:space:]]*='
then
	db_input high samba-common/do_debconf || true
	db_go
else
	db_set samba-common/do_debconf true
fi

# If user doesn't want to use debconf to configure Samba the leave...
db_get samba-common/do_debconf || true
if [ "${RET}" = "false" ]; then
	exit 0
fi

# User wants to use debconf, let's continue...

# Preload any values from the existing smb.conf file
if [ -f $FILE ]; then
	WORKGROUP=`smbconf_retr workgroup`
	if [ "$WORKGROUP" ]; then
		db_set samba-common/workgroup "$WORKGROUP"
	fi

fi

# Get workgroup name
db_input medium samba-common/workgroup || true
db_go

DHCPPRIORITY=medium
#if [ "$DEBCONF_RECONFIGURE" = 1 ] && [ -f /sbin/dhclient3 ]
if [ -f /sbin/dhclient3 ]
then
	DHCPPRIORITY=high
# TODO: see if we can detect that dhcp-client is *going* to be installed,
# even if it isn't yet.
#elif dpkg-query -W --showformat='${Status}\n' dhcp-client | grep ???
# unknown ok not-installed ? 
#	DHCPPRIORITY=high
fi

FOUND=false
if [ -f $FILE ]; then
	if grep -q 'include[[:space:]]*=[[:space:]]*/etc/samba/dhcp.conf' $FILE
	then
		FOUND=true
	fi
	db_set samba-common/dhcp $FOUND
fi

# we only prompt in one of three cases: the file doesn't exist yet, it
# has the context we need to add our include line, or the include line
# is already present.
if [ ! -f $FILE ] || grep -q -i 'wins server' $FILE || [ "$FOUND" = "true" ];
then
	db_input $DHCPPRIORITY samba-common/dhcp || true
	db_go
fi
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     #!/bin/sh
#
#

set -e

# Do debconf stuff here
. /usr/share/debconf/confmodule

TEMPDIR=/var/run/samba/upgrades
NEWFILE=$TEMPDIR/smb.conf
CONFIG=/etc/samba/smb.conf

# ------------------------- Debconf questions start ---------------------

configure_smb_conf() {
	local CONFIG
	CONFIG="$1"

	# Is the user configuring with debconf, or he/she prefers
	# swat/manual config?
	db_get samba-common/do_debconf || true
	if [ "${RET}" != "true" ]; then
		return 0
	fi

	# Get workgroup name
	db_get samba-common/workgroup || true
	WORKGROUP="${RET}"

	# Oh my GOD, this is ugly.  Why would anyone put these
	# characters in a workgroup name?  Why, Lord, why???
	WORKGROUP=`echo $WORKGROUP | \
	           sed -e's/\\\\/\\\\\\\\/g
	                  s#/#\\\\/#g
	                  s/&/\\\&/g
	                  s/\\\$/\\\\\\\$/g'`

	sed -i -e "s/^\([[:space:]]*\)\[global\]/\1\[global\]/i
		/^[[:space:]]*\[global\]/,/^[[:space:]]*\[/ \
			s/^\([[:space:]]*\)workgroup[[:space:]]*=.*/\1workgroup = ${WORKGROUP}/i" \
		"$CONFIG"

	# Install DHCP support
	db_get samba-common/dhcp
	if [ "$RET" = true ] && \
	   ! grep -q dhcp.conf "$CONFIG"
	then
		sed -i -e "s/^\([[:space:]]*\)\[global\]/\1\[global\]/i
			/^[[:space:]]*\[global\]/,/^[[:space:]]*\[/ {
				/wins server[[:space:]]*=/a \\
\\
# If we receive WINS server info from DHCP, override the options above. \\
   include = /etc/samba/dhcp.conf
}" "$CONFIG"
	elif [ "$RET" != true ]; then
		sed -i -e '
		/^#[[:space:]]*If we receive WINS server info from DHCP, override the options above/d
		/^#*[[:space:]]*include[[:space:]]*=[[:space:]]*\/etc\/samba\/dhcp.conf/,/[^[:space:]]/ {
			/^#*[[:space:]]*include[[:space:]]*=[[:space:]]*\/etc\/samba\/dhcp.conf/d
			/^[[:space:]]*$/d
		}' "$CONFIG"
	fi

}


if [ -e "$CONFIG" ]; then
	configure_smb_conf "$CONFIG"
fi

mkdir -p "$TEMPDIR"

cp /usr/share/samba/smb.conf "$NEWFILE"
configure_smb_conf "$NEWFILE"

if [ -e "$CONFIG" ]; then
	sed -e '1,/^[;#[:space:]]*\[cdrom\]/ { d }
		1,/^[[:space:]]*\[/ { /^[^[]/d; /^$/d }
	' "$CONFIG" >> "$NEWFILE"
fi

ucf --three-way --debconf-ok "$NEWFILE" "$CONFIG"

if [ ! -e "$CONFIG" ]; then
	echo "Install/upgrade will fail. To recover, please try:"
	echo " sudo cp /usr/share/samba/smb.conf $CONFIG"
	echo " sudo dpkg --configure -a"
else
	ucfr samba-common "$CONFIG"
	chmod a+r "$CONFIG"
fi

# ------------------------- Debconf questions end ---------------------

db_stop

# Automatically added by dh_installdeb
dpkg-maintscript-helper mv_conffile /etc/dhcp3/dhclient-enter-hooks.d/samba /etc/dhcp/dhclient-enter-hooks.d/samba 2:4.1.4+dfsg-2~ -- "$@"
# End automatically added section


# Clean up the now-empty dir which our conffile was previously in,
# since it wasn't empty at the time dpkg could automatically remove it
# for us.
if dpkg --compare-versions "$2" lt-nl 2:4.1.4+dfsg-2~
then
	rmdir -p --ignore-fail-on-non-empty /etc/dhcp3/dhclient-enter-hooks.d
fi


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   #!/bin/sh

set -e
if [ "$1" = purge ]; then

	# Remove Samba's state files, both volatile and non-volatile
	rm -Rf /var/run/samba/ /var/cache/samba/ /var/lib/samba

	# Remove log files
	rm -Rf /var/log/samba/

	rm -rf /etc/samba/ /var/cache/samba/ /var/lib/samba/ /var/run/samba/
	if [ -x "`which ucf 2>/dev/null`" ]; then
		ucf --purge /etc/samba/smb.conf
	fi
	if [ -x "`which ucfr 2>/dev/null`" ]; then
		ucfr --purge samba-common /etc/samba/smb.conf
	fi
fi

# Automatically added by dh_installdeb
dpkg-maintscript-helper mv_conffile /etc/dhcp3/dhclient-enter-hooks.d/samba /etc/dhcp/dhclient-enter-hooks.d/samba 2:4.1.4+dfsg-2~ -- "$@"
# End automatically added section
# Automatically added by dh_installdebconf
if [ "$1" = purge ] && [ -e /usr/share/debconf/confmodule ]; then
	. /usr/share/debconf/confmodule
	db_purge
fi
# End automatically added section

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 #!/bin/sh

set -e

if [ "$(readlink -f /etc/dhcp/dhclient-enter-hooks.d/samba)" = /etc/dhcp3/dhclient-enter-hooks.d/samba ] \
   && dpkg --compare-versions "$2" le-nl 2:4.1.4+dfsg-2~
then
	rm -f /etc/dhcp/dhclient-enter-hooks.d/samba
fi

# Automatically added by dh_installdeb
dpkg-maintscript-helper mv_conffile /etc/dhcp3/dhclient-enter-hooks.d/samba /etc/dhcp/dhclient-enter-hooks.d/samba 2:4.1.4+dfsg-2~ -- "$@"
# End automatically added section

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             /etc/dhcp/dhclient-enter-hooks.d/samba
/etc/pam.d/samba
/etc/samba/gdbcommands
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Yr7}WbiM)J,&lw%Y3`\9+E@OVc)4:~.rt|$SJV7.$7kz}p J[1V%uiZ*kq^2Zf"_*7:QBTH#aJ:3t!oIcU"YIp.2E	(BEsc)LUR VN*UXFuiETt#J&VF`11#ecPH&L>ULHu!+VJ)2	7{I<K6_T[YKl
G$8mTOBY%zY+kJ)	UL^'xCT=Ubbmq'lViM"+m*(o Y5Aq~>95qy%yl'Id.vwr,Fi0jn]yYq|.!="	JJ"BeYlF=C8vJ%d,*ZUc`(.|Y
QAI_xzluP; e*)r91fPq+*Kl'IO#T#k/HaSR!*yX[2c*s88y4Dr`B% asR8mmCX:{XAo\LXi//UfP-
e4OjFcVrYS.)H@i2_~N@F{Hto7>oe|hk8<;kijhLJqaB<Cr
K|@r/zC)dO|2EootKP t(
L/pl<G }7$mL}Kqh_Q=&am1@t9"7o>~nGKsz1SZ* ;06j+ [5C?`
LEGax"	(&Fa'?<[bYTEF5hMbGje	*3x}MN 2j!}ObdU7+Tym HgI:	 ,Q}'#F>9\= +*vYr U^_#u\>Qw`8x`#t0"m7 K GN&KDp'++tt|U)Jr608bhwEDt/]64SF UfaiJg%8m}w`X(r4-HqT0(4/>4$XoOG~TcH:6E3! q5^XG#qt^h!.Rr Ux#M9#]qt%9PzrUp#4>V&L"4! VNL t1fRdH-T+5FqkVRu:$: SsB`jDCXH\[VU}|XK]"1Ol!#Ajx*.$8~5;~=;;/Al;NPOD|*P.0* ^?Z%G>X\M4>#|'Z-&i(:=&]DW(6h%>SATv! 	Y"5H-U[vvs5Scvi+WF'0mZ }e;M@#'
'&)C79>Vo }W/XN';Itvv*^NyY1:M7cnsiT6ySd:.zEY5o#51t	;Z!PjI$d18Y6:cBYwB3"ejK(P{ULT)q@
Pv 7"jEphP'g"xOTMG?W7[wo7GuW	Q|K T?VJj;v&d+4 N]41=c<y[a,P^ry@v d*!yfp`/dzBz%H0Bb)R(eCva4R$H_LKMR\/{JfG7)6l{7[RHvy~$rPN,&!(J>Mtmov)_s8e<= 364yJa(Rv>Z(J ^_DJu@]^P,/cz.=(MRx6<Ww}L{$0WJL@r	mz=/
dOt<n/AOsvr$\xsq6x=yhwHivCpeL?NAW
M2uu"# QO.	56!
$t5s0U@td^EU[?M9Zmg%VX'rgbu&gzz`I(NxdB2 V8==0?OyOC@tx
]wugA)\6vS`!]4syw/9ga$NbRA+l2!3I1A_0l^k,U36~sJT$g9W}4% *+\NA~Ay56\&1a~!+2g}4U[ni<# a&G.[Bb{}:M:O~L/CC17^PIjh9Y'=@A0	f[X  N$REu"+ie>H>(BCtuUav}`Vqw{B`@+\ ~)(Hg:qjcHx[R(3toN	{Uw0B>=>#_rsY!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ZksF_0RL%9VUDyM:	4@4=v7IffUC<^nWmjMe7ZZJO5F-n^+]B5u3oZGnm.\^riugM3;(
wjuo}vck])w[N.[WSUy.]+u+k[aNmOPa]v+pnVv=Hf+u]NWUx/
u=lsC)e0V|* sny{n9f7QJji-]:?{{T6Aoe,[nwd(UUZN`}~PMl*9-zJkaRm>N<^}\eYvvT9?Qje7/12aJf\*uAuP){wq$b[Nx^B9JqdzwfVb{6'f5^xl]T}i^q:|/i,S.]
\Y	k^oL46p#2*6i]O&j~7j(j#rC_G\kpa;R[,-]+}4\C*;rW0]	v2s#6U78r s8t.MQN3<].8bd]m
O)yBHO)1!_R"4kW]v5!P'SFgjjPvV,Y9VX;c#B@pK
GwW w3D"%W9Bk8 	07k	#[(0"T,O8$vR/Ol|WaO]MHC@3\e@5M#0M>QbwSh$t-Y"^n^j1y=>,J$4t1._.obMx}d#	eCq6!w3pBC]{\D T`n[?zL !4*>s36#t(<0$	(|5	cX/@wG,gpTbT.HX@zTN,EEGQt"._BXkVUE=O<|}rs)
$[
T0>NJ)_j_(w{X`$40oRxI!o<vN}'S#<=OTnyb>F1+TZ.9TvgY$HtO<B3DID; ?8[~p"+\ O \;re|32;hz@'TFP%wb{h5yBp,F{@B"tuX""&3W$O	,u{w .u'{<<rKF,'QVPryyyGy^I/eE/_[~~-[!UgxIbG9ee
Zlec1@R07Ca
.d< ]cc]>)~y	\1KREB GP"1S)\ nglZyo|j{d FPp~F,A0	 ;~"f#2UBb[8W1Tt!Il8.z/ M,e_dV#aAwMz)5WT	FCKC[w0f<#>./g	+RQEc?~sMBT0tdkPKvFx#96jBN
tP%xW)6^P+&KS)YI1"F|5ZGIMv"6;W&P5lL7
 8@2_cN@ hlW "PS2&iUnDVKb$<>Cp(!vp>40UA|@-@m!N>}pq$PGC0 {G`[9(t.#o
SIssJ]f*wy{jfgC^ZYqT2L2M*DR&pHC)2}etf1)
`n/M+$#+9G>W@ LM0zUKZ],((D!2-"jf{rTE+kaBl\:3CkeMPP|=pdp/fv'b=No!<`'G(=aLx6eRK(Iye$.z.{yxY	YZPB,m6;J?`D@FPhywV@	%!?U_tUl/bKty<.uWSWm|`FdAC+|{VeN\"H:@a3IU d%u_}mc}*s%oY)Op	- 72DI%!{cb]^w~Xp!Vym$D6lGaqZw'Aj dN:DQh>&=4a.y:IaJRcnpDr;?U|) V%CN%,z9W'5	NY9FQ]aAm}N7f[Jv`)%aq)D\a#r48"~M>$`Sgg\'qr[sod3#;\g^1Px(7)^o\_a =gic+^9kexad^J2}(+jlHm.a`K0.WsGOndbOu1)ywUqU0"i
TS8rJ9.![M570eh
cG/H]N]9[!:)7vFt$b!6Oq$g Rx:g7A ^\K`|R'TTQ&D^%-TJ7hU#S9\_m*9P&
[k`8NKOd>0vk^Gs~S.	TVF!!%&O#2^|y?;;nI`C/]&"                                                                                                                                                                                                            Copyright (C) 1997-2015 Samba-Team

The Samba-Team are committed to an aggressive program to deliver quality
controlled software to a well defined roadmap.

Please also look at the Release planning pages of wiki.samba.org for more
information.

The following development objectives for future releases
are in progress:
----------------------------------------------------------------------------
Samba-4.0.x		This release turned into security maintenance mode
			since we released 4.2.

Samba-4.1.x		Our previous release including the AD domain
			controller feature, the file server and other
			functionality from Samba 4.0.

Samba-4.2.x		Our current release.


Note that it is a given that the Samba-Team will continue to track
Windows releases, ensuring that Samba will work
well with whatever releases Redmond throws our way :-).
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \[s8~@eH$U8]3HH$8i[];_7@/Lfw%D76~h@;/[PVS++&&Cjo;;=QY0sfmrRX"0Y2!0S|0(27:PMTMOTe$DUv%\W$B*Km$#&dBQV2L&S%"` VHRGzgbA	LjX2`Rlob72L"JT&b~DJvq~(ljL&L8+(Bb{m-1^'iD1mpDWkMh2	*QD)KNe v^O/^HbUbn;:"]HLYx7:4~dEG#T<,iI.sRAYD9r=R
"Eb	V!tahDI`mYiTiHOJ	Uh4K'2
\H<BNz2u`<,mSc9$;g827TD"d2amZvDFgdfGl1F9G'){cYvA-}6tC'mt~!***kX|@92gO7mK.B(u@FzHX+)xeo!uj	ZGjWx$8LB'gWg0axOH0O_:}JM%Li_Lo=N@fD+W,~F"F@Ar>8tDEDRgA{)	 Q967j`01Dn:y6g$6Q*#+tu&rC!c:`] RD)lkn\"u?ES 
],3
k MHt)AnTE[~rnMiOKjdY?Wu.8#x^VR{amyILDzi=z?;+vlvVpED&'mtL$60aVW_.,8$D Jw0&p`:3MC<3^c7	0Kl0}l,@=8Py`.?^{3)DW
J"KBUA5@cE
0?sH<;"IIXDkr4wl&o
JZ+
 >{p)ILhk$!EJjs^&"$) a$MzA"Gz|^Dz kL+txsSj|liYG4i{^]gos3Xxk}h5 }aVN|2JO.	l1j2i_[i}zU{tCwnt7zJ~4z;Qr\bUvj6):cR**	y&(GbPSnh%_*i*aIi~*;2XR. !Cv D]F9#d	$Sb&L8,yg"t0c$u* TSioAA UxU&nXSd3\yUD(#*3*)paf|;!5#OHeqUIVX,:)[hJ%y~K3X)wE=M8nR#i7	/TgJQf~;b[!b1[bZDzGi%J'L}~IG&orQJ;Ou-c(:r"dIez\ i1tA?4'T4yI+`y&&&xNWm1u{+GL_A`Q6cDMBq8J;8<D>^:$@s=Cn-2.{CeC,5Iy5">5nmM(Az3bp!1
AsqrL,W#b
fLX)xDa>[p/I"^x~.w3@}#C(4Y*CVLtJg[An2 bb?@R0Lw1Todq(dW;
&c(`'2"%8/.?G/NgGqi$x`Op*6k3(e)OpdXh Q^R*/|"|_*[uCe:{hENg'eLv]"-[L|'>RJ}Vh*a+D;[LZ:iafK)5}^,a@|
@()S[CAMX<{pQ9(	870*$qF7}J*i.V <'s*&K'3(lH6[U{*:k;Z5zt|J
#Fn?UZ6of[n__vaJ@di+:n}E*[H>/$1&`O#@Fs^VZG (Q,.D.,B~6,0/_cm">O2b_S
wc<9mY a'vu)oQycSTx[H"N	:I	/8I{+F<zg}^@<[TBC\gjJGjIZTvS}.UD|;$9iD7R9{LE}>7W{ "X^/OF=:<9|K><)-*4Xaw}m'aDMQR[H]?}P"sw".Y^(dp>wF}SjjHk(Q!D0w	sZL`5^_~<x7:=x<::>9<>Z"S!u+^_/..lg'!t\G0WVp_VsSi Ni]/$bkSrnpx^S[(o5`JocS26|ij*o5kBFFGWj:LkyQY;H<YlIM*]nZXTuXr^H	=Bn?jp! Jce"Czi2 SnR?M 
%{Ke:9_T2}BIYJ
/w!bu{eiwRR])gd10BlJWd3b|l=kw/Ulom~?V-HQpOrGg~}igw21z T}2)Bf%>gd_s>OwOwU {Bu6Z9[/\-]EUdYEdvq~ebuXqbnr~t"`;.vngLaaWgkY2d*'#g cTu1go2A0r#W_>%r66p>Q4@=QSw_fvWt"e[O}]y2!6RN==w'<(2cec.OJpJ~FODl
z_q:X$Sltxq|p49Hm1'\i!n7X.=oeLu V18^eP,BF54"^2h\ZjXVah^	c\y@NVS@%E_ktJ.vL>;>U]< L\K$|w[+mH=^AUu{|ALSwu^@I8Wo:$fYR=Z}"1X 7o	fw
m4_2
z*7A8A=s?wKRkHnN'%&OiriRv0"{vrFDW|?2Z3F. yMRPvOR77
tFNz#4-68=Ri$IQ}%Hl7LIGFzN*+odN[.fy]drJAIU&10G4cd()JRA5<_];=tvVENC3Enyu0^3	T|qA`[/(txyV<+RnM'S~hdWNx<'^;vpxd"9owODilBY:Qbwfwyn\_of;8##~G0pnY|"H$L)qsm #9+S	5Z5:r4 'kMUHKX$u13vkED!gr(K/OL!/+O.3J\!'j34j2Oh{c'sPF0PO&:^KB,"Ci*6'w!H&uK[L6YL*tmWte*++*EEqO*!s*U]vHjeK4\#HKw
z8?g+(+(A/ /)+_vx2mVwYW~8:loN,XyGLpEG!8[UDMr,'pq=G3GV@1RTapO=EiO15._q,QT~I6h{bmvt|Ax}.5%z
'6	limhokCF8d[6l#mWW2PlG3y}-X0dme+WtM2t)#IN`E_/HiHrS?]XnQtVH( (uqt	`R`p.*#%&=v,2&dFQiv4::qPTn/mvCa)}=@$]nIrm@aacd>spDk6>p{x|[d}i@Mj ZJF)Ml#Mm\5?lA{v vU(DWu>LS#<X&zERU<o	$|vULD%-&>EqN	nYE4JPQotF854h>Q\} ?6bdA+1iK!cc"O}S\98vBG\.:?]&:il=F
G2h>.T+{I=2rP37 lhSN_R<hW16DIHmZ\WA9o,+BI!|,DvISCy1]tQk>fHP#S.<S{Y|4CVw (Q>%X@=4})LSJRaeT(@^3/Fbl_Jg1Iu)i| P7[D>Zen;"ti3ZKiY%i;mEC5\@6a<2\%5W#">plK,[0
)vg# hzerR@BQg*2FuP#{,RvZ+y2 ^!`{{W@J)nk6[b\Ki@Ph*mY8A$(a:
=r_,oXhkqC PzXb 0O gLO!6|)*G
~BmqD_&!6$[Wu(@@0$xxdY28 vl"C6b%`4hi6t>A~?~<|0[ .!S5_kZU1!qyEI|0d|s*n=nCvIo{lu~aRe@|kVL
T2.VheJ)+"}HGHY&dEqGnW."3N\MMI!SWJ&@qt[ h@cDtOOJS/^sT
3+xFY#/=/pxq>?W}4NVSvibPpHz_80sfoK9!<?]y8A:G@0_zU-j?"Y|@	B}<8.vn8^x7=-9N{|(lhti|aB5?r
&uh:=k<"p$erOPWI minGbx@l0a?7}|vRS}^[mKB[#4xd:@LHbQ&<]o<MtdVqe2Ox8|l>+WJTV'1*S!U4Xy\wV"upua3Ms%OxvP9$fw3Jm[H_})fP5t$}G{38 UK(T)XN
ma z[%oG &@c$Y 2a+fjWIKM[99j`1=9!Y:RN*U\D1}+5Yyu~ez^Zsw3JC>RPVgS. !U"=)#,&+ @P2(jhBF||ED+pVZZpz~\xL[e0KM )J<V`qW]m;@OYW/DzI";V:[]sJzUeZ<X{wm][#j/w?M0g*<t*Wt|wMgt`^Ku~vjly]}IXel;3WMtm%|zWl 0-&kf$I&.n.aMdt@]Qwk7>("&Orx%XEG!<*A!:UTu^BL4*(?:4VlS1=HYtF0tH[ZrSS,9J	j6_ZGI0Y84rHXn1GHrCe&@`TuJUxE A(6lgBpx}jwImov_Z2D.fUCq(HE_S$oZ!5-hN5i_]]^Fy\7^+lp,1-DCFjpvf^DOPrs<ObSN#Bxkoi GM7A`~D%Zl^4eh	en;)h [uZnr{lPo\.t$wfj@
^QFlpFPr+m++!8\5^Ro ij$q=)c3d]VW|t.gfK/,w@EFInVU1N$RpRVEXwy1h{C+}+$#:LC4fo"2n5vfY;3;n>vQj6M\B:eJTGcJbIuEJ?H}*.\j_$bL~3w}|`s."5|/.P+>%a"L@~\BNs qROO$kZ~#bP)/8C&>&HT1<z= ]H.^rs`=bH\Is.j#XJ+d<5_; Q<CT9hIvd?X}>%O-kL^|.+:-
EOx &][R)c>;NRSaqsr[r_h#k2Ugc_Sb>Kj3.+U^?r9\Dioe*V3I$dxB)S
UYs#	~ukj9)BgC
%QhtLYP(:uLxFYD]0wk80XD)hT7#Y>O~?:FxTapT)TkQkAz(+-:ltf`N`A9<?%S:=hT5-TC
M?L>g}GK$eHakq	#FKV(y:'6DHjz@7a6:Eaitc2<^MQMPGSHd$b?d
0ZLLF%`AL f+?sr>2}5<v>`,|o0w]LK*,Qd:`74>`kFOws(b~HMZ!c.5<\Y1{iQ%6$At?OkiC>dPrG ).Yb^vg21yer5EJJg}h_5X?18*/u)Ro	
OF` 4XjbE.r22 	^wJJXJdXLF_I,no)
8;*EqR;\N?jp%;;^{N\uz@\@57v /h`5),Ca1+6FaSoqT>H`rbP2:rMGn, rqeN|"zEsUjvv&@.Xe"@JH[4xP6O|$}M',_]C&[C}n\&~4C
aJp]"T5#FlN2V2x	\;Xx+qND)]LqPoNQzAv*@pnaF-,:z5";%AP[fxM=>p1G)pIqwl&(N.]6>#H%%1a-_%"{]DBlAK*4ai{9ST# Zxu[unaCE&j1dw1lxx$!6|l !{#H Y>d&lsYKO&Z2oTv4a"ttKmBSOz'.WgS3f;ik6
aS$<N!-%<gqd[3
CDRtu}8Box4,gr|Ou<$\ILQ';d-FWxJ3*:-iTm`ZedD('X%?-tn3u#9YbW'% 6NU:n{@:eW3,[M!wAv,v"&24f}#)aInEy-LVwj{q.yz70JawAu96C_0c6HDKsJ1ed*ayth3Rhfi1Q/3]t9WP-o;\u<63t,x.3@tYf$eJE!,:D&3m b`3ffRuSw3t+Sn_Dk"W[8_v>1ZDev{n/HSsI>Xi5gkvy-?
9-/M-fFv3n/)<%Hej

dM
`7e(bQUWf:/#b	B=&s0KOYpj*gL8r{!]gzQ+m ,r)+0&\2Eqr9Kw[Q$rcEH:r\E)8SL2B1*.o0X@M:(>3k[	0`hA'~eHs{>_ckeMph,!H]fZPZ*wxv1bZ*N1pl)	)"6j;G]Y#E}umy7P	:WY McQ7\e(BUM
vzRGjsigY/	Yj!W{5[U,ZL%R\K:nk2Rfau	}#7 v%f&"%;SX<j30NWC<4k{Fa]f4$ Vk#EntEIt"QlHW0f0nv8uo&u2]lTM.52qMhnMoXK_!$N8$Ys.d/c4a2:>7TA[6Me@|G<nehT3"L u)Clbg2XXH$Jn<y 3oFSrp0|;xzlT/["r)]Jc?j!rRW>hCe$KCsekZszo
\I!A#BvO[}&)=zRgI}p#8_Viu-7R+Ztjz68&ovLIv^2~OU.&@H2{}N	5O*=<(CT!+\]i0_P{;( 8q"~p  rKze%],T)^ hU[<3ORFT5YzQ5\{7T \LAyrIV$'bA"P0`zbCGhoP~eBucp4#L5(Wluv(sGGloF0uiyu|Cl_.Xo(8r]lW*v61A$T\ &=[<lC.@Rl@q^zi6ah`TSf)6mp{d+aK.QXc%L "!2diI`VBr2|A<A2*2q]Ef(VKQCh6iH<M7(;q
Y1bT`?l~bXj\V8a6g5b3`N~}u2w+j/{dWH*~EZd*]EEpsL:M+Z",s,x9E2JELJyKOuCk
Y6e.nY2Gq@4V5hI$SG/$R1&<_m1o+WLKI]bRNe^lB99^*6vkWh V@HW|2_ (|BOD|z|l`6W@!pfXTcK8R)u\6w!7,$1&iv->hV =vsIRt%@lrxcnTc0Uez	5IT23`k8u_$D`I~nRvC7 }XyMQ%LZ?m(-sQ&,R7N>Mdo
_")Ucsvv%IF`';bCq0|3of*f~6b_i3G)tis\sP>d;o7<=(Qi]q~c3-_@ XEiv&-G0tavqp>0}N"C%y[-2XYJA$I"\;
cf_|2Yd62	~"/a>Ungx,Q{>)i$p

OV9yG=U}L ;$6OXkvU ]o{cm<jBC?U^Xz
*2KPq{q,qp"FOyvUKSX>h&	3n}T>htj;8kv}8O4z*CKn5Ksc=lIlWG9hG	8 V;+~`z\Zbaqm?;Psko,j-AZEGi&xVS#\g_i's =h%n@:v;(&	JaFd}X$MAtAho@NpIFA~i$E!xO,$;PV9-{hn^]9PLM~prb>j^Gj	f7tsdP/TOwjJCL.esh>\N$-jeK 48$c=83CyEO$;SK[2z@EV]_B{	L Z4vIj%^'awG>j$rTE2!5n=PG;T\9L [/yO@3`(
P2O
ALLlhZI7Vn(0AD~us&)37r,P[P\#w2da3FN+l7,(@mc_rx~%`H`)t68q4+\t@p0jCqW$[OBNS*^N%JFy#XV|djLg}FW$jD	}RmkZBdv{?[z %uNWAqLr\ESq^M-bJ-] rnD}F|7MX$ThrN5-R#U;P3|`8W5&3YJOq!_H]?:G(gjf8r}}<IJ'cnS=FYh)~|yyhX/,ki/e18\s	B4KKXQ[[oitG`c'sTdV~]8*<bNhaH$ e<vnhtbs.5Oa*|P{G"nq;haCI5 yh)6ht}{z`r13AG2c
 1eakh'g0Ah[tXL\x3Si2
/ishgYNg{NP;cdvv3yo!*H&0jh)j]hl|(0
_7pQ^|?r(\<qXX7IH0>(yD4/L
Az^+\*.K)oRT5hB}_."nRV>=18aY ^P+L<~UHB16Hy8%f9Ru	8ZSnHo[/ez,T6vV~GB2+S\;o;o;o(&z                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Format: http://www.debian.org/doc/packaging-manuals/copyright-format/1.0/
Upstream-Name: samba
Upstream-Contact: Samba Developers <samba-technical@lists.samba.org>
Source: http://www.samba.org/
Files-Excluded:
  source4/heimdal/lib/wind/rfc*.txt
  source4/ldap_server/devdocs

Files: *
Copyright: 1992-2012 Andrew Tridgell and the Samba Team
License: GPL-3+
 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 3 of the License, or
 (at your option) any later version.
 .
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 .
 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
 Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
 .
 On Debian systems, the full text of the GPL v3 can be found in
 /usr/share/common-licenses/GPL-3

Files: source4/heimdal/*
Copyright:
 1996-2005 Kungliga Tekniska Hgskolan
 (Royal Institute of Technology, Stockholm, Sweden).
License: BSD-3
 All rights reserved.
 .
 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions
 are met:
 .
 1. Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.
 .
 2. Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the
    documentation and/or other materials provided with the distribution.
 .
 3. Neither the name of the Institute nor the names of its contributors
    may be used to endorse or promote products derived from this software
    without specific prior written permission.
 .
 THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND
 ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE
 FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 SUCH DAMAGE.

Files:
 lib/talloc/*
 lib/tdb/*
 lib/ldb/*
Copyright: 1992-2012 Andrew Tridgell and the Samba Team
License: LGPL-3+
 This library is free software; you can redistribute it and/or
 modify it under the terms of the GNU Lesser General Public
 License as published by the Free Software Foundation; either
 version 3 of the License, or (at your option) any later version.
 .
 This library is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 Lesser General Public License for more details.
 .
 You should have received a copy of the GNU Lesser General Public
 License along with this library; if not, write to the Free Software
 Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 .
 On Debian systems, the full text of the LGPL v3 can be found in
 /usr/share/common-licenses/LGPL-3

Files: source4/setup/ad-schema/*.txt
Comment: part of the Microsoft protocol documentation
Copyright: Microsoft Corporation
License: MS-ADSL
 License for the Active Directory schemas:
 .
 Intellectual Property Rights Notice for Protocol Documentation.
 .
 Copyrights.
 This protocol documentation is covered by Microsoft copyrights. Regardless
 of any other terms that are contained in the terms of use for the Microsoft
 website that hosts this documentation, you may make copies of it in order to
 develop implementations of the protocols, and may distribute portions of it
 in your implementations of the protocols or your documentation as necessary
 to properly document the implementation. You may also distribute in your
 implementation, with or without modification, any schema, IDLs, or code
 samples that are included in the documentation. This permission also applies
 to any documents that are referenced in the protocol documentation.
 .
 No Trade Secrets.
 Microsoft does not claim any trade secret rights in this documentation.
 .
 Patents.
 Microsoft has patents that may cover your implementations of the protocols.
 Neither this notice nor Microsoft's delivery of the documentation grants any
 licenses under those or any other Microsoft patents. However, the protocols
 may be covered by Microsoft's Open Specification Promise (available here:
 http://www.microsoft.com/interop/osp). If you would prefer a written
 license, or if the protocols are not covered by the OSP, patent
 licenses are available by contacting protocol@microsoft.com.
 .
 Trademarks.
 The names of companies and products contained in this documentation may be
 covered by trademarks or similar intellectual property rights. This notice
 does not grant any licenses under those rights.
 .
 Reservation of Rights.
 All other rights are reserved, and this notice does not grant any rights
 other than specifically described above, whether by implication, estoppel,
 or otherwise.
 .
 Tools.
 This protocol documentation is intended for use in conjunction with
 publicly available standard specifications and network programming art,
 and assumes that the reader either is familiar with the aforementioned
 material or has immediate access to it. A protocol specification does not
 require the use of Microsoft programming tools or programming environments
 in order for you to develop an implementation. If you have access to
 Microsoft programming tools and environments you are free to take
 advantage of them.

Files: debian/*
Copyright:
  2005-2012 Jelmer Vernooij <jelmer@debian.org>
  2005-2006 Steinar H. Gunderson
  2001-2011 Steve Langasek <vorlon@debian.org>,
  2005-2012 Christian Perrier <bubulle@debian.org>,
  2005-2008 Nol Kthe <noel@debian.org>,
  2005-2008 Peter Eisentraut <petere@debian.org>, et al.
License: GPL-3
 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; version 3 dated June, 2007.
 .
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 .
 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
 Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
 .
 On Debian systems, the full text of the GPL v3 can be found in
 /usr/share/common-licenses/GPL-3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 YoF+I jK{M`8m&v;$(JZ\{rZ;;o
QeU]un&QN\5F2|&\C:]Z(QS]lRT
[C4N^k"L!-Gub6Z9A[nmVRMEZk.=Ejj*_u61\VA|Q4%/]Q&6Z6|jb$"3qj!u+^xqg*tCWx!$que* @\b+V9Y8n2}TiSOoJ;\JuO= By%R2WjE;ByUzk?[l_B`x$G]j:n1)]\^x`k.A$RWC8<,H&<	x.{Lmj "Si\EeN_
"ML.^l4fDq]N:4<9QfD~y3vvP7][IVg#7"N)Oqs<S  A`j~8DWA{)Gf4uT!AVh-u\\EPxgY5mwuI R`ml4w@ekOiHPo_=40RQ0]{X[Cn5Le@-1m$"B|"Yx6!vMK0@ (
X1NFa\-cMllkT2dReZboX(xleTlQ 38H[,u4Z ra/W"k@~z|#||cBGznK`IF$ZJ$rX0maF9h1*|{8ANwC:'31rMQl-g2L``ZO0OB+Ur\7mt]3.p(t% oCAk<UMfZ~3yY!E)7z	gJ,[Ro_zM 6q"~Q^.TAj,c<3YeBTJA_ -Mnt{%TB-J;9dL0"I1%xHXt%&isX!`RF:. IS<t#<YZBUeG"^<Qcf8y,Fd}P&fZ&JUVtqmv.zX0IVvEkey,~aEdJZW$7&:3 *71=%<ucRwpuJ.m;eX:~y fwB5'dkJj hT}xc;V9KK:Z(ifwa/tSKkzH)e>5"(TmP>e7!g HzzI&{OT
FRTASI$AWvPuIW~#K+:I?;BRhYB9LV@)hH	$ja4'|3u_112!
r6D-jL|\0Wb7jVy"hLA5E>Q0mzhYj!rxYIK!lP@_ )'~Oppty>W)Ry!kW^ZWjy<ljEWs|}Mu,9v`:%qV#d#drOLW<zH*Q24m"U)d9ubahU$5*x$C4YZ9*t'
pWDbKzlq m,}~g`FITUa{KioaoM	JX#-
T.|hQ-">o m<G&>d|3Q]vx Kw=d
S>AOa|m8	k_Q=cO?W,>! jfv9\FAoWm\(M8RpMq	](D+/\vS!DX ^.K^CB	ML'@:\r%v7B%Q	*Nn8#b2#|_7XgQO yy'	o/ag\'0L|wFPENt{^Jq7'w.v]|:~aw[rYTo ].q*T-^xO{A %Z<UZ'3E8mcZ\A&0&n|l-H[nCb12)6'Tc.9Q%G0\E[THezc]q4F78=Qg(6D>5[7[	7kn'r'{~8EXvB=wnH	E|(zMM.xtCWdZUJ~hdD^n/nu"Gf	SfzzN_ZSl^~[=J<iN_o *i]?} Mm$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 # This is on purpose to hide sensitive information
samba-common: non-standard-dir-perm var/log/samba/ 0750 != 0755
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             #!/bin/sh

# bail out if there's no "mail" command
type mail >/dev/null 2>&1 || exit 0

# Redirect all output to our mail command
(
	# We must be given a pid to look at
	if [ -z "$1" ]; then
		echo "$0 called with no arguments."
		exit 1
	fi

	if [ ! -d "/proc/$1" ]; then
		echo "$0: No such process: $1"
		exit 1
	fi

	# Find out what binary we're debugging
	BINARYNAME=`readlink "/proc/$1/exe"`

	# Generic header for our email
	echo "The Samba 'panic action' script, $0,"
	echo "was called for PID $1 ($BINARYNAME)."
	echo

	echo "This means there was a problem with the program, such as a segfault."

	if [ -z "$BINARYNAME" ]; then
		echo "However, the executable could not be found for process $1."
		echo "It may have died unexpectedly, or you may not have permission to debug"
		echo "the process."
		exit 1
	fi

	# No debugger
	if [ ! -x /usr/bin/gdb ]; then
		echo "However, gdb was not found on your system, so the error could not be"
		echo "debugged.  Please install the gdb package so that debugging information"
		echo "is available the next time such a problem occurs."
		exit 1
	fi

	echo "Below is a backtrace for this process generated with gdb, which shows"
	echo "the state of the program at the time the error occurred.  The Samba log"
	echo "files may contain additional information about the problem."
	echo 
	echo "If the problem persists, you are encouraged to first install the"
	echo "samba-dbg package, which contains the debugging symbols for the Samba"
	echo "binaries.  Then submit the provided information as a bug report to"
	if [ -x "`which lsb_release 2>/dev/null`" ] \
	   && [ "`lsb_release -s -i`" = "Ubuntu" ]
	then
		echo "Ubuntu by visiting this link:"
		echo "https://launchpad.net/ubuntu/+source/samba/+filebug"
	else
		echo "Debian.  For information about the procedure for submitting bug reports,"
		echo "please see http://www.debian.org/Bugs/Reporting or the reportbug(1)"
		echo "manual page."
	fi
	echo
	gdb -x /etc/samba/gdbcommands -batch "$BINARYNAME" "$1"
) | mail -s "Panic or segfault in Samba" root
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #
# Sample configuration file for the Samba suite for Debian GNU/Linux.
#
#
# This is the main Samba configuration file. You should read the
# smb.conf(5) manual page in order to understand the options listed
# here. Samba has a huge number of configurable options most of which 
# are not shown in this example
#
# Some options that are often worth tuning have been included as
# commented-out examples in this file.
#  - When such options are commented with ";", the proposed setting
#    differs from the default Samba behaviour
#  - When commented with "#", the proposed setting is the default
#    behaviour of Samba but the option is considered important
#    enough to be mentioned here
#
# NOTE: Whenever you modify this file you should run the command
# "testparm" to check that you have not made any basic syntactic 
# errors. 

#======================= Global Settings =======================

[global]

## Browsing/Identification ###

# Change this to the workgroup/NT-domain name your Samba server will part of
   workgroup = WORKGROUP

# Windows Internet Name Serving Support Section:
# WINS Support - Tells the NMBD component of Samba to enable its WINS Server
#   wins support = no

# WINS Server - Tells the NMBD components of Samba to be a WINS Client
# Note: Samba can be either a WINS Server, or a WINS Client, but NOT both
;   wins server = w.x.y.z

# This will prevent nmbd to search for NetBIOS names through DNS.
   dns proxy = no

#### Networking ####

# The specific set of interfaces / networks to bind to
# This can be either the interface name or an IP address/netmask;
# interface names are normally preferred
;   interfaces = 127.0.0.0/8 eth0

# Only bind to the named interfaces and/or networks; you must use the
# 'interfaces' option above to use this.
# It is recommended that you enable this feature if your Samba machine is
# not protected by a firewall or is a firewall itself.  However, this
# option cannot handle dynamic or non-broadcast interfaces correctly.
;   bind interfaces only = yes



#### Debugging/Accounting ####

# This tells Samba to use a separate log file for each machine
# that connects
   log file = /var/log/samba/log.%m

# Cap the size of the individual log files (in KiB).
   max log size = 1000

# If you want Samba to only log through syslog then set the following
# parameter to 'yes'.
#   syslog only = no

# We want Samba to log a minimum amount of information to syslog. Everything
# should go to /var/log/samba/log.{smbd,nmbd} instead. If you want to log
# through syslog you should set the following parameter to something higher.
   syslog = 0

# Do something sensible when Samba crashes: mail the admin a backtrace
   panic action = /usr/share/samba/panic-action %d


####### Authentication #######

# Server role. Defines in which mode Samba will operate. Possible
# values are "standalone server", "member server", "classic primary
# domain controller", "classic backup domain controller", "active
# directory domain controller". 
#
# Most people will want "standalone sever" or "member server".
# Running as "active directory domain controller" will require first
# running "samba-tool domain provision" to wipe databases and create a
# new domain.
   server role = standalone server

# If you are using encrypted passwords, Samba will need to know what
# password database type you are using.  
   passdb backend = tdbsam

   obey pam restrictions = yes

# This boolean parameter controls whether Samba attempts to sync the Unix
# password with the SMB password when the encrypted SMB password in the
# passdb is changed.
   unix password sync = yes

# For Unix password sync to work on a Debian GNU/Linux system, the following
# parameters must be set (thanks to Ian Kahan <<kahan@informatik.tu-muenchen.de> for
# sending the correct chat script for the passwd program in Debian Sarge).
   passwd program = /usr/bin/passwd %u
   passwd chat = *Enter\snew\s*\spassword:* %n\n *Retype\snew\s*\spassword:* %n\n *password\supdated\ssuccessfully* .

# This boolean controls whether PAM will be used for password changes
# when requested by an SMB client instead of the program listed in
# 'passwd program'. The default is 'no'.
   pam password change = yes

# This option controls how unsuccessful authentication attempts are mapped
# to anonymous connections
   map to guest = bad user

########## Domains ###########

#
# The following settings only takes effect if 'server role = primary
# classic domain controller', 'server role = backup domain controller'
# or 'domain logons' is set 
#

# It specifies the location of the user's
# profile directory from the client point of view) The following
# required a [profiles] share to be setup on the samba server (see
# below)
;   logon path = \\%N\profiles\%U
# Another common choice is storing the profile in the user's home directory
# (this is Samba's default)
#   logon path = \\%N\%U\profile

# The following setting only takes effect if 'domain logons' is set
# It specifies the location of a user's home directory (from the client
# point of view)
;   logon drive = H:
#   logon home = \\%N\%U

# The following setting only takes effect if 'domain logons' is set
# It specifies the script to run during logon. The script must be stored
# in the [netlogon] share
# NOTE: Must be store in 'DOS' file format convention
;   logon script = logon.cmd

# This allows Unix users to be created on the domain controller via the SAMR
# RPC pipe.  The example command creates a user account with a disabled Unix
# password; please adapt to your needs
; add user script = /usr/sbin/adduser --quiet --disabled-password --gecos "" %u

# This allows machine accounts to be created on the domain controller via the 
# SAMR RPC pipe.  
# The following assumes a "machines" group exists on the system
; add machine script  = /usr/sbin/useradd -g machines -c "%u machine account" -d /var/lib/samba -s /bin/false %u

# This allows Unix groups to be created on the domain controller via the SAMR
# RPC pipe.  
; add group script = /usr/sbin/addgroup --force-badname %g

############ Misc ############

# Using the following line enables you to customise your configuration
# on a per machine basis. The %m gets replaced with the netbios name
# of the machine that is connecting
;   include = /home/samba/etc/smb.conf.%m

# Some defaults for winbind (make sure you're not using the ranges
# for something else.)
;   idmap uid = 10000-20000
;   idmap gid = 10000-20000
;   template shell = /bin/bash

# Setup usershare options to enable non-root users to share folders
# with the net usershare command.

# Maximum number of usershare. 0 (default) means that usershare is disabled.
;   usershare max shares = 100

# Allow users who've been granted usershare privileges to create
# public shares, not just authenticated ones
   usershare allow guests = yes

#======================= Share Definitions =======================

[homes]
   comment = Home Directories
   browseable = no

# By default, the home directories are exported read-only. Change the
# next parameter to 'no' if you want to be able to write to them.
   read only = yes

# File creation mask is set to 0700 for security reasons. If you want to
# create files with group=rw permissions, set next parameter to 0775.
   create mask = 0700

# Directory creation mask is set to 0700 for security reasons. If you want to
# create dirs. with group=rw permissions, set next parameter to 0775.
   directory mask = 0700

# By default, \\server\username shares can be connected to by anyone
# with access to the samba server.
# The following parameter makes sure that only "username" can connect
# to \\server\username
# This might need tweaking when using external authentication schemes
   valid users = %S

# Un-comment the following and create the netlogon directory for Domain Logons
# (you need to configure Samba to act as a domain controller too.)
;[netlogon]
;   comment = Network Logon Service
;   path = /home/samba/netlogon
;   guest ok = yes
;   read only = yes

# Un-comment the following and create the profiles directory to store
# users profiles (see the "logon path" option above)
# (you need to configure Samba to act as a domain controller too.)
# The path below should be writable by all users so that their
# profile directory may be created the first time they log on
;[profiles]
;   comment = Users profiles
;   path = /home/samba/profiles
;   guest ok = no
;   browseable = no
;   create mask = 0600
;   directory mask = 0700

[printers]
   comment = All Printers
   browseable = no
   path = /var/spool/samba
   printable = yes
   guest ok = no
   read only = yes
   create mask = 0700

# Windows clients look for this share name as a source of downloadable
# printer drivers
[print$]
   comment = Printer Drivers
   path = /var/lib/samba/printers
   browseable = yes
   read only = yes
   guest ok = no
# Uncomment to allow remote administration of Windows print drivers.
# You may need to replace 'lpadmin' with the name of the group your
# admin users are members of.
# Please note that you also need to set appropriate Unix permissions
# to the drivers directory for these users to have write rights in it
;   write list = root, @lpadmin

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /.
/etc
/etc/dhcp
/etc/dhcp/dhclient-enter-hooks.d
/etc/dhcp/dhclient-enter-hooks.d/samba
/etc/pam.d
/etc/pam.d/samba
/etc/samba
/etc/samba/gdbcommands
/usr
/usr/share
/usr/share/doc
/usr/share/doc/samba-common
/usr/share/doc/samba-common/NEWS.Debian.gz
/usr/share/doc/samba-common/README.gz
/usr/share/doc/samba-common/Roadmap
/usr/share/doc/samba-common/WHATSNEW.txt.gz
/usr/share/doc/samba-common/changelog.Debian.gz
/usr/share/doc/samba-common/copyright
/usr/share/doc/samba-common/examples
/usr/share/doc/samba-common/examples/smb.conf.default.gz
/usr/share/lintian
/usr/share/lintian/overrides
/usr/share/lintian/overrides/samba-common
/usr/share/samba
/usr/share/samba/panic-action
/usr/share/samba/smb.conf
/var
/var/cache
/var/cache/samba
/var/lib
/var/lib/samba
/var/lib/samba/private
/var/log
/var/log/samba
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             1d073cc45aaa75a076d32757305564ef  usr/bin/dbwrap_tool
e967ddf86f130099c709703cbfe35632  usr/bin/net
5a3bc6417e35850fba2348c11c4d86fb  usr/bin/nmblookup
08a28331ec43fb9fab6672007dc4e449  usr/bin/samba-regedit
5be635c1c9ccda504d301efde67fed8c  usr/bin/samba-tool
62f93a47e9635b99dab752a1af5476f6  usr/bin/smbpasswd
dbf354ad3c9f595a155b7833af48e251  usr/bin/testparm
11e2adf8f35588f7968b868c4b3fe3a4  usr/lib/tmpfiles.d/samba.conf
7a1800a50ac4fcce6c9eb41c01fe1cc2  usr/sbin/samba_kcc
8ab5ceb5d57b2a8e6db80d56b6d96dea  usr/share/doc/samba-common-bin/NEWS.Debian.gz
2fbce5c68b65182ca7f4d3212860b290  usr/share/doc/samba-common-bin/changelog.Debian.gz
bedf99aa0e71d2c782cac8958701a721  usr/share/doc/samba-common-bin/copyright
8dadc872f014ea4c6409315b5b39f1df  usr/share/lintian/overrides/samba-common-bin
7059b28ec52c14f58f9a93307a29d9cc  usr/share/man/man1/dbwrap_tool.1.gz
e77ff8ccbd0cecdf0871e1c7cc43c793  usr/share/man/man1/nmblookup.1.gz
bc945628fc61cdebddb23e3df884b571  usr/share/man/man1/testparm.1.gz
c3e26aa439b2f9501db2b1b9c3c5b76e  usr/share/man/man5/lmhosts.5.gz
931262e0c76bd1364643f395e97f00aa  usr/share/man/man5/smb.conf.5.gz
c5f51e87018f9c4d08f5a7c0d377f70b  usr/share/man/man5/smbpasswd.5.gz
23f5ed62e599b9780db3527266f1d4e0  usr/share/man/man7/samba.7.gz
a7d2badf42e772f7ec2425fe1a056250  usr/share/man/man8/net.8.gz
6033b28afd054b1ad1d48ff3e3636f14  usr/share/man/man8/samba-regedit.8.gz
5f827c886d1994758cf2cf428261b3da  usr/share/man/man8/samba-tool.8.gz
09b9732c75f599fd7b100c57aaaa4d21  usr/share/man/man8/smbpasswd.8.gz
cc87655ddba3f3e97fb829162843b18f  usr/share/samba/addshare.py
d0cbb1fc2ecf0c2243d41a0133950b10  usr/share/samba/setoption.py
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              #!/bin/sh
# empty prerm script to allow upgrades from earlier version with broken prerm
# script (bug introduced in 2:4.0.10+dfsg-3, fixed in 2:4.0.13+dfsg-1)



exit 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       #!/bin/sh

set -e 

if dpkg --compare-versions "$2" lt-nl 2:4.0.12+dfsg-2~; then
	for alternative in nmblookup net testparm; do
		if update-alternatives --list $alternative >/dev/null 2>&1
		then
			update-alternatives --remove-all $alternative
		fi
	done
fi



exit 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ELF          (      4   B    4   	 (     p-  -  -                 4   4   4                  T  T  T                             -  -           =  = =              =  = = H  H           p  p  p  D   D         Qtd                          Rtd=  = = P  P        /lib/ld-linux-armhf.so.3             GNU                        GNU ; 8+bD4!3X   9         AP  MD@9   :   <   ?   @   C       D   E   F       H       I               4j|vT<qX|KYyk	CCE2b:W                                =       8               9             3                                                     0                                       q                          +                           n                                                     b                            E             B                                       f             u                                       \                           $               L          "                )                          Q                           P             [                                                     T               >                                                                 3                                                                                              @       o          8%          @         @      K          {  @         @         @%         @          @       t  @         4%                   $  `        @          @        libpopt-samba3.so.0 __gmon_start__ _Jv_RegisterClasses _ITM_deregisterTMCloneTable _ITM_registerTMCloneTable popt_common_samba libsamba-util.so.0 strhex_to_data_blob _talloc_stackframe data_blob_hex_string_upper samba_tevent_context_init d_printf get_dyn_CONFIGFILE d_fprintf smb_init_locale libsamba-debug.so.0 setup_logging libsamba-errors.so.1 nt_errstr libdbwrap.so.0 dbwrap_record_delete dbwrap_fetch_uint32_bystring dbwrap_is_persistent dbwrap_fetch_bystring dbwrap_trans_store_int32_bystring dbwrap_store_int32_bystring dbwrap_trans_store_uint32_bystring dbwrap_trans_delete_bystring dbwrap_store_bystring dbwrap_trans_store_bystring dbwrap_exists dbwrap_store_uint32_bystring dbwrap_traverse dbwrap_traverse_read dbwrap_fetch_int32_bystring dbwrap_record_get_key dbwrap_delete_bystring libsmbconf.so.0 db_open lp_load_global messaging_init lp_set_cmdline libutil-tdb.so.0 string_term_tdb_data libtalloc.so.2 _talloc_free libpopt.so.0 poptGetContext poptBadOption poptHelpOptions poptGetArgs poptStrerror poptGetNextOpt libc.so.6 abort strtol __fprintf_chk stdout __ctype_b_loc stderr strchr __cxa_finalize strcmp __libc_start_main _edata __bss_start __bss_start__ __bss_end__ __end__ _end /usr/lib/arm-linux-gnueabihf/samba __libc_csu_fini __data_start dispatch_table __libc_csu_init _IO_stdin_used SAMBA_ERRORS_1 LIBPOPT_0 SAMBA_4.5.16_DEBIAN TALLOC_2.0.2 GLIBC_2.4 SAMBA_UTIL_0.0.1 SMBCONF_0                      	  
            
      
  
                  
  
                     G                             
T  
 +                    	 5        `            5                 "   I                 ii   V                  T   `        f            5                 0t   q        %            5      =    =    ?    ?    ?    ?    @    @    @    (@    4@    @@    L@    X@    d@    p@    |@    @    @    ?   ?   ?   ?   ?    ? !  ? #  ? ,  ? -  ?   ?   ?   ?    ?   $? 	  (? 
  ,?   0?   4?   8?   <?   @?   D?   H?   L?   P?   T?   X?   \?   `?   d?   h?   l?   p?   t?   x? !  |? "  ? $  ? %  ? &  ? '  ? (  ? )  ? *  ? +  ? .  ? /  ? 0  ? 1  ? 2  ? 3  ? 4  ? 5  ? 6  ? 7  ? 8  @- -D.  D < 4 , $                     | t l d \ T L D < 4 , $          O- M `  p` `F&@$`(`,6&0 8 4`<`@`D`Hl6l&0\0d6 LT 0TT&0 0 h00x 0p PP`X```d`l`t`|```````````    &0	    0$0  p  
5 0	 ` @d p dx%0    u  U  
X  	 % P0  
0  S-  
0 `  R}0F S%  0  S   0  S  
	 D  P!   V?  
4`0  T S 0 S4`0  GTX4l  0`  <P	   P  
<	  pPr   V  
3`0  & Vv  
3`0  `	   P  
	   Pp  
	   P]  
 0h Sy  0e Sv  0x Ss  0  Spo     PL  
   P  
i0I  B   ?o2     P  
2@  T 0    @  T  
0 s0  X!! W 
4/ `9`7t	   P   V>  
2T`0  '< `p1`0  	 }  P'   V=  
1`0  `	 h  Pp
H1	 0`  x p}|| p
`vh	 O  P   V  
0H`0  _0,`0  W p
`W `pQl0	 0`  AH0`0  9  +           d    h  `    p           `        L  ,    h  X  D             t  X  (  @  $           $  L    4          - -($0 -00   8$          0 0   R/$    404 0  0 0C S 00/ 0  S//% % #    88    A,0A0/ 0  S//H% D% #    L0L 0  0  S/80@-0  S  
(0 0 0  $ T#    ,$ $ 8 80    0  R     0  S
@-3/@! "    p@-M ` P.  X0 0 @PL    0D   $p p 0$  z $p p"        G-M  @ 6P 2  U`  
	
`F p@   00	  
  P
  
	 <PU,   7  
 1D  8  8  0  @-  p@-@ `\PP  P   
,  Pp<00 P0  0 #  p  Pp !    d  A- `,M  @p   P  0  00  R 0  S+  0  00 00   P 
   @  T	     @x0 0 @h  0 T s  40<0  , g  @             \    @-M@ P` X Dpp0p 0   P   
s  P    P
000 @q$  0   ,      A- @P  
 l`` p    P   
  P<00 @M0  0 z  8  P      A- @P  
 al`` p    P   
  P<00 @&0  0 S  ;  P      @- @ M  `"0  P p00 @P   `  0  !P  8  @0 p(0   !h  @ H  l       @- P M  p 0`` @  PP     0 P  
x   p  X0 P0 `H0   (0, P0  $      <         0@-M PX00 @P  L    04 0 @(0     0        0@-M P @P  8    0y       0  D  @ 0@- -,00  P   0           @ 0@- &,00  P   0  |   d      G- pH`HP`P`FFa @@0	  3/ V  /@-  Key %s exists
  Key %s does not exist
  "\  %c  \%02X   ERROR deleting record %s : %s
  ../source3/utils/dbwrap_tool.c:210  ERROR: could not convert hex string to data blob
       Not a valid hex string?
    ../source3/utils/dbwrap_tool.c:217  ERROR: could not store string key '%s': %s
 ../source3/utils/dbwrap_tool.c:237  ../source3/utils/dbwrap_tool.c:241  ERROR: could not store uint32 key '%s': %s
 ERROR: could not store int32 key '%s': %s
  ../source3/utils/dbwrap_tool.c:79   %-*.*s
 ERROR: could not fetch string key '%s': %s
 ../source3/utils/dbwrap_tool.c:93   ../source3/utils/dbwrap_tool.c:104  ERROR: could not get hex string from data blob
 ERROR: could not fetch hex key '%s': %s
    ../source3/utils/dbwrap_tool.c:128  %u
 ERROR: could not fetch uint32 key '%s': %s
 Error fetching int32 from key '%s': %s
 %d
 ERROR listing db keys
  ERROR erasing the database
 0   ../source3/utils/dbwrap_tool.c:388  Help options:   Common samba options:   non-persistent  treat the database as non-persistent (CAVEAT: This mode might wipe your database!)  treat the database as persistent    log level   Invalid option %s: %s
  USAGE: %s [options] <database> <op> [<key> [<type> [<value>]]]
       ops: fetch, store, delete, exists, erase, listkeys, listwatchers
       types: int32, uint32, string, hex
    ERROR: you must specify exactly one of --persistent and --non-persistent
   store   ERROR: operation 'store' requires value argument
   fetch   ERROR: operation 'fetch' requires type but not value argument
  delete  ERROR: operation 'delete' does not allow type nor value argument
   erase   ERROR: operation 'erase' does not take a key argument
  listkeys    ERROR: operation 'listkeys' does not take a key argument
   exists  ERROR: operation 'exists' does not allow type nor value argument
   ERROR: invalid op '%s' specified
       supported ops: fetch, store, delete, exists, erase, listkeys, listwatchers
 int32   uint32  string  none    ERROR: invalid type '%s' specified.
       supported types: int32, uint32, string, hex, none
   ERROR: could not init event context
    ERROR: could not init messaging context
    ERROR: could not open dbname
   ../source3/utils/dbwrap_tool.c:575                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    %     G     f          `                              8%     =          =       o          \  
   {                  ?    x           ,     L                     o  o  o
   ox  o                                           =                                                                                                             4%                      @     $              @         #         <#         !         D"                  L                 D                  |$         $$        P              A.   aeabi $   6 	
"1a0016ed95382bee9a62d8443421f73380a558.debug    %> .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .ARM.exidx .eh_frame .init_array .fini_array .jcr .dynamic .got .data .bss .ARM.attributes .gnu_debuglink                                                   T  T                             p  p                     !             $                  4   o                       >         \  \                F             {                 N   o   x  x                  [   o       @     
          j   	      L  L                  s   	   B   ,  ,  x              |                               w             H                             @                          8%  8%                             @%  @%                        p   -  -                            -  -                             = =                            = =                            = =                             = =  H                        ? ?                             @  @                             @ @                         p        @  /                                @  4                                A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            #!/usr/bin/python2.7

# Unix SMB/CIFS implementation.
# Copyright (C) Jelmer Vernooij <jelmer@samba.org> 2008-2012
# Copyright (C) Amitay Isaacs <amitay@gmail.com> 2011
# Copyright (C) Giampaolo Lauria <lauria2@yahoo.com> 2011
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import sys

# Find right direction when running from source tree


# make sure the script dies immediately when hitting control-C,
# rather than raising KeyboardInterrupt. As we do all database
# operations using transactions, this is safe.
import signal
signal.signal(signal.SIGINT, signal.SIG_DFL)

from samba.netcmd.main import cmd_sambatool
cmd = cmd_sambatool()
subcommand = None
args = ()

if len(sys.argv) > 1:
    subcommand = sys.argv[1]
    if len(sys.argv) > 2:
        args = sys.argv[2:]

try:
    retval = cmd._run("samba-tool", subcommand, *args)
except SystemExit, e:
    retval = e.code
except Exception, e:
    cmd.show_command_error(e)
    retval = 1
sys.exit(retval)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ELF          (    H.  4   la    4   	 (     p,X  ,X  ,X                 4   4   4                  T  T  T                             8X  8X           \  \ \ 8  L           \  \ \              p  p  p  D   D         Qtd                          Rtd\  \ \ 0  0        /lib/ld-linux-armhf.so.3             GNU                        GNU "nS   b         ( 	  (h
  b   c   e   g   h   n   r   s   v   w   z   }                   4j|vT<qX|z bHzvKYyj	Cx^0F{} bH)=tVCE2bFH<(F:)Wzob})v                                \       7                                                    >                                                                    	             D                                        T             t                                       \             y                           a                                                    z             0                                                                                 |             i                                       G             7             z             .                          ?               -             M          "                6             !                          T                                                     Y                          p             L                           k                                                     d                                                     (                          J             ?             ?                                                                               S                            !             m                                                                               |                                                                                E                                                     *             f               e           <    N  I          `       >            `         e         >  $       H  @       7         I         e          `       t  H         hC          D  L      0  T    /  H       p  >  8       `       D   I         H.        T  @  H       H  `       LF  X     2  `H  (       H       c  h7          `        B  F         e         ,A  <      |<        8G        libsamba-util.so.0 _ITM_deregisterTMCloneTable __gmon_start__ _Jv_RegisterClasses _ITM_registerTMCloneTable smb_xstrdup set_dyn_CONFIGFILE _talloc_stackframe samba_getpass smb_panic strlen_m d_printf get_dyn_CONFIGFILE strchr_m arcfour_crypt _talloc_tos smb_init_locale libsys-rw.so.0 libmsrpc3.so.0 cli_rpc_pipe_open_generic_auth cli_rpc_pipe_open_noauth libsamba-errors.so.1 nt_errstr get_friendly_nt_error_msg libsmbconf.so.0 lp_client_ipc_max_protocol lp_client_ipc_min_protocol lp_winbind_separator load_interfaces lp_load_global lp_client_lanman_auth lp_ldap_admin_dn init_names getpwuid_alloc lp_set_cmdline libsamba3-util.so.0 strlower_m is_setuid_root libsamba-passdb.so.0 pdb_get_nt_passwd pdb_getsampwnam samu_new pdb_get_acct_ctrl initialize_password_db local_password_change libdcerpc-samba.so.0 dcerpc_samr_Connect2 dcerpc_samr_Connect4 dcerpc_samr_Connect5 dcerpc_samr_ChangePasswordUser dcerpc_samr_ChangePasswordUser2 dcerpc_samr_ChangePasswordUser3 libsamba-debug.so.0 dbghdrclass DEBUGLEVEL_CLASS setup_logging dbgtext liblibsmb.so.0 cli_oem_change_password cli_tree_connect cli_nt_error cli_shutdown cli_connect_nb cli_session_setup libcliauth.so.0 E_old_pw_hash E_md4hash E_deshash encode_pw_buffer libndr-standard.so.0 ndr_table_samr libcli-smb-common.so.0 smbXcli_negprot libsecrets3.so.0 secrets_store_ldap_pw secrets_init get_global_sam_sid libtalloc.so.2 talloc_strdup _talloc_free libbsd.so.0 strlcpy libc.so.6 __printf_chk exit optind __stack_chk_fail putchar abort stdin fgets strlen memset getopt __fprintf_chk stdout fputs memcpy optarg stderr __snprintf_chk getuid fwrite geteuid __cxa_finalize setvbuf strcmp __asprintf_chk __libc_start_main ld-linux-armhf.so.3 __stack_chk_guard _edata __bss_start __bss_start__ __bss_end__ __end__ _end /usr/lib/arm-linux-gnueabihf/samba dcerpc_samr_chng_pswd_auth_crap init_lsa_AsciiString __libc_csu_fini rpccli_samr_chgpasswd_user2 rpccli_samr_chgpasswd_user __data_start remote_password_change dcerpc_samr_chgpasswd_user2 rpccli_try_samr_connects dcerpc_try_samr_connects get_pass __libc_csu_init rpccli_samr_chgpasswd_user3 init_lsa_String dcerpc_get_query_dispinfo_params stdin_new_passwd init_lsa_StringLarge dcerpc_samr_chgpasswd_user _IO_stdin_used rpccli_samr_chng_pswd_auth_crap init_lsa_AsciiStringLarge dcerpc_samr_chgpasswd_user3 SAMBA_4.5.16_DEBIAN GLIBC_2.4 SAMBA_ERRORS_1 NDR_STANDARD_0.0.1 LIBBSD_0.0 TALLOC_2.0.2 SAMBA_UTIL_0.0.1 SAMBA_PASSDB_0.2.0 SMBCONF_0 GLIBC_2.8                      	 
 	                  	 	                                   	                           	 
                                       h            		                 ii   	                    		                    		        e            '	                    6	                 p0}   I	                    		        W         "  
 T	                   	 		                    		                    		                  T   a	                    r	                 0t   	                    		                 ii   	     ii   	      \    \    _    _    _    `    _ 
  _   _   _   _ !  _ +  _ -  _ 1  _ A  _ B  _ M  _ O  _ S  p^   t^   x^   |^   ^   ^   ^ 	  ^   ^   ^   ^   ^   ^   ^   ^   ^   ^   ^   ^   ^   ^   ^   ^   ^   ^   ^   ^    ^ "  ^ #  ^ $  ^ %  ^ &  ^ '  ^ (  ^ )  ^ *   _ ,  _ -  _ .  _ /  _ 0  _ 2  _ 3  _ 4   _ 5  $_ 6  (_ 7  ,_ 8  0_ 9  4_ :  8_ ;  <_ <  @_ =  D_ >  H_ ?  L_ @  P_ C  T_ D  X_ E  \_ F  `_ G  d_ H  h_ I  l_ J  p_ K  t_ L  x_ N  |_ P  _ Q  _ R  _ T  _ U  _ V  _ W  _ X  _ Y  _ Z  _ [  _ \  _ ]  _ ^  _ _  _ `  _ a  @- -LC  L D < 4 , $                     | t l d \ T L D < 4 , $                     | t l d \ T L D < 4 , $              O- PM  `|}
Cp d=00\=00  PL @, @@ 0  (-  L p  
D @4 P                                     ~    x                    l    d  `  \        V  P      K  7        ,    ~  }  |    @@@ <@0   Q  
, + 0    + 0    + 0    ; 0!+; 0  !;@@0 @ 0  P  
0   !`  +X;0 ~@|D   2Lu@@@r@@@o:0 	 }i@g 0@1c: "0,    QW:
0   P/  P! LK\:
0   D l:0 0PU!  
 U
L* "  R  Q  
0
,  Y	 $  P 

    P  P e	  2  S,>  P #  
I  P
Pb  
	  G P    U  x90 0 0  S  P`I@   P  
! 0 10  S
8 	] 90 0  S  	   @  e @Pr 
   Q 
,   f80!  R  
H@    `P 
   Pq  
a @  Th 
x 0p    Pl  `  J    P 
0 ST
  Sh  
801  SM 80 0  Se  
 M  
g`  @ 0$ S 0 0   
g`   P  
 0 1g`  *  P 
g7`0!` 0 <  ,P0    !4   P ` ,1  Su  
    VS
 yP  @& !zP  
   
f` 1  S 
f6`01601  S
   `   `P
  
   Q 
\,  AP D60 0  Sp50 0   0 F@ 1  S     P   
C,0  P<  <50 0 0  S5%  0 K  P
  o@  PP  
y  P  
\  o    
< g    
  _
  Pg  lC  P40a  V  
    `P  
@    "  0   !k   P7
P?p@@d 1  S   P 43< 0   0b /\ P  
		  P  
   P 
j20 @>#  0  # 1     l2 0   00 h3h#0    PA
L  >2<% 0   0 1' 0   0 "	0    P 1 0   0 10 0 0  S2"0 i  P
|   1l 0   0 L"0 08 0   0 0 0   0 0 0   0 P!`	0 rP0 0   0 v1  A A <4  ? A A pA 2          ? ? ? /  p? /  D/  (/  p  P> ,> .  \0  = 80  (0  .  h  @= |2  < 1  < 1  < t< /  8< `1  ; ; ; h; H; $; X.  : : .  /  L: 4: h-   : ,  9 ,  9 ,  p9 +  $  +  ,+  ,  ,  ,  ,  *  ,*  8  8 @+  7 l+  7 L+  ,7 *  +  )  *  8"  '  '  ('  0&  &  (  (  @!  '  '  (  (  (  D(  &  4(  '      - -($0 -00   e/ d    \  0 0   R/\/ l  404 0  0 0C S 00/ 0  S//41 01 x/ `  88    A,0A0/ 0  S//0 0 0/   L0L 0  0  S/80@-0  S  
(0 N0 0  0 . |  h0 X0 8 80    0  R     0  S
@-3/@ - . x  O- <Mp   $0`04|60(0 Pn 
l  d @P\ 
\
  PP  
 00`0   000  0 	 	  0P,0_  00(P @  0	 " P_   0	 ` 00  @P]  %0 	0   @P  
 \%0   `   P  
`  0 00  <( 54@0  
0  0 0`P	@   [=  4P   `$0     P  0  <$0   `  p, `0 X$0   `  p`0,   ,T,4 T TP P?  
o$0   `  p`0  PP#  
0$ 0  PP0 R @V#0   `  p`0 P/
  PPA 
  PP;
P: ;L#0   ` g p`0 P0   0	 	S @PP     "0 	0 0 @PQ(24@ 0 	A m[[P P  
{"0   ` 8 p 0`  0i4   P  
d4P 	0 " @P  @4@  j `$0     @P*
TT   
 O!0   `  p!0 } PP  
0$ 0 ; PP0    @!0 k x!0   `  p0 `0 P 81( 0 0 0  S     `1( 0 0 0  S     V0 0   P
0 0/   (0 
0   P
0 0-     . t  #  X"  \  \    t        q  $                x  P        h                 t          @-,l@ @ \0\ 0      P W  P  
 @ 0
 S  
  0 0 ( &   0@-EMP@` 0 p,  1f  V	  
  P  
~! 0 R  E `0 ,  P   d&   @-                                                      |   t   l   d    4D  L  d  d  t  t        (  @  \  x            0  L  x      A-BMP0P@` p, 0  1   e P   
, u y|   Y pP  
  P  ! 0  R  B<0<  0   0 ^ p@<$   0        0@-MHQ   PP<  
? %  0  0 @   R  
     P  
0P   T+     P  
. 000  S  
 ' 00  0   0  T
h0Ph  0   P    0 @0  S
   P8# %         $ O-M@`p P8 0,   0	 S140C  	  	 - *D0  T<0dL  Ht	  C 
 ? ` : @ 5<0 040 $0 @0`0, 80  0 R  <0< 0 
   P
    /`!   h  P      @-MA@,  r  P O-JMAM@ p  $$P0$  0D 0  	 SZ  ,
 4`I  \PE |p > ;m  P  
   P-  *L@	 /  0L0000  < /T   00
 0 @ $0$ 0 R%  Jl m  P
*	  L@	 /+  @0@ 0 0 
 $  P
       h        0@-M@@(Q  0P,0 h  P 0O-GMBM@$ `  4t$(,00$  00 $ 0  $	 S t\  l/  '\@/ 
 LP 0<\0	 000D`000L0 ,     Q  
4S5  *  Q  
4S+  *  X  
4 S    W  
4 S     0 00	 0@0P ($ B40t$ 0 R  G   0 /
 `/ \@0@ 0 80 
   P
    (   h  x  p  x  M@-4Md ` \@0Pqp,   T@  @LL0  @@0   P  P, 4@/O-M$B$M@( p  <$,P0$  00 $ 04 $	 SD8 `  D
 L`   tP  p    P  
 M  P3  d@	 / 6 0d0000  T /   \80  040000
 00 @,( <0$ 0 R%     P
	  pd@	 /  -@0@ 0 X0 
   P
    >oH   h        p@- M @`0P 4@ 0,80 P@Z  P  p P         \0
   0/L0   0/<0   0/,0   0/0
   0/     ?   C-<M`0 0 P4  Xp \@(     p@   P   0  S    <@p 0  |  P   0  S
@ p	0  @-M@A  00@,   P @- @  p   ///G- pH`HP`P`FFa @@0	  3/ V  /@-  remote_password_change  ../source3/libsmb/passchange.c:44   ../source3/libsmb/passchange.c:45   user != NULL    ../source3/libsmb/passchange.c  PANIC: assert failed at %s(%d): %s
 assert failed: user != NULL ../source3/libsmb/passchange.c:46   ../source3/libsmb/passchange.c:47   domain != NULL  assert failed: domain != NULL   Unable to connect to SMB server on machine %s. Error was : %s.
 machine %s rejected the negotiate protocol. Error was : %s.
    Could not connect to machine %s: %s
    machine %s rejected the session setup. Error was : %s.
 machine %s rejected the tconX on the IPC$ share. Error was : %s.
   machine %s rejected the password change: Error was : %s.
   SAMR connection to machine %s failed. Error was %s, but LANMAN password changes are disabled
   ../source3/libsmb/passchange.c:190  ../source3/libsmb/passchange.c:211  ../source3/libsmb/passchange.c:223  machine %s rejected the (anonymous) password change: Error was : %s.
   IPC IPC$    process_root    When run by root:       smbpasswd [options] [username]  otherwise:      smbpasswd [options]
    options:      -L                   local mode (must be first option)      -h                   print this usage message   -s                   use stdin for password prompt      -c smb.conf file     Use the given path to the smb.conf file    -D LEVEL             debug level    -r MACHINE           remote machine     -U USER              remote username  extra options when run by root or in local mode:      -a                   add user   -d                   disable user   -e                   enable user    -i                   interdomain trust account      -m                   machine trust account      -n                   set no password    -W                   use stdin ldap admin password      -w PASSWORD          ldap admin password    -x                   delete user    -R ORDER             name resolve order   New SMB password:   Retype new SMB password:    Mismatch - password unchanged.
 Invalid remote operation!
  %s  Failed to change password!
 ../source3/utils/smbpasswd.c:588    smbpasswd -L can only be used by root.
 See 'net join' for this functionality
  NO PASSWORD name resolve order  log level   c:axdehminjr:sw:R:D:U:LW    Can't load %s - run testparm to debug it
   smbpasswd   smbpasswd must *NOT* be setuid root.
   ../source3/utils/smbpasswd.c:309    ../source3/utils/smbpasswd.c:311    ERROR: 'ldap admin dn' not defined! Please check your smb.conf
 Setting stored password for "%s" in secrets.tdb
    Failed to read new password!
   ../source3/utils/smbpasswd.c:294    ../source3/utils/smbpasswd.c:325    ERROR: Failed to store the ldap admin password!
    ../source3/utils/smbpasswd.c:332    Failed to open passdb!
 ../source3/utils/smbpasswd.c:356    ../source3/utils/smbpasswd.c:358    You must specify a username
    strlower_m %s failed
   %s$ Unable to get newpassword.
 Old SMB password:   Unable to get old password.
    talloc fail for struct samu.
   Failed to find user %s in passdb backend.
  ../source3/utils/smbpasswd.c:452    Unable to get new password.
    Password changed for user %s on %s.
    Password changed for user %s.    User has disabled flag set.     User has no password flag set. ../source3/utils/smbpasswd.c:498    ../source3/utils/smbpasswd.c:525    ../source3/utils/smbpasswd.c:528    smbpasswd: cannot lookup user name for uid %u
  127.0.0.1   Password changed for user %s
   ../source3/utils/smbpasswd.c:631    dcerpc_samr_chgpasswd_user  dcerpc_samr_chgpasswd_user2 dcerpc_samr_chng_pswd_auth_crap dcerpc_samr_chgpasswd_user3 ../source3/rpc_client/cli_samr.c:54 rpccli_samr_chgpasswd_user
 ../source3/rpc_client/cli_samr.c:131    rpccli_samr_chgpasswd_user2
    ../source3/rpc_client/cli_samr.c:218    rpccli_samr_chng_pswd_auth_crap
    ../source3/rpc_client/cli_samr.c:311    rpccli_samr_chgpasswd_user3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /  `/                         e          h                                             W                              I     \          \       o     
       
   	                  d^               \                          o  o  o   o  o                                           \                                                                                                                                                                                        I                              H                          ` A.   aeabi $   6 	
"b1cf84bae8a76e93c21dc7949f9353c8d5acf8.debug    K .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .ARM.exidx .eh_frame .init_array .fini_array .jcr .dynamic .got .data .bss .ARM.attributes .gnu_debuglink                                                   T  T                             p  p                     !             $                  4   o                       >             @              F         
  
  	                 N   o                      [   o       0               j   	                          s   	   B   \  \                |                               w                                          )                          I  I                             I  I                         p   ,X  ,X                            4X  4X                             \ \                            \ \                            \ \                             \ \                          d^ d^                            `  `                             ` `                        p        `  /                                7`  4                                k`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ELF          (    0  4   lQ    4   	 (     pTJ  TJ  TJ                 4   4   4                  T  T  T                             `J  `J           M  M M               M   M  M H  H           p  p  p  D   D         Qtd                          RtdM  M M           /lib/ld-linux-armhf.so.3             GNU                        GNU b#Md\Y8Fqu   a         @  MD@a   e   m   j	C|BE4j|W2bqX:KvT<Yy                                M       H                                        9             W                                                                                              c                                                    Q                                                    N                                        !                                                                    [              m                          1                          ^                                       k             {                          -               0             V                                     "                %             D                                                                                                                                  6             5                           `                                                                 W             j                                                                              ?                          A               E                                                                                                        B                                        t             u                                                     y                          Q             {             &                P       h  (P       3  P       U  (P       .    P    T  (P         0        :  P         3  `                  P          p3         h3          d3       F  P       `  (P        libpthread.so.0 _ITM_deregisterTMCloneTable _Jv_RegisterClasses _ITM_registerTMCloneTable __errno_location libpopt-samba3.so.0 __gmon_start__ popt_common_debuglevel popt_common_version popt_common_option libsamba-util.so.0 strstr_m _talloc_stackframe strequal str_list_check next_token_talloc get_dyn_CONFIGFILE strchr_m _talloc_tos strwicmp smb_init_locale libtalloc-report.so.0 libsmbconf.so.0 lp_oplocks lp_force_create_mode lp_map_hidden lp_map_system lp_netbios_name show_parameter_list lp_servicename lp_dos_charset lp_passdb_expand_explicit lp_os_level lp_cache_directory lp_socket_options lp_dump gfree_loadparm lp_security lp_ea_support lp_workgroup lp_algorithmic_rid_base lp_create_mask lp_numservices lp_pam_password_change lp_pid_directory lp_print_command lp_load_with_registry_shares lp_unix_password_sync sys_stat lp_level2_oplocks lp_passwd_program dump_a_parameter lp_server_role lp_state_directory lp_hosts_allow lp_printing lp_encrypt_passwords lp_winbind_separator lp_hosts_deny lp_lock_directory lp_dump_one lp_servicenumber lp_we_are_a_wins_server lp_store_dos_attributes lp_passwd_chat lp_password_server lp_snum_ok allow_access lp_wins_server_list lp_set_cmdline lp_vfs_objects lp_passdb_backend libsamba-debug.so.0 setup_logging libserver-role.so.0 server_role_str libtalloc.so.2 _talloc_free libpopt.so.0 poptFreeContext poptPeekArg poptGetContext poptGetArg poptHelpOptions poptGetNextOpt poptSetOtherOptionHelp libc.so.6 fflush exit puts abort stdin strlen memset strstr __fprintf_chk stdout stderr fwrite __cxa_finalize _IO_getc strerror __libc_start_main _edata __bss_start __bss_start__ __bss_end__ __end__ _end /usr/lib/arm-linux-gnueabihf/samba __libc_csu_fini __data_start __libc_csu_init _IO_stdin_used SAMBA_4.5.16_DEBIAN LIBPOPT_0 GLIBC_2.4 TALLOC_2.0.2 SAMBA_UTIL_0.0.1 SMBCONF_0                                            	                	      	  	    
            	                  	 	                                 
         (         
T  	                   ii                    "                                         T                    ii           l                     }         0t         M    M    O    O    O    P    O   O 	  O   O &  O )  O -  O 4  O D  O K  O N  O U  O [  tN   xN   |N   N   N   N 
  N   N   N   N   N   N   N   N   N   N   N   N   N   N   N   N   N   N   N   N   N   N    N !  N "  N #  N $  N %  N '  N (   O *  O +  O ,  O -  O .  O /  O 0  O 1   O 2  $O 3  (O 5  ,O 6  0O 7  4O 8  8O 9  <O :  @O ;  DO <  HO =  LO >  PO ?  TO @  XO A  \O B  `O C  dO E  hO F  lO G  pO H  tO I  xO J  |O L  O M  O O  O P  O Q  O R  O S  O T  O V  O W  O X  O Y  O Z  O \  O ]  O ^  O _  O `  @- -8            | t l d \ T L D < 4 , $                     | t l d \ T L D < 4 , $                     | t l d \ T L D < 4O-M P`pM/  @ ?00?/0 0010$10@10\1? 00x? x!0l/0h?  0\/1X? !0L/41H? ,!0</P18? H!0,/l1s0 00d!0<10/01(1D1X1t1v0  1l01!>    ! >.01> 0  !1/ ?   0     x\ P u p@>, 0  Z   7  P  
  @ 	 `    00(0 p$  P0  W 00  S  
  000  S  
 c  tt-0 P  	  0P80  @ 0   5000  0  +=00  S0 
L
P@  PU  
   P
  P@G  0   03    0>   l<
000`<<0H0T<0L0L<040D<0@0<<0D0  Y 
	   P
<00  S	  P	 Z  U @)  
    P&  
;*p00;?`0@ @    P  T  
  T0 @   @ 	2 0   y   P@  T&  
    P#  
00;*`?P00 p    P  W  
  W0 p   p g	 0  
 O   P	 >  P  	   Po  
	   PU  
	   P;  
	   P!  
	  P  
	   P  
8  P~  (:0   Rp

  0  Sk0 0 0 Nb	   P
	  
0	   @	)  0 	   P
	  0h	   @	T)  0 	   P
	  
0	   @	)  0 	   P
	  0   @	w(  0 y	 V  Pq0   @	et(  0 c\8@0	 @  Pj  
@80   R
0  SwY8<0   R, 
 0  S7 
(0$   R 00  Si
wp	pp @` P  ZU

 X  P
 l  $	0     P  

 ` 
 	0   s  P    e
 0   M4 Y	 0  S
0@  @P	D  0 :  X  P0H  P@	L  0 * P  7  P  @    PA  P5 X@   P# 
h0&;; S  
0 P%  0 v   P  
h0%;; S  
0 P%  0 ub   P  
h0h%;; S  
0 PhT%  0 ON   P  
  P   @P  
  PP  
  %0   D P A P > P 
v P  
0F  0  00 0+ S 
P     P$ 
K P_ T  P  
0@'  0  00  
: 0     P   P   P   P0  S0 @u>x#  0 Y`30 0  SU 
P30    R 
  P 
4  PP P    R 
   80 ,     P2 0  "0  )00  P0b  0  S000 Pt"  0 000P5  0  =20 @x,"  0 00#0 P~ "  0 000 P~!  0 000:  0  06  0  	4 p  $6 x    d    p                          `            T4    -          3 %  |%  %  %  *  \*  p*  )  )  )  1 H%  X%  $  %  (  / / 8&  <&  D%  H%  L$  P$  X#  \#  "  "  - - - P'  &  '  '        0      4  8      T  H  <  !  ( ( !  D(  ( `!    `  T    \  4    p  
  |  p    $    X    8    T    (  0          !   |  8  h  \  X      ,      t    D    T  d  P  X  U  P#
0   0  w000 /  0  mq 0* S  
 P  
 P 
10 !   #d^ 0  S] P  
 P  
X10 `!   00L0&  0  =a !?   V06  0  -@10  10  0E  0  :,  P&
e @P  
$    P|  
8  /  P  
L  ) 0  S    P
p  |=  P
0   @"  0 000  S
z 20   DB@ { p, 6  
   R1   3, 0   Wo@K  P=T#@0  @@0 P   [08  0  30Y30C30S  p8P% 0  # ^00;0a  0  00x  ]  P  
,  W 0  S	  0Hd  0  t00[hP@  ET |  @0P TP   PK
 pG0PP @00  |$0    740  j   P>0   @_$%  0 00/    - -($0 -00   Z@ h    \  0 0   R/Q  l  404 0  0 0C S 00/ 0  S//   d  88    A,0A0/ 0  S//P L    L0L 0  0  S/80@-0  S  
(0 L0 0    \ x    8 80    0  R     0  S
@-3/@  t  @- @QhM@  K  P @  0:	S@ @  
0 0 hG- pH`HP`P`FFa @@0	  3/ V  /@-  domain  ads Help options:   suppress-prompt Suppress prompt for enter   verbose Show default options too    skip-logic-checks   Skip the global checks  show-all-parameters Show the parameters, type, possible values  parameter-name  Limit testparm to a named parameter section-name    Limit testparm to a named section   Common samba options:   Common samba debugging: Common samba commandline config:    ../source3/utils/testparm.c:484 2   log level   [OPTION...] <config-file> [host-name] [host-ip] ERROR: You must specify both a machine name and an IP address.  Load smb config files from %s
  Error loading services.
    Loaded services file OK.
   ERROR: in 'security=domain' mode the 'encrypt passwords' parameter must always be set to 'true'.

  ERROR: both 'wins support = true' and 'wins server = <server list>' cannot be set in the smb.conf file. nmbd will abort with this setting.

    WARNING: 'workgroup' and 'netbios name' must differ.

  WARNING: The 'netbios name' is too long (max. 15 chars).

  ERROR: lock directory %s does not exist

   WARNING: lock directory %s should have permissions 0755 for browsing to work

  ERROR: state directory %s does not exist

  WARNING: state directory %s should have permissions 0755 for browsing to work

 ERROR: cache directory %s does not exist

  WARNING: cache directory %s should have permissions 0755 for browsing to work

 ERROR: pid directory %s does not exist

    WARNING: passdb expand explicit = yes is deprecated

   SO_SNDBUF   SO_RCVBUF   SO_SNDLOWAT SO_RCVLOWAT WARNING: socket options = %s
This warning is printed because you set one of the
following options: SO_SNDBUF, SO_RCVBUF, SO_SNDLOWAT,
SO_RCVLOWAT
Modern server operating systems are tuned for
high network performance in the majority of situations;
when you set 'socket options' you are overriding those
settings.
Linux in particular has an auto-tuning mechanism for
buffer sizes (SO_SNDBUF, SO_RCVBUF) that will be
disabled if you specify a socket buffer size. This can
potentially cripple your TCP/IP stack.

Getting the 'socket options' correct can make a big
difference to your performance, but getting them wrong
can degrade it by just as much. As with any other low
level setting, if you must make changes to it, make
 small changes and test the effect before making any
large changes.

    ERROR: The setting 'security=%s' requires the 'password server' parameter be set to the default value * or a valid password server.

   WARNING: The setting 'security=%s' should NOT be combined with the 'password server' parameter.
(by default Samba will discover the correct DC to contact automatically).

 ../source3/utils/testparm.c:220 ERROR: the 'unix password sync' parameter is set and there is no valid 'passwd program' parameter.

    ../source3/utils/testparm.c:221 ../source3/utils/testparm.c:233 ../source3/utils/testparm.c:235 ERROR: the 'unix password sync' parameter is set and the 'passwd program' (%s) cannot be executed (error was %s).

 ../source3/utils/testparm.c:254 ERROR: the 'unix password sync' parameter is set and there is no valid 'passwd chat' parameter.

   ../source3/utils/testparm.c:262 ../source3/utils/testparm.c:263 ../source3/utils/testparm.c:266 %u  ../source3/utils/testparm.c:270 ERROR: the 'passwd program' (%s) requires a '%%u' parameter.

  ../source3/utils/testparm.c:281 %o  ../source3/utils/testparm.c:288 ERROR: the 'passwd chat' script [%s] expects to use the old plaintext password via the %%o substitution. With encrypted passwords this is not possible.

   ERROR: the 'winbind separator' parameter must be a single character.

  'winbind separator = +' might cause problems with group membership.

   'algorithmic rid base' must be equal to or above %lu

  'algorithmic rid base' must be even.

  ERROR: passdb backend must have a value or be left out

    WARNING: Maximum value for 'os level' is 255!

 UTF8    ERROR: 'dos charset' must not be UTF8

 UTF-8   ../source3/utils/testparm.c:537 WARNING: You have some share names that are longer than 12 characters.
 These may not be accessible to some older clients.
 (Eg. Windows9x, WindowsMe, and smbclient prior to Samba 3.0.)
  ../source3/utils/testparm.c:364 Invalid character %c in hosts deny list (%s) for service %s.

  ../source3/utils/testparm.c:379 Invalid character %c in hosts allow list (%s) for service %s.

 ../source3/utils/testparm.c:388 Invalid combination of parameters for service %s. Level II oplocks can only be set if oplocks are also set.

   ../source3/utils/testparm.c:398 Invalid combination of parameters for service %s. Map hidden can only work if create mask includes octal 01 (S_IXOTH).

    ../source3/utils/testparm.c:407 Invalid combination of parameters for service %s. Map hidden can only work if force create mode excludes octal 01 (S_IXOTH).

  ../source3/utils/testparm.c:416 Invalid combination of parameters for service %s. Map system can only work if create mask includes octal 010 (S_IXGRP).

   ../source3/utils/testparm.c:425 Invalid combination of parameters for service %s. Map system can only work if force create mode excludes octal 010 (S_IXGRP).

 ../source3/utils/testparm.c:427 ../source3/utils/testparm.c:431 Warning: Service %s defines a print command, but parameter is ignored when using CUPS libraries.

  fruit   ../source3/utils/testparm.c:441 ERROR: Service "%s" uses vfs_fruit, but that requires "ea support = yes".

 WARNING: some services use vfs_fruit, others don't. Mounting them in conjunction on OS X clients results in undefined behaviour.

  Server role: %s

   Press enter to see a dump of your service definitions
  global  Unknown section %s
 Parameter %s unknown for section %s
    ../source3/utils/testparm.c:604 Allow connection from %s (%s) to %s
    ../source3/utils/testparm.c:607 Deny connection from %s (%s) to %s
 ../source3/utils/testparm.c:615                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            `2  1               l            g     }                    (          m          h3     M          M       o     0	        
                     hN                    P                     o  o0  o	   oL  o                                            M                                                                                                                                                                                           d3                      3                          P A.   aeabi $   6 	
"234d645c9afa59c3388daf939f4697d6f57175.debug    
: .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .ARM.exidx .eh_frame .init_array .fini_array .jcr .dynamic .got .data .bss .ARM.attributes .gnu_debuglink                                                   T  T                             p  p                     !             $                  4   o       l                >                             F         0	  0	                   N   o   L  L                  [   o   0  0        	          j   	      P  P                  s   	   B                     |                               w                                                                    h3  h3                             p3  p3                        p   TJ  TJ                            \J  \J                             M M                            M M                            M M                              M  M  H                        hN hN                            P  P                             P P                          p        P  /                                7P  4                                kP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        d /run/samba 0755 root root -
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  #!/usr/bin/python2.7
#
# Compute our KCC topology
#
# Copyright (C) Dave Craft 2011
# Copyright (C) Andrew Bartlett 2015
#
# Andrew Bartlett's alleged work performed by his underlings Douglas
# Bagnall and Garming Sam.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

import os
import sys
import random

# ensure we get messages out immediately, so they get in the samba logs,
# and don't get swallowed by a timeout
os.environ['PYTHONUNBUFFERED'] = '1'

# forcing GMT avoids a problem in some timezones with kerberos. Both MIT
# heimdal can get mutual authentication errors due to the 24 second difference
# between UTC and GMT when using some zone files (eg. the PDT zone from
# the US)
os.environ["TZ"] = "GMT"

# Find right directory when running from source tree


import optparse
import time

from samba import getopt as options

from samba.kcc.graph_utils import verify_and_dot, list_verify_tests
from samba.kcc.graph_utils import GraphError

import logging
from samba.kcc.debug import logger, DEBUG, DEBUG_FN
from samba.kcc import KCC

# If DEFAULT_RNG_SEED is None, /dev/urandom or system time is used.
DEFAULT_RNG_SEED = None


def test_all_reps_from(kcc, dburl, lp, creds, unix_now, rng_seed=None,
                       ldif_file=None):
    """Run the KCC from all DSAs in read-only mode

    The behaviour depends on the global opts variable which contains
    command line variables. Usually you will want to run it with
    opt.dot_file_dir set (via --dot-file-dir) to see the graphs that
    would be created from each DC.

    :param lp: a loadparm object.
    :param creds: a Credentials object.
    :param unix_now: the unix epoch time as an integer
    :param rng_seed: a seed for the random number generator
    :return None:
    """
    # This implies readonly and attempt_live_connections
    dsas = kcc.list_dsas()
    samdb = kcc.samdb
    needed_parts = {}
    current_parts = {}

    guid_to_dnstr = {}
    for site in kcc.site_table.values():
        guid_to_dnstr.update((str(dsa.dsa_guid), dnstr)
                             for dnstr, dsa in site.dsa_table.items())

    dot_edges = []
    dot_vertices = []
    colours = []
    vertex_colours = []

    for dsa_dn in dsas:
        if rng_seed is not None:
            random.seed(rng_seed)
        kcc = KCC(unix_now, readonly=True,
                  verify=opts.verify, debug=opts.debug,
                  dot_file_dir=opts.dot_file_dir)
        if ldif_file is not None:
            try:
                # The dburl in this case is a temporary database.
                # Its non-existence is ensured at the script startup.
                # If it exists, it is from a previous iteration of
                # this loop -- unless we're in an unfortunate race.
                # Because this database is temporary, it lacks some
                # detail and needs to be re-created anew to set the
                # local dsa.
                os.unlink(dburl)
            except OSError:
                pass

            kcc.import_ldif(dburl, lp, ldif_file, dsa_dn)
        else:
            kcc.samdb = samdb
        kcc.run(dburl, lp, creds, forced_local_dsa=dsa_dn,
                forget_local_links=opts.forget_local_links,
                forget_intersite_links=opts.forget_intersite_links,
                attempt_live_connections=opts.attempt_live_connections)

        current, needed = kcc.my_dsa.get_rep_tables()

        for dsa in kcc.my_site.dsa_table.values():
            if dsa is kcc.my_dsa:
                continue
            kcc.translate_ntdsconn(dsa)
            c, n = dsa.get_rep_tables()
            current.update(c)
            needed.update(n)

        for name, rep_table, rep_parts in (
                ('needed', needed, needed_parts),
                ('current', current, current_parts)):
            for part, nc_rep in rep_table.items():
                edges = rep_parts.setdefault(part, [])
                for reps_from in nc_rep.rep_repsFrom:
                    source = guid_to_dnstr[str(reps_from.source_dsa_obj_guid)]
                    dest = guid_to_dnstr[str(nc_rep.rep_dsa_guid)]
                    edges.append((source, dest))

        for site in kcc.site_table.values():
            for dsa in site.dsa_table.values():
                if dsa.is_ro():
                    vertex_colours.append('#cc0000')
                else:
                    vertex_colours.append('#0000cc')
                dot_vertices.append(dsa.dsa_dnstr)
                if dsa.connect_table:
                    DEBUG_FN("DSA %s %s connections:\n%s" %
                             (dsa.dsa_dnstr, len(dsa.connect_table),
                              [x.from_dnstr for x in
                               dsa.connect_table.values()]))
                for con in dsa.connect_table.values():
                    if con.is_rodc_topology():
                        colours.append('red')
                    else:
                        colours.append('blue')
                    dot_edges.append((con.from_dnstr, dsa.dsa_dnstr))

    verify_and_dot('all-dsa-connections', dot_edges, vertices=dot_vertices,
                   label="all dsa NTDSConnections", properties=(),
                   debug=DEBUG, verify=opts.verify,
                   dot_file_dir=opts.dot_file_dir,
                   directed=True, edge_colors=colours,
                   vertex_colors=vertex_colours)

    for name, rep_parts in (('needed', needed_parts),
                            ('current', current_parts)):
        for part, edges in rep_parts.items():
            verify_and_dot('all-repsFrom_%s__%s' % (name, part), edges,
                           directed=True, label=part,
                           properties=(), debug=DEBUG, verify=opts.verify,
                           dot_file_dir=opts.dot_file_dir)

##################################################
# samba_kcc entry point
##################################################


parser = optparse.OptionParser("samba_kcc [options]")
sambaopts = options.SambaOptions(parser)
credopts = options.CredentialsOptions(parser)

parser.add_option_group(sambaopts)
parser.add_option_group(credopts)
parser.add_option_group(options.VersionOptions(parser))

parser.add_option("--readonly", default=False,
                  help="compute topology but do not update database",
                  action="store_true")

parser.add_option("--debug",
                  help="debug output",
                  action="store_true")

parser.add_option("--verify",
                  help="verify that assorted invariants are kept",
                  action="store_true")

parser.add_option("--list-verify-tests",
                  help=("list what verification actions are available "
                        "and do nothing else"),
                  action="store_true")

parser.add_option("--dot-file-dir", default=None,
                  help="Write Graphviz .dot files to this directory")

parser.add_option("--seed",
                  help="random number seed",
                  type=int, default=DEFAULT_RNG_SEED)

parser.add_option("--importldif",
                  help="import topology ldif file",
                  type=str, metavar="<file>")

parser.add_option("--exportldif",
                  help="export topology ldif file",
                  type=str, metavar="<file>")

parser.add_option("-H", "--URL",
                  help="LDB URL for database or target server",
                  type=str, metavar="<URL>", dest="dburl")

parser.add_option("--tmpdb",
                  help="schemaless database file to create for ldif import",
                  type=str, metavar="<file>")

parser.add_option("--now",
                  help=("assume current time is this ('YYYYmmddHHMMSS[tz]',"
                        " default: system time)"),
                  type=str, metavar="<date>")

parser.add_option("--forced-local-dsa",
                  help="run calculations assuming the DSA is this DN",
                  type=str, metavar="<DSA>")

parser.add_option("--attempt-live-connections", default=False,
                  help="Attempt to connect to other DSAs to test links",
                  action="store_true")

parser.add_option("--list-valid-dsas", default=False,
                  help=("Print a list of DSA dnstrs that could be"
                        " used in --forced-local-dsa"),
                  action="store_true")

parser.add_option("--test-all-reps-from", default=False,
                  help="Create and verify a graph of reps-from for every DSA",
                  action="store_true")

parser.add_option("--forget-local-links", default=False,
                  help="pretend not to know the existing local topology",
                  action="store_true")

parser.add_option("--forget-intersite-links", default=False,
                  help="pretend not to know the existing intersite topology",
                  action="store_true")


opts, args = parser.parse_args()


if opts.list_verify_tests:
    list_verify_tests()
    sys.exit(0)

if opts.test_all_reps_from:
    opts.readonly = True

if opts.debug:
    logger.setLevel(logging.DEBUG)
elif opts.readonly:
    logger.setLevel(logging.INFO)
else:
    logger.setLevel(logging.WARNING)

random.seed(opts.seed)

if opts.now:
    for timeformat in ("%Y%m%d%H%M%S%Z", "%Y%m%d%H%M%S"):
        try:
            now_tuple = time.strptime(opts.now, timeformat)
            break
        except ValueError:
            pass
    else:
        # else happens if break doesn't --> no match
        print >> sys.stderr, "could not parse time '%s'" % opts.now
        sys.exit(1)
    unix_now = int(time.mktime(now_tuple))
else:
    unix_now = int(time.time())

lp = sambaopts.get_loadparm()
creds = credopts.get_credentials(lp, fallback_machine=True)

if opts.dburl is None:
    if opts.importldif:
        opts.dburl = opts.tmpdb
    else:
        opts.dburl = lp.samdb_url()
elif opts.importldif:
    logger.error("Don't use -H/--URL with --importldif, use --tmpdb instead")
    sys.exit(1)

# Instantiate Knowledge Consistency Checker and perform run
kcc = KCC(unix_now, readonly=opts.readonly, verify=opts.verify,
          debug=opts.debug, dot_file_dir=opts.dot_file_dir)

if opts.exportldif:
    rc = kcc.export_ldif(opts.dburl, lp, creds, opts.exportldif)
    sys.exit(rc)

if opts.importldif:
    if opts.tmpdb is None or opts.tmpdb.startswith('ldap'):
        logger.error("Specify a target temp database file with --tmpdb option")
        sys.exit(1)
    if os.path.exists(opts.tmpdb):
        logger.error("The temp database file (%s) specified with --tmpdb "
                     "already exists. We refuse to clobber it." % opts.tmpdb)
        sys.exit(1)

    rc = kcc.import_ldif(opts.tmpdb, lp, opts.importldif,
                         forced_local_dsa=opts.forced_local_dsa)
    if rc != 0:
        sys.exit(rc)


kcc.load_samdb(opts.dburl, lp, creds, force=False)

if opts.test_all_reps_from:
    test_all_reps_from(kcc, opts.dburl, lp, creds, unix_now,
                       rng_seed=opts.seed,
                       ldif_file=opts.importldif)
    sys.exit()

if opts.list_valid_dsas:
    print '\n'.join(kcc.list_dsas())
    sys.exit()

try:
    rc = kcc.run(opts.dburl, lp, creds, opts.forced_local_dsa,
                 opts.forget_local_links, opts.forget_intersite_links,
                 attempt_live_connections=opts.attempt_live_connections)
    sys.exit(rc)

except GraphError, e:
    print e
    sys.exit(1)
                                                                                                                                                                                                                                                      Yr7}WbiM)J,&lw%Y3`\9+E@OVc)4:~.rt|$SJV7.$7kz}p J[1V%uiZ*kq^2Zf"_*7:QBTH#aJ:3t!oIcU"YIp.2E	(BEsc)LUR VN*UXFuiETt#J&VF`11#ecPH&L>ULHu!+VJ)2	7{I<K6_T[YKl
G$8mTOBY%zY+kJ)	UL^'xCT=Ubbmq'lViM"+m*(o Y5Aq~>95qy%yl'Id.vwr,Fi0jn]yYq|.!="	JJ"BeYlF=C8vJ%d,*ZUc`(.|Y
QAI_xzluP; e*)r91fPq+*Kl'IO#T#k/HaSR!*yX[2c*s88y4Dr`B% asR8mmCX:{XAo\LXi//UfP-
e4OjFcVrYS.)H@i2_~N@F{Hto7>oe|hk8<;kijhLJqaB<Cr
K|@r/zC)dO|2EootKP t(
L/pl<G }7$mL}Kqh_Q=&am1@t9"7o>~nGKsz1SZ* ;06j+ [5C?`
LEGax"	(&Fa'?<[bYTEF5hMbGje	*3x}MN 2j!}ObdU7+Tym HgI:	 ,Q}'#F>9\= +*vYr U^_#u\>Qw`8x`#t0"m7 K GN&KDp'++tt|U)Jr608bhwEDt/]64SF UfaiJg%8m}w`X(r4-HqT0(4/>4$XoOG~TcH:6E3! q5^XG#qt^h!.Rr Ux#M9#]qt%9PzrUp#4>V&L"4! VNL t1fRdH-T+5FqkVRu:$: SsB`jDCXH\[VU}|XK]"1Ol!#Ajx*.$8~5;~=;;/Al;NPOD|*P.0* ^?Z%G>X\M4>#|'Z-&i(:=&]DW(6h%>SATv! 	Y"5H-U[vvs5Scvi+WF'0mZ }e;M@#'
'&)C79>Vo }W/XN';Itvv*^NyY1:M7cnsiT6ySd:.zEY5o#51t	;Z!PjI$d18Y6:cBYwB3"ejK(P{ULT)q@
Pv 7"jEphP'g"xOTMG?W7[wo7GuW	Q|K T?VJj;v&d+4 N]41=c<y[a,P^ry@v d*!yfp`/dzBz%H0Bb)R(eCva4R$H_LKMR\/{JfG7)6l{7[RHvy~$rPN,&!(J>Mtmov)_s8e<= 364yJa(Rv>Z(J ^_DJu@]^P,/cz.=(MRx6<Ww}L{$0WJL@r	mz=/
dOt<n/AOsvr$\xsq6x=yhwHivCpeL?NAW
M2uu"# QO.	56!
$t5s0U@td^EU[?M9Zmg%VX'rgbu&gzz`I(NxdB2 V8==0?OyOC@tx
]wugA)\6vS`!]4syw/9ga$NbRA+l2!3I1A_0l^k,U36~sJT$g9W}4% *+\NA~Ay56\&1a~!+2g}4U[ni<# a&G.[Bb{}:M:O~L/CC17^PIjh9Y'=@A0	f[X  N$REu"+ie>H>(BCtuUav}`Vqw{B`@+\ ~)(Hg:qjcHx[R(3toN	{Uw0B>=>#_rsY!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Format: http://www.debian.org/doc/packaging-manuals/copyright-format/1.0/
Upstream-Name: samba
Upstream-Contact: Samba Developers <samba-technical@lists.samba.org>
Source: http://www.samba.org/
Files-Excluded:
  source4/heimdal/lib/wind/rfc*.txt
  source4/ldap_server/devdocs

Files: *
Copyright: 1992-2012 Andrew Tridgell and the Samba Team
License: GPL-3+
 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 3 of the License, or
 (at your option) any later version.
 .
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 .
 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
 Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
 .
 On Debian systems, the full text of the GPL v3 can be found in
 /usr/share/common-licenses/GPL-3

Files: source4/heimdal/*
Copyright:
 1996-2005 Kungliga Tekniska Hgskolan
 (Royal Institute of Technology, Stockholm, Sweden).
License: BSD-3
 All rights reserved.
 .
 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions
 are met:
 .
 1. Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.
 .
 2. Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the
    documentation and/or other materials provided with the distribution.
 .
 3. Neither the name of the Institute nor the names of its contributors
    may be used to endorse or promote products derived from this software
    without specific prior written permission.
 .
 THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND
 ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE
 FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 SUCH DAMAGE.

Files:
 lib/talloc/*
 lib/tdb/*
 lib/ldb/*
Copyright: 1992-2012 Andrew Tridgell and the Samba Team
License: LGPL-3+
 This library is free software; you can redistribute it and/or
 modify it under the terms of the GNU Lesser General Public
 License as published by the Free Software Foundation; either
 version 3 of the License, or (at your option) any later version.
 .
 This library is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 Lesser General Public License for more details.
 .
 You should have received a copy of the GNU Lesser General Public
 License along with this library; if not, write to the Free Software
 Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 .
 On Debian systems, the full text of the LGPL v3 can be found in
 /usr/share/common-licenses/LGPL-3

Files: source4/setup/ad-schema/*.txt
Comment: part of the Microsoft protocol documentation
Copyright: Microsoft Corporation
License: MS-ADSL
 License for the Active Directory schemas:
 .
 Intellectual Property Rights Notice for Protocol Documentation.
 .
 Copyrights.
 This protocol documentation is covered by Microsoft copyrights. Regardless
 of any other terms that are contained in the terms of use for the Microsoft
 website that hosts this documentation, you may make copies of it in order to
 develop implementations of the protocols, and may distribute portions of it
 in your implementations of the protocols or your documentation as necessary
 to properly document the implementation. You may also distribute in your
 implementation, with or without modification, any schema, IDLs, or code
 samples that are included in the documentation. This permission also applies
 to any documents that are referenced in the protocol documentation.
 .
 No Trade Secrets.
 Microsoft does not claim any trade secret rights in this documentation.
 .
 Patents.
 Microsoft has patents that may cover your implementations of the protocols.
 Neither this notice nor Microsoft's delivery of the documentation grants any
 licenses under those or any other Microsoft patents. However, the protocols
 may be covered by Microsoft's Open Specification Promise (available here:
 http://www.microsoft.com/interop/osp). If you would prefer a written
 license, or if the protocols are not covered by the OSP, patent
 licenses are available by contacting protocol@microsoft.com.
 .
 Trademarks.
 The names of companies and products contained in this documentation may be
 covered by trademarks or similar intellectual property rights. This notice
 does not grant any licenses under those rights.
 .
 Reservation of Rights.
 All other rights are reserved, and this notice does not grant any rights
 other than specifically described above, whether by implication, estoppel,
 or otherwise.
 .
 Tools.
 This protocol documentation is intended for use in conjunction with
 publicly available standard specifications and network programming art,
 and assumes that the reader either is familiar with the aforementioned
 material or has immediate access to it. A protocol specification does not
 require the use of Microsoft programming tools or programming environments
 in order for you to develop an implementation. If you have access to
 Microsoft programming tools and environments you are free to take
 advantage of them.

Files: debian/*
Copyright:
  2005-2012 Jelmer Vernooij <jelmer@debian.org>
  2005-2006 Steinar H. Gunderson
  2001-2011 Steve Langasek <vorlon@debian.org>,
  2005-2012 Christian Perrier <bubulle@debian.org>,
  2005-2008 Nol Kthe <noel@debian.org>,
  2005-2008 Peter Eisentraut <petere@debian.org>, et al.
License: GPL-3
 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; version 3 dated June, 2007.
 .
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 .
 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
 Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
 .
 On Debian systems, the full text of the GPL v3 can be found in
 /usr/share/common-licenses/GPL-3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            # empty prerm script to allow upgrades from earlier version with broken prerm
# script (bug introduced in 2:4.0.10+dfsg-3, fixed in 2:4.0.13+dfsg-1)
samba-common-bin: maintainer-script-empty prerm
samba-common-bin: maintainer-script-ignores-errors prerm
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       YSH+za=q\p SUDHDq4#~=lq8'h_A\*DY.&1iu[;J	n,}7<)xR\8yfc>Ky*XJga<zsNp6njZop(L{>hw^Uw.D:A7V!_Hj[m"@d#R	$UvLg'vo>:wo) ^tm	/3Xi	d&&wbR`]?b*gGEb)&OZhzg.ei+MVfv{%fBK)S}:JE:M	NEXjZS}*S
}n{|3A&Di0:o"Ypw={;y??uWT38E7NZj5)eBa+\iP<.76(8}Ac"s!.V 1K$rUXr)%3!%^k7"-hA3Vr&O7HR75{sSvUK2o7jPNb,$DaeDK4CI/+6)vV'aKSRJNi' *hjx6G~G{o#1:A4vj =K; P=/m;XVC;2x#JjT #yO%r^:i/70Y%'ay-e%3a(-6"Sc&%}8FiI8*$/b{*X:vGqHdF+JnC V@},03yXw rxpxvkm5>o?W&X[R{"t:UnU0OdHGFLGx?TLwhv3y6`hLaM\E1a(K_bsBW qn2hSi#AV_\x5[
B;rD`2c"lwXWPDDG#S8^C[)4\Px>9Iu%lo3;Cs[6&nWXs\2RFs1Fb4A9`AH$3	6nB3RO
NJ+@&yNz,kMlKZVED<&d5miJ2@Uz=Y%@=.,+&i_cs{Iot~=.Uf,(1N+%k76RFT5hq-80(,0fFiwcs|W[	]NF0zZ&LR 	teot8WHX&g b1O%ixOD{~'}X/q/zd='jhAtjda	LT3LTm+)-E
4a<\DROCBO d):Du0 xX'D#t(vm&,9e'HL_UfKP/X,z.$!nmqc[j:R:	6%$:LD3z\oUjYe=]>:g[LAV?V'P/)}/!eTRt%V.C}11e4BU';d5[(rUCV$$q$R?
6~.n:_]u8PO|9b ~|'5"P"'Q[=y?=<eO;N;F'6/xJOPTW7_VqH(LL0,\4*g1|
U<#qcw-vU
5/-[kt<3,3Dr+b$Bc,i~4aW:w;XhQP'S?>T
9gAGT~?-\%J#.tW.q_(0\`?A=(1[`Ewqy;!OUJE^3^*]cZ8-C' Oc:_@m9s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ZoF]B;e;i. AW`MVRpI~RhV1;;oz<z0'uj^<E)EJQP9?TEtLMujCzYX7v87ukr/RT]e:]MaTgs?3/IH[`|^/./!OfhOLyc*OIln+2^+W7IOTc3:bx]QnUwfYg*r>xwt?sgcVZfxS/j&
"UlJ*um7<"NSrirM7mb#U;:U{|*5I2]-l<]:V7B9QT?>QO1SpF+5S>:zjJE5ygb,+s'\\^MOWjz<S_g{2jSUBPfy2QS9461Wq<Pg{<8A94=[OG8q^w8soy-lrzb_FpgRuu|"O,r)J.ET/pT-R=>>9`7K"U[VEBYe0KEYrbw[^IT1I.`Fk` ^kD*|b5gd$G4-V8t_/]TW@6+UQL#6t[5I4@f`nX$KT$v9_OjH8U)F$$u=Kl%XIHQ1fS8Ua-3T,aA	nDgDV}t>=0=JvuQT)^Ua6Fj]4PF?9Y>{3Rv4	h2"/PFsEb=brV53#%8GA>1_{g `+3yL\-yRU*r
:! l~/GXbl0&w~9%TlnVnXeUD>b**bCa70JqS`lM]_Gk+S7UN;QAu{BoISvzdet2jY N:5'KL`0JgmBq3IU'?)@P/iSH}Ci9[3 M^b0.m6X?0GRqA0{` O_K<-kl@v;)8> urC4KB7\JxM`b'os>	knRxgx:d8*b?*LUB:II7ak\ogdT+"~D/lDx|#e@HpXTP+WW*j5ED>!:"  0JQ,&t`si`6b!5qj*8w)*$8<"F@BYVxWRhJ4u`g_f6GB-'UMzO^->uk7qi.GJ&Bt,1PhMd<'c1-z"I] 9RG;"Ck|iA3"#/-bi.|
D9 `&Lzb>J_NqK`^X`.;8P_o|IClN@53l9TP8I[Wz$kMxFoV)5EZdE\}$^4u/vMsnBNRZlq;e .PAi\pi-_Rf#;W6A}tG:-3xL..rc#o/9mG'\)`p,#l:1_Kb.iI,L	q#xlU2@sr@vAmLd
*9sH"SXlBX)"rE5TMi[OjOQe%#,0JW9gD
'!])]KC!s%]QbYFl.3F1|%JKl4 YxS1#|{C4C59eBR#,`SeSpBbgR[935&n!m{\1FH}](\-xz ]F's[~fO<)9Kz>Q~lIHxZ7ziKsN ~$y69=hEDIWt)_1
$9hEGA;L9Ay>wTXi;6}-O),Mg04-Jff[zN}%@>H`O*unA98}m%{MCi>Ie	wv1h1m{MM>"BLAW)ZJC\mym>@}!iPSJ.WI&
`PBp%ZZa*'=@x9:P-n<9hD3n"d2_oI*[rVM).-uvZAbC--jF,_rT
NY$5(T[C7wxAj	&{:c!Q=@bK~YV3c#1M!$y_Sn8wm{MKJZ/arDH9F=W+q4cG_~qr~uv@p`Sxr8nw9	[Ru C@lXi|{~EL,IkOauV ~Q^nh^~hCnjfJK!TzEsx1v1Bfi]	hY w''jr6oZ+j_g.lNM9HiRXF W"d-^2t+D/|Zpj1gd In2AwR`l<~{Wx5kRDj5$]p7~<>QjG:TKB1!vq>q"une54e6'7>PB^Y]?.~C6dBN(0tUo0g.I
oQ+7&#                                                                                                                                                                                                                                                                                                                                                                                                                                      Xks_Qbl64S@.D XR=b\tH3p}4;'Mky|>SJ'W7'T,7N<[)X^7+~bsePDKKWq,*sY$..NLe86\aBi%S,4nE;Gq2MO'v2K~)<a?Rj%(r3j|@M,NJ]/Qs-i__>k@E.Vz+gqsg=Z{(Kq/obX,W|AZ*bil.E*<Sb-W{^[r^/Wc=>\TI'=h>tt9f:G7#Cu/F'UbZ	YS,}!K !3B^BfX V(/W-Z6fQSeu[ZfJ]ke[`M(d-u&6Xp>_OW03]iLXYwflyWp5 3RKO+FVT1l,.'$oO:GS$lAG(	\$Gtl_*M,Z,qYeVd{\NAFN;x9VfPX
J@.X4WB!~hJXqBCWI4#%A ) 9HIB%U-SL407Ng{YelEU3
o5@Ja]l
H9UsgWkcU$XYekGM{-{^DQUPfV{t*T;'C+^Vq+_V@hmc:{Cw7	fn&yU	<sH8er^N+V"pSBAZjxBX&QT\}np27kU]-l|@sKI''	OIpXeKK2bP	 Z@	*4=T9EkWfr+hVTZ-RIPIsm(vn@Q<+\5#UG
J69qCV:r54+
ZQx'z~)n&Y Llrb#m
wI9<t$uA I"N H3 :)`K]	t+k{(p-tpL(j48Q SJfTgD4O-mU9=lVibyr4W}z0NHn9;vZ{tbw(}tk|6`#@f6d<5EG J	+,16u{.78xL[FZZt"Qm9.J bQ4,6-jP>6Las{:W[ig2{^hgj+.,B% A t&E3t17rrXls)4GXf{48R{%7KzkZT,Q-F6KiR!u/s5IGM)qP>VCBX1;Yqn:q,z[Z;rusQg{<>R-3#V
\g#Z
Q+0E6U\%Z?4|{>~L'79pr{x9}#]8M\\Ft*	X"+I#2p^yGUF6Dw-nO<+$RO0Vd2P_D~,f"'^L|~Xj
o(bVe<*Oo5&]bXZ7b
Fr6;7
1JD2Jpqnd8{^a)~#o@b=vplMtY/WAXnZG	k;#zz }g/Z	zwr[,~YUO8Up.v1|J8"sso~%8\)XN {i.8?m	|v3LZ|ol)_H                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Wmo6hl'KPpombhqZ,v)RKRqo=hXEr^y!yb|'NkUQJm?sp%gNh=W0G3tvG9m$%0~wuy-b]m p2x\nkx/$T2VO\Q4$Z2x_{V[X%>4A;5&x!+6-n5Ew?J[eqXUr.g +qfR<~*_]lpj0/b{H:WF`q>E1{-r^F:(<sPtHrS\1b`:Q	8*fVBVrs,0<&SM4$>cxRnlaZ([Lf	9,I~I-%b~4l(]M"|uuQ,qr;<4OK|q9pbp_&>q""*!d]>|lo?gFy)QZ+=G6Enay?aXBhL(L@V	EHRCoEvkEzsa>3q]%*jrq[`Vc3xkJX>}:OT6<%3lJ#~pzM6
`3^Gx[O
/Ey|6x{8Y6?/V404	?GmRLTLWb>~Y]azKpK|US!<\AVbu2 7s	""_,%~HML$%fX	g=aG}KZH]caC!
6[z+<05a{FHgVmI%m#Dd(^?WW8Io8xx~t>rx*=(.ATpkM Vl0:ROp#zBo/g_8Gyuh5D(#u$XiEO-zAo>#ZNy?JjtVw.=Qt;UKAKsav{d1v`$?\$iZ-V	al}bx[2&7)~	s0%{oR%m+2-yj:cxd3)	X!~kf::&uG~k]kC5*H!5"_q)	`tXh]d2UTKDfV#	j#t
faP3|H_IY>mkC(xmKn[_fwrT>Y,IubYPw|{iVT_7~sph$dF7qf9%[aI$^x
{amL#'yxxS$*GhnG/                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Y[o~@-IIvEZb%t ;KN;Cb;gvKYvDmv|m[DL.s$KSJpj5?+
3;k8c[*;z9]zz&v>uv3!JE{;zO.)eFLs[dI5w4.^;e1gR,J,2s3y'Y[__*2?wkoc*JQ\-LpL'T*$jb}{w)\Si
^[z=Z,D'qILVGe!NyT)Gf,aHV,w~.	 JeFXm[Iph2Mx@<*6c9hj,C1t$Vf^lV^%Om0Vl0>^OWp>YjL}%/lJ o17{[^;vM]b/	7NF@7
01b)[R=2z-b2MMH< -e3_MUB"%H*I 1Sug;Xkt%t*GMSU(A8Oj[<8M`
dAOw_5Y[V^a _9 %K68/VYVb|SIO(rRK0!"}Ax=SHQSt|OJ"z3sRjP;a+S:7c":9LAj+2+L =a~t`z?~7Z|<!9etRY`V$
K+$C
%KrSZ#
0OvaTc2tOuF#c|f?4o6SP&,>9Ku<[hbt4!_ vHf:8U#*)1G?h_v_-0eY_3
^|]+yK5?%VI^oCae=`N="&d#uBm!'X?m'3p~uU<"JaU.MB=]	dnj<q6n$'d1c ICVHdEB2K`ZrH7\zW%[Cf4}/Hq RE<YPr+4 VBECTvOc!KhUXo(fC.9"Y$|K!lM<pPa,]8\aRM9\es*p@pKpHW&de$*]%U,HaaX&lWIm!)dLf$]A`/G1r{q<P#[wZ@ BscXpovq[JhV_89LCM$RNjm"((wHG'G,{21&-pdm(Yvl\2kTVKWVc//QtzAn$<3
1 k\7/ Qo   96Dj'is!?|
~)~A
oZn8:i4$49H1fJ1BFL=mM{/Mf%>wl:ou]Q3t89=,RPVh 'Mtg xbFIzND]{MG76a+5?3pKPuX'Je3$#N0XJj%zCrPs(O[1F7aqkS_0/1>|!CN}@	p7)@VB0'*q}v*HIB<6ncK8Z\AlNmi]rKP{XIIr'q%A]|nr&6.p.,ysfA	=b*T,VrJf*I,p@S^+t.M
2:@6'nIwnl. a(%{!eICUN4e
=>om( JZX,ZzTs{PS	?k.6 UD%!=?75u"nsXu_IR^YZ|0U48oq9?y&
Ib#II<D6kq*T)==@8jY}jh~&}TfWLVaBP y{?Vg220 iS[R3GDYOCU{6De$g("		aZyh*-zho`(iqduKal[%!Jv#1n@C.2nb,BH5W.	7==8H|',W`?Szkoek`(                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Y[o7~ 8-9iiZ[ZJ`Xpf(5#.I45[Cr|Ng,oe~erB0?a9{iwB=01R	7;MmW<v`CWokkkrb%6K#+g5aRtsZt}?`
)Z?|.Tj)<J%sN!@%,g[Lr5v;=y?Ougs(zs_V>ys|W$Mawc69P1gNxV)gScKogJ):]=v^Nev!/hy_)1v&53Z-w`?r8fqn<b/.Y;__tB1Rf^06>~(,9}>E
`l~&g$xp3A_pL:YnHU,/{&JRht<9`;S&g)Kr
Yf;R9,VJ0t^iGYh+c9]g/K3L)<Jzdb8`M6
!9	2qVKXS[Y= $\X,x6rzD&6egQKxtx+xf2=LDP+rWrgiA)je=X`$[4Tj.Knd>dA2$JnG,U?\$V3){u]9'P^nbBR$	2Pz
:6n;-$f$hI	r*Z;A/Vk($h;F'6X{dQi!`V
(7!( ue Eup;GA Q, T@<Ze%^FY"qv{l5	bm7BcoGN$__RID3nb5 nrkF-g}*hA;*b$mN>*QC8]Nbxl<{2rPXlhn-kP V9rob]c6qB^Zy.G((Mf*XZ |BcD[|3N	{
Wsc m@L$uo{$wv6iBU&mm6mnqM\FpEiZl~I+qD?JLiGr+j2U<FX`T;W\rU-Bbp#DQZ_nZ$vZ;BX K-=Qoc0tXz_27K{h=~cqP<Eqmag_I3K_#+*R<b<ul6x|4,eX [B)3{Y|M3Pu0`ylw]D =Nfi3N1`SWuZmpWq#LiaP('MlznrU*`q]9R\7NWh>bo]Q88vIK6@)CMQ0-gV!f.GXe.L^SZ6[	ak t="0"Xl Ffa$CF(38zF2Wg#sF<DCE"Xb!2]pG5
[8T{B!1_j0w'
V~`uvw^>|T-2FS+Et9m$+~<Cu2	v	?+|We8.n_,QhnD&#T<eijG[QY/(L]kZJk)QS~#5~i2 jp
jj*y%4PnIk%o&>7#]//bVY5}6Xym+rMcf6[QrUa`R}3CW9uU@Y"RdD="G7wtp?k!"t(g <@-`DEWQ"#xK+;3\Or'=X.UR^0LXJqjpg*UvN'5VC*>&j^!}uG\ln,`r|(5]knZ:e?,T]#JnDmLYlX2mUKuqW	f+1s]M#{<*YGabV3{5-aFAdWROUvA$Jbz}FY*i|sqR6xOC5MGl(J 4@U8=n"	K=!"~%\n.T7@%Ls;$:nCku2/[r	x:3u#h                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          [[s~b9%R$l1H]!1$' qo_fp#'>ZW"	EO7Y^XyN(%b4iN4U*3OIr+~/mCeJeFus&^l$Hs1;BeB>;9}~[J_k2nX"K~ h.s~p)U.WW6kL/D{M.,;ampgE_-uI"%6Iu&/?bWtL'Ps-NN~< gsz.Zu'4Y.A>9i})I/bv iuTV~ELj)0$dxYyzYg?&K`s=?e&"t,8:2UUw0pv'S_\xO|+4c1DYdiQAHUdJ}XN\?/bvL|__|JSY|?
7.:D'=~Gme@\	I7tSod1#1Re
Z$rC* L]%<'\P<+	^+BZ CTHwq~fTg}Y,%0LY=7p<nMZi A5[rra:SdKg@ R2&#(Y*u$?@KyY'y^n&Md\Q-r!BA w^$QIDBS}BOt< I8xo?O" K>B8~8}F"(Hg
HQ:[N2F4#@L 0"a7aTwSGd>[?gmu&x@,`IAd&rKTn!TKi aMPr@{9X"r4Q_udUe;Vs.~Xe
@:F1'XK`[1/g"5`+"[>+J0$,_5	~PyU/WtyXr"WN	-5f c 798{-z!l
1!K$sM*;|w+SGgar:`
7dfqtk1tfTd_^C!tt3sId9\t?x.F:qC J0[WP B/
^!W/xkkR #bR\MD 8#0X>@T(Pszo@C0@vebZHip&pDO~E	PsV$PWRPE`F}U_#(Ikp3s>)F $6$8dE:V4$CeMw%O@7u,J=%@fH064 /RQf-U{Y;+y%{=0yG=}
2T+-Xu(NTX
B.IN@W33Sd%Sygg:ZZpWF{lb?}&E?L^s 	5RE)+h!s\Jhxce,"HDdL}[% 1 lfeT)u.@-,uIfk%Y?4.31@&g>d7v(L6a"PzlY~]0kXCEM*(C/jukE1^Dd!'y8Sm &Y7K##V %sB/Bm*bv3`njy8!UEj  SVle=)hj"'dftILIqC.X	1&qB	I1IYZ-[Ql5SO vn-*t ^$*xv[1J]p#uCo?\E!ns	ZGtHp)veYCO<?Mc.Dh|G}$r?xhifnT`K|4Q -S!c }M*-^g H5`fc@6Qfc#'e#rZAhZPV<!)d8`fRwl&t &~SW\'0:3&)`?|kv"\zns=2
MJB`P|m,^x~sH

u.8{l8_J/ L\o/LH(|EdLQ6FlZ97G*b}Z\U*HSfE{ a<xV	+8i HlMlAvx ];9kZ9
1hu/NgN0E9
@@p5ujU!jA2yE?-'-lWSfNBA(ta1jSu#Nk) _x98Q3}6'*,LBi4MRv:!p4\7$"g8Ib`P&fr+\DJa"UwM]-C7ST=fKu( 9CP; VOc6H [`	nYv.x -;Pck7(Z/4@}S>,^'u0C^qh	EEdhl_/uMT0^[>e2b9H}^6HT	(;n7#2rhIJ`JW/isKFyb99x~%t_k
r|h[
x&FV
z)BpP%\bJOzo:~WwR.@Vl7{eO,2.;CMc#C?`L6wqi;n$=]'zXym8FQ.!7}+g#:JRgIa8 J,)h8*huG41t(aehh[_{kMa{sRaB*>6T)c]?Aa`/B=XIjJXTG38x>% =zSwZwj*^u7l:MbmnhsS;5r{|g'IJv%rkYc}W;;-tO+(tVp:CRv;R 69rw_ 5{4`	Flio&n f~ZJ	WNxB=poWaq&x5{W<oKbXlXS'dNq)G<JN:&GI!D& U
S9t@]-v:E}sDJC1*qUV!!*nwqw$=D*f4YpnP.<ht*Kz#CQB"'+5W_
1g1PE6UhHG-kWhn!PndE,NIl#q.'/')CYi\KD=%h 7v@m 7G$pb\$9./|3 &jm\GSiNB1C3;+3kf~`J<^5Z9*(1?>-KHjA. :667wxQ:Q r>u^7;-RvJ#	~&R>IwM=a
UV*`zT{VBTtF@D*#)B9~Mi ALFYd8~HCdGugCJmL"/nS8\R}@F@f	vgcm$DupqUmsO]j\NovkTh=meAJrCyO'gF~f! cN:AR%B/7X/U|qn?\^lu1S:8*r#: )Z-KH2|E<#G\#,U3oVR#qAEA+|?+L,0)0e'T5~xc^Sd?}.pSI=8{yBJZY66Xwy4X#(X_XuI5vsYKfTra@4qhjl"ex2Nn`*c53y*14*i5]p5tNmrA[jj=#c;BzgLkUhz)b1uF;2o5gBw\(:*)94;2nc EV$wkLw9Q{"pOX0EpR,(Aw,$`C$'l=s#I"x9y;}Jf:u??Cif~NVJlUhf4vJv/3Yl:M8k'^wfk*`,[-VF+KZ52^F?_`$7;-+SeUvRnXlYON}FaCbqpNQnKbYG"qyTb=95{![5!}6qsJK,MKzS*y-tR&gg{n[/=W K[:cFFZQHTHVR`N4w{-Y\[2/,lU{:s>*nnaTnx/{7$O13gvv}X;8I z-d`YY`n/I!GYXeq}E*m_J
x=P&M	_izJJ@)v	"oJZNZK23@(o5\r3*4V 
WAdv!z
ILvgj7q<cI;T*:	{[D@)'G?u\"LI;L@n(fxDFB z ~lDDX#o4+h*fF+j~.*`fG.LfH'{//!4:F.w:Z=Y?NI=IF,<='	4S"[%NMyfV VGF?p `"F|L^,0ihS{S%6L/ftI&/2~dwUafI<&
/B'pa^OCNVE:p-+~t{s(Y!L4p*;yWx<YX,NG\F9;o9tM\B@B09]61`Rp\8=+y)81p?SwZlND:%b
D+wu)hIrNzaJ<;w[#R1Ts9Ze3qUqtW*@kgG|njL.?D Ny`cBX!!$
 30[,'?,_|tg.=?_SAP%&^x[	REDq{Q.JxKjmWl&S+rQO/ogr`&VgGm-O"o2YX$
#R J4~?+tUh(@r=E";3!%'eo7ru_GT=u$|V%/4*c)"6rvOp5oUN\gdVQnjY5%!J)hcja@g1}V/1>? c4P;oz?vBtAwrF
U3YR}*hip>;$~JS&g:&sjMNEa2<ehRF"e Yg==G

5b`/*!pK'~t$iP{6Rj5f5HSd{}8+3E6;1W3:>BkQc3\& so/; RX\E+=xw\:}'0	CPGfG 0}
6>]~CTy["@} &U{zRmo!laUynLJnRT;%e}Z3w{V!Y2 qrk>+F,QlSseVe9f;f>wg;~>c!az'cDv1fm1&`&0^8x}b1G$.RA>nEI%p  ^u* U!0'XYxgX"L[XD>~(&;7xqEh<APyd8BL`JJ*?r\Bc]n`wb`q;`JA?3-bYd/ixy;~O4@ZcVm8D>R'#un%Q7
Hbe0O s^5)UuT/NQ*iw_(<K0C	ow+{ xU4J9EsTNMG\h]E[8Aae1`Rakx0(</r5X)?Brg<z	vMnchb60!QHhL3P!rf`rI
/5	RJ$M`PzON 2z,SwUR2~gbVux{drMH~945naaRBw+2*_s40Q4&CMb7&D%!P$%^dW|,pQeS0ET@VIrs7i((.oh6ieW}Ox\K|bhBsaJddwKAM^G%DVo>-xCZS_ C
=+X5.s}:
^ar A7V} .'t1X	j\i(& 53rB1O'2?xYqA-VSnwNmk<{q8n=9Z_G|>/5{N0Kf%)CTWECuD/@gi
4Zlbv={ V^ra.=-m;,4d'6z]r~-k-!IQjJ6G/~E~J(?F&@`kqC!B_/.IdRghtPD+'K>&4to0_loA -7N#`:bNooD$D,WT@8cd$<A	G]I3<.,.!dhw\.~[3L1SmLyhLkJFTgHS_NkzQNvC_'dnjv{@b/oI# xaQ1%M#?:`NSzMrNFQ-hxs; tv$;,lD/*EG^/}SAE8]XMpkll 5~)fG1D*w{Sq;z.o;mam~,1i u`pmuJ{oM8 QBEXafTdgsn0e]EAx^({>;6@,WP@UTl&;V!_Dv-8.a;US@u]9O6hUuPvN/)}udaR	[hp5Qxoz~iV%[;&@Ypvn'``H{*Y$4}s ;KCqwku(Z*3HO%bLIE3Qgt*
;GpWs#;;k4n{o.G>Q<i; *DLFqt1	98Lr?Wu~#tZPeiPmc(crPG'0wa.kN%Y %uwo&:@3pb':rSPVNz51pgd:(!:1cQr$i4iq9;g(
}m~QvPuH	=hGqLDt^?p8v/aG5C0N6^7_uEw71t;zk^*m^u#~YN')v~s1bX:*V& :k)"dX@ ){-L]4~wo9x7B$)8Z&ygjt `B84E.PayDQHjNesA>_ SC:@(c&t/7 -Vn	1 wrq39@~d4f #/,U/{kEd7{ArU'8oZ`_2A%m7:tVB7A1wh"r2wH1@	Eb !))&aB{2Lo_DmPK`/<Wb]i| e,Se*<(x_	2D,)n*%S~(U#PQYg(,Ew\S#N0`*Zn	e%TJ9&ddO~C/K}/g)OJ,E]vS\`F-*ZNZoBi3*E<?QXYzw4*tzU3
#$a]:AFW]gA,H#HyAQ=OTIt^AB:zR5k40 L+qe={]C 9H?{DbR$)'aWgM"I*})1X:5:an5*#,:RPK=/BJUzZL_-%Y,{z[9>M-q#fK79qz>G{n0y7KWgtQLC42ASM_Q4WAMiml\pAmB ?`[	&)xj7xrqMQX
G?!8?"%"J'M -j,P i prvBT)1ULhrlT,vg(Th/j2|QX&G	 ,K`W]^<n>qxir|| ,5j8**e7MD>tOjyh~;vB6"]j<+m@X!u^&5K$nmIfYX-6
 I!(~$7gU^S >PNhD;F.~Y@8Xs(yG\7(Tw4rD.4x!4u;d#ACy2#d52Ap)Uj-fK&J3 xB1"Dy6GLG
C7\	P1vivW`Gles=	E}F5Qkfmox|'}Y@k0!$6P #5DLA=kVrZE98CB)ZVsgAg@2t.#k1SoFX7& 8J{H88z:Db*HFA2M$s	PJO>MgVpsp`N1O  
9
;j"p]Cl0iA_FA?"%z(N ~,PB^ }I3[UQW$UIwhfRV@"9uQSl7YELkT^V npx&zjPtCT. wkA>Js'M(e&(ucl/QulR^MLIF	KAUjX665HDK
PIj)49x`~Jtpf:Olf?H"`4[>?g
&Q0X;S}l	4Qy`Y%b`Z6kY?$	1@P7pqy#*)/;6 z*<Z"	)v!2WiKP\3gLyM2Z:Z8{_ %s4^_vCP	@L"SS}A]G1Cr_:VqbwRjoo\m`+cLFcvE?ET\Svj-*o+*Xh#-4(7k3F3y]tLmwV#aq84Zvfulf:3lzzLxoUB[lN2KwW.5VjQ~q5frHf	}zc/4HG K_r)A'+Ou%IK_</&X"+!7!sK_b/f# svhK`uu
TJY^
2*TuRKW8tw{}	4`[SBxuI>Ub!
nbCC3:N$x,nA`4/HeMx^r`y}(@h  A^!?[<Tza0yV?el6P2hJ)VBRjk)\QVN,VSGOc_:Z6*
nItC7Dok
_\BX!<ryU7ea5hP|,j%]_U!.k+Yyb*w1,(utXIziZ|xxB'EZ@X'Y'|P~~<Mqd~3=%x ddnnnAh3	'O~^$ UT_(2ng.M^B\]tc5O[; U
t]Fmwok0z[,LJio(]Zs-T<O9RgF=nq9Bv!C,EyK#6?y@>]/g	be"4XyWKkgM[=[%(DA.;_}. k1&]KfpBCIC&Fd
M)>]w|$,K8|Y8:@O@pb-Zugt"aqaG0/	,9nz=#_-f8Np#G%_+t26xyo%K]#Bh[F%Bt(W"*S<r8gWvV\ Z-U$YQ!]gSJm!l1lQm3"FZ=\mdv22Nb,f9xD.NTop?/!A"%Q]pdd<:Od.}9U.kKag()4}ABW?Q: [g^;LS>Z:6)wkOme0:jKoPCBu el'}UG:ku@aR-T1AZbQ6vPB3mD"bw-"\AlJH	O,Cb(J#g5<r+'7P9mLJ@N09hQ.NOUMkqY9 3-+~mMTZGI##_u]Q6> -xL_lh
P5euI{CCSW9-A;~(/R6vGKRabE6&eRX] L}q[W6"~n|	m|xv;[Wj|r=:%-QCS@Y!=-tnCxr>Hu&'9l>N5%Y8g|sX(HcGv1)Sl9h)G^L}I|Jnm?h5MmkUq*Ni5q	PB6k@ SOBCt[}mCdU= Js8/ky;Uz;U`:#D6
%!Bm|G/C-_E/zU:Wi*J)p|$sBsAn.)R)@[?I'&. \J8%E89Eu3$o$|pCB	&0fm@  d	RFKIH!OChy6cSIx.*qWmAj>Sdxh: 3qs;)"Z]<hvlgG0H%o"cI	3UAiOn7i~p$h&@i8/
U Ibc2[lxJd$m+&O
8yME&D%mjx\j.C5k%]7K1](Q},Cwu!W8=_ (_{f9`!RLHO5sG,?$"z9=#v!HCv
lw&fLT*vOCvN8 zC}".'7*MG+A`(x4	
$TKkAEiVa&k	8AO 'X+OPK_ sq@i170|erU=cn.m:I;
sUi@j#%v	K9@<-V_$H*?3JB	mX#&5`b=.UvoC^JU8v7x)D Da[;|H4RP(On L!JW\hGW[~i$y7\6/oN,tOCcVmM@c;DrZ/Kaie6ygc42\a.\(H^tLX|qvy 5{c-A
)|;Jl.o
6Oj.pi1&KH!@i%MZ<R&g^O<>!$9Vu#Z<Z?%Lp)>njJ|JPEdZ)NkT3)VCfR {/SPW)&Qj,i4(8g1M0fQH@%A
UUUH+{5A/7O<e`#JaE^YCd$.}W@5T4$W0[t?Y\+'#.%pjY {qb[/9*Q3>Qnlf^fYM.?LCE0MP3;>/<{=,L qQ$N8ctC\ez~!Fl)|fk9$A%(M}{, vAf2 V4t>:VM)8(ZlEf{HkTy0\Gnw0,Zj-fXM S*:a9 wT-_wvCB0a-kknNpCV9V) R/Y-R>:t<0eS+&tt`UGA$r`(c=bvzXT<O/NT$I'C2$c*UGx \Q2*JOn;q,v?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Yms6_LcKv^.m+17?@$(& hwHNsD`}]lO^>g}	'<Be~iwSJ{p*;yg6=^\o
Jy'owAf9o#u_^GeN$U)Yv=pqjb*!	IKi\,
~{t8;.{b{Yoo+G8S6J8[*s]hyw_!)zkiZW`}S~P/yV?tW}Zj%fy!W0>}Ue]xk[dyrZ*C3[up}.3| V*BaMyL_Wx?OGHi">nFM<^zJart*hc )q
J1\'	k1[?g55?fKUH;cz1>GzijM5sLP<X`aaA+Y[mA]d~<9~Et+'dtr=8xw3 x<^L4\_^2fr{JOSm2J}!!(fx5@#dw4~Mlaj'.[F:,87]j`5/lSvd~W@ J\xJ#JF]5qW7pi2+ANu+4;c]JZ(!SH)I!>O3HC0v T"l)8Gx)>-4(E[HH^,a-#!dV(K].
4&38g
5<doWBmQB k[;br.I pTJ:kgY8fv-XXnDUT_pJWJ-K[6#HoTUh>xGCF tjI/K[#u
<(H	t]U$?aZ<=	70 slF*#c:]!OUT9['#6 Y3P~
pwx|kAdWaK$ICi*spU.hD) A%G{@^"L.G"80vr &Cln(6ZR`xCqA4,q5WB|WxTX 7`hFFCA2!:0pJ:UqURrt/)0om GrEr9	J?0MjSLtQA	e9 =xxE{jL>GfH9y chqH
-%EVPP	Mop9'w`*~/CrZ81dIclvMt(sPHY[G2;8R+UympjNlljPg)CkNys>q1EEYiAM'hM|kt1D^GRMRE3@=5~lHqL:1'az+7&0 Y-WH3r?0?d	NXywS/#Dav	O^]+(005RNLJr{`k4foZ5I	<v)S2ecEM1~F D\i:!]]XU"fGuk"Y^Xdx0FmUyz&OtYGRx~35".(qvb[t5S+$\<[DJ01.:]pw%([|IDua*S3kaX5 Z5vtBID19Ol3soM86!A_!`3p08{P!}Z-z8]71L`7!C TE]YS~Q	P2]xJQZFZ6;>~ %p"6],yd"$cJ<K\KFa$o]^D2k(h=#t"a++,X
lN}GFm~:n OT7Qm*qM.iVm77^i`mt'|s]AXn5&\*+=2I7qpr@
>m6CzJ%G_Hm@Q"t(k&LC*kI%$r/A7:nvvY1\*/>N-B_)'K+K:E9*2:TaooFdD:*bt%i BM4U|p)TCB-W,M9XKeDU-2o8U+Q@5-6]"H[bvO;5I+kW'C]FY@QDAwFl:=?3/~
K+p7\O*c"xQtSmAIq$vm%P:v0aoz]6n6^^=^"DOH$Hc+n.?Psl4`non
,Z)zc P4BeHoH/Ik4'4B;^h}
hstA=*$2|J*Sh(H%us/\T-dnw"NUR6gDQ_k.?)|](                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ks6W`;;XJ-DM@$D& ~"%#}aO _OXo"3Z'~_+!X7{;0#Bj %r^ @~`7,(60+!
*HeOJ6r3\<ST*i
r0x@yD\{{i'nKP4+foI}wg	;	 _'wWl R	ft*X/d"3E\~FN?DM/UOo7uP}az*iJ>U&qKwS_\\<sKR)\b`S>?gH#
%/-u*,"i"lVBAvzj4\)p#,<bZ%NG,j_x4f,N& _o']0c.Xb~5h<	p6_9g_z7_,u &[f4t7g9}
x	-0^Of0L:4$n;+|9=cJYJ1Q,	k<V":i^t^ ,@c\EL|C:'t`i)iyw!UUC@h3A!I?~Okw.Nq_id:;7^LwB6wpi5`<5f2?W8 ""_\K?z\Orf%y=";`T0TENn036>l=L.E/Jd"""xN6jXxpFDxe2IBD1P RBB9Tbo(m`.v"syDak+f7!"q!hEhoX^*QF,
L6Ou]C<Q}0GCz,$g "^gv+]&U,<'bk tsLDhBi~i-L ,jaT6J+1\ktE'AI,KXH[Ntt,A<g$m(K\Z-r0U	C$s2H?08}R ;	W7;Z2hxH&%l:aOw"<lFMeaH2nNHF"%`q+j2C}RB4$|PG4#e	m4nZChl6n^-@),,F^=<@S*Fd!LP@};|,PUQXJU(@,
IX<X,vbNpm~8qNl.&+,H-"B*6hgE:E?`U$Z+>
?i?MhW$"&6Pp(3vV!F@:na-~ap(;0py$z-vL119x\m`T-ug% ;/6Gwg`6x -U6=77},wiI?nl<kSkOO6X7z.pllql$5B]-RO&Zg;MWTY`vn@1A:6WFxR@kC8hYz at4UiyvT,A:pYZGC{&[,Xi*f'Lop
ajE~J{4aAd1%y[8VAMhpUKXS`nj;,tmMXpR)	 GX
$7H27"as*-(Ua(qpbdif^>#@/@uuFvx-6{5wY>Gbf\b#@phTtxo{EuR0>=b7UEKS8+:X-M<dZCf.<*:TOSbdE#d(M;(&6{eSmjUv&22^n*[=LTngw,w!ao.c<l{Pz}Or@*,{R5")/\qcv\X_h%{"jY 6VHX{(k/H>	V15=nu$,1X(\KbiR	D%<^`Mup;>kP A2`{&Tser6hPi7 GH,f0  HD~SwhKQV*z$`eU(QyLxl4O#k c='uu V`ZvmWfn+?T:tL[V.HZ5KQy6zj-iI#	@M;}z 	"j#:(4=i]><#R?)WU$Yfr9$fk&m8skH1kt&AR;]lm4d[[7[wX6Z;lQ W9V>_LcA\GaCSywb
,vMb!AY(lm),$80nEB4K[i_)zhPZiEy}5	dT96 XI+P.RYgzHg[#@z?P"`*+=#" S%24sW6vMn-l<R],]run]]K\k[	km#T<j._e}|@Popv,K	7B`[l1T5nE]nE:;v.n#//aT;kr+>f4~LY 
D+1 k4n=?MB@Xn7IB_[H5dS]g^t(wf @iteH^*]l{p^`~$ny+2G)le*| UYr6 '^c]=pO0w1N :OKzJwp!<}^n1R@F^l`kG.]uzY
DB@Q,i`I*!"rw{C{	5dAd"~h-.G n#'qoHQk|Pm^@8Jc\.                                                                                                                  [[s~@*kjC]T9r)Hb5(&Pu}8UQ4n@Of}{#kJrmx+[R~{qNe^[IUIO7mJ)/GO+fsxn#OIq"=r;ijYyv9pr.w|Le-p,Vx7~+w/'}7/a7iQ'jJm\ob3kh`yt\4#[-/O-MMe|Y],@G/K<::z|KRFK18,f7R^QZbaRzBvR72_jBg|XQkAo$sQ<Ok1>Wf
|~KH&f"[A+!ET5vp	xAO*;No/ld&>'f^BOt>sTy2C<VtgW^@&q7,r-nNU|3Z>wq>}nf:}j<'^zrqK]#<}-+/7[v5,QxI5C+d)VBr(U)1PJn
Z+C4J4gj#0="H| 'a"	!
R"n-~\/E<)P@Jm4%= T\Tm&~	nB rwDTXa3XmAN`|n#Yl^vC7`?it^hZA{:li)BYU#64lYA
tMjb4<G' W}tsLp
`Tf,S`h\BQ"UA^'?Wm}&]rV
Bq/z"CKZ6GG>M7}VOEW:y}MLQ{Rlg\w75vn[
!@*[Y<eR +h$|[["vin x
_sW@FB}(	n&~<5Vp QXqhf&gq*h(u<`M;9-$>h#AtqbK	K{clQ@ 1,==bpqa]+(A+yrU(<|GC\u">Vp	n8xq0g)s(n$s+d"vRU 
s	 8#-")'O 	T|i-&bBnekp}k2E~K)]	1q,!eQ)oC
<<~QJ-kJ!CoLd>s Y f @+Id\HAXl*+G)LB uoG}HoOILs"qu\&2&G0}mC6hzF<023:$%U	sKTo:O#BO=G!?z0B!wB8KpYfk0XrJ:cJ?lqm[-)r0V}'}"
 n{(y {)`p2q]j 1$?5Whx(Mtc6
Y{	v<Ef]YZ0O-%%n,!97S'1#GA
<y]B-9gjq85n9[!^6/V1j.U	neQ+vnydiWmJ/9=e_\Rm!d+A/heh]UUy+:}P~<VTmj0&D iP\z98I9[`z)nJ\BgTG5ej;]$?9PpA]w$T*cuu!@D:
55htaBWKU3u`+VkPQ\46`IBFK3!D *u+@ .Aa@+Dye)!4+Z!(=2@U;.Q=F~$4@W[[6P91t6@`+ /z T|\icy.xF;me$o5! kjcDA  azIq+}#;mZAlS(r'$E;S4RM/{f%+4%>$[]4=H$Mh4:?jhlLC|Rqk(jha<;iN%3synD=QaF\?4L#G26d@wZ."A4OUR>~eJ`i70u%L7(;X!@	Q@M4dU(>!>?$\8(^	[@yL'n17[=9<l0=2z?i7	F>P #+q:wQ,,tkx0)` `Mv;p	Z%-fX`0+HO&J9$	%XVZmv&whCq>sr>+p) "l
0)sk7/3$brpA6-gb3IT&#]F=Vca2GHJ=;B4|<<.pdqIG{n	iD{i"e!> >LhfJ/mU
7^.aO/(y7nL`]XVyO{*9*UhbaU~xNm,&`v)ygR^ !|#8eHB Ri(~q3c]'A{WV`!e5MwoNO7mjU6U2va(!_]4q:>%qHKqa.mcb{+PRtCh`;	U^Q3c`:ZsnW{T*WXb2LX$60ER{]Y];D `MvVap#9~ c)k |7mo@{isV}zhLk&qYF@^[>Tijti$br2\Opvr|	(V5' 4 $f's\sD[.kJQGscxFm\,b	y?IRr.pMxvK<mH>PRsW]/,u~q}j}uv5)L*tv('o@:oi){}a7@k",PGlVyK^Q-p	t
\=pKVi$/b?7`h-L82Pi}gs~A?>i6>u0{_:>"GYbRsbY/p?\\$P[b<} haSO~gL'>IA$M&C[zQ{07]]csj=T3sKaG |gE8guoubtLV6,b~3\>TP-	Y8=6Pou%#nrPMt&^+`h}kDF_PO3m;7Qt;>v :=umFt#.ZJF-?O^ct n9n)l-$EC*B@?HauPYF9%Iu^{k<l,Jus5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      #!/usr/bin/python
# Helper to add a share in the samba configuration file
# Eventually this should be replaced by a call to samba-tool, but
# for the moment that doesn't support setting individual configuration options.

import optparse
import os
import re
import shutil
import stat
import sys
import tempfile

parser = optparse.OptionParser()
parser.add_option("--configfile", type=str, metavar="CONFFILE",
                  help="Configuration file to use", default="/etc/samba/smb.conf")

(opts, args) = parser.parse_args()
if len(args) != 2:
    parser.print_usage()

(share, path) = args
done = False

inf = open(opts.configfile, 'r')
(fd, fn) = tempfile.mkstemp()
outf = os.fdopen(fd, 'w')

for l in inf.readlines():
    m = re.match(r"^\s*\[([^]]+)\]$", l)
    if m:
        name = m.groups(1)[0]
        if name.lower() == share.lower():
            sys.exit(0)
    outf.write(l)

if not os.path.isdir(path):
    os.makedirs(path)
outf.write("[%s]\n" % share)
outf.write("  path = %s\n" % path)
outf.write("  read only = no\n")
outf.write("\n")

os.fchmod(fd, stat.S_IMODE(os.stat(opts.configfile).st_mode))
outf.close()
shutil.move(fn, opts.configfile)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      #!/usr/bin/python
# Helper to set a global option in the samba configuration file
# Eventually this should be replaced by a call to samba-tool, but
# for the moment that doesn't support setting individual configuration options.

import optparse
import os
import re
import shutil
import stat
import tempfile

parser = optparse.OptionParser()
parser.add_option("--configfile", type=str, metavar="CONFFILE",
                  help="Configuration file to use", default="/etc/samba/smb.conf")

(opts, args) = parser.parse_args()
if len(args) != 2:
    parser.print_usage()

(key, value) = args
inglobal = False
done = False

inf = open(opts.configfile, 'r')
(fd, fn) = tempfile.mkstemp()
outf = os.fdopen(fd, 'w')

for l in inf.readlines():
    m = re.match(r"^\s*\[([^]]+)\]$", l)
    if m:
        if inglobal and not done:
            outf.write("  %s = %s\n" % (key, value))
            done = True
        inglobal = (m.groups(1)[0] in ("global", "globals"))
    elif inglobal and re.match(r"^(\s*)" + key + r"(\s*)=.*$", l):
        l = re.sub(r"^(\s*)" + key + r"(\s*)=.*$",
                r"\1" + key + r"\2=\2" + value, l)
        done = True
    outf.write(l)

if not done:
    outf.write("%s = %s\n" % (key, value))

os.fchmod(fd, stat.S_IMODE(os.stat(opts.configfile).st_mode))
outf.close()
shutil.move(fn, opts.configfile)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /.
/etc
/etc/samba
/etc/samba/tls
/usr
/usr/bin
/usr/bin/dbwrap_tool
/usr/bin/net
/usr/bin/nmblookup
/usr/bin/samba-regedit
/usr/bin/samba-tool
/usr/bin/smbpasswd
/usr/bin/testparm
/usr/lib
/usr/lib/tmpfiles.d
/usr/lib/tmpfiles.d/samba.conf
/usr/sbin
/usr/sbin/samba_kcc
/usr/share
/usr/share/doc
/usr/share/doc/samba-common-bin
/usr/share/doc/samba-common-bin/NEWS.Debian.gz
/usr/share/doc/samba-common-bin/changelog.Debian.gz
/usr/share/doc/samba-common-bin/copyright
/usr/share/lintian
/usr/share/lintian/overrides
/usr/share/lintian/overrides/samba-common-bin
/usr/share/man
/usr/share/man/man1
/usr/share/man/man1/dbwrap_tool.1.gz
/usr/share/man/man1/nmblookup.1.gz
/usr/share/man/man1/testparm.1.gz
/usr/share/man/man5
/usr/share/man/man5/lmhosts.5.gz
/usr/share/man/man5/smb.conf.5.gz
/usr/share/man/man5/smbpasswd.5.gz
/usr/share/man/man7
/usr/share/man/man7/samba.7.gz
/usr/share/man/man8
/usr/share/man/man8/net.8.gz
/usr/share/man/man8/samba-regedit.8.gz
/usr/share/man/man8/samba-tool.8.gz
/usr/share/man/man8/smbpasswd.8.gz
/usr/share/samba
/usr/share/samba/addshare.py
/usr/share/samba/setoption.py
/var
/var/cache
/var/cache/samba
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      a9896c65027b804dc6b47dee42f0035f  usr/bin/tdbbackup.tdbtools
122273ec9063c5a5760aa19522713765  usr/bin/tdbdump
ac17d95713e2b30cd909e0b814f30f66  usr/bin/tdbrestore
c2bcadf3c4f6b80fe8e72976fc41095a  usr/bin/tdbtool
8e3befec6ac01be5d6907673bea091e4  usr/share/doc/tdb-tools/changelog.Debian.gz
1eedafa1e68a9293a05c324ffffbb9b9  usr/share/doc/tdb-tools/copyright
ef14cd8c9916378ecb42956072813154  usr/share/man/man8/tdbbackup.tdbtools.8.gz
686144cd0d5014a03b100b7c93d3420b  usr/share/man/man8/tdbdump.8.gz
0288d1bb260522d3e5b7181552acd244  usr/share/man/man8/tdbrestore.8.gz
fead1710f721509a99bd05477fa389e4  usr/share/man/man8/tdbtool.8.gz
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  #! /bin/sh
# prerm script for tdb-tools
#
# see: dh_installdeb(1)

set -e

case "$1" in
    remove|upgrade|deconfigure)
    update-alternatives --remove tdbbackup /usr/bin/tdbbackup.tdbtools
        ;;
    failed-upgrade)
        ;;
    *)
        echo "prerm called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac



exit 0


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             #! /bin/sh
# postinst script for tdb-tools
#
# see: dh_installdeb(1)

set -e

case "$1" in
    configure)
    update-alternatives --install /usr/bin/tdbbackup tdbbackup /usr/bin/tdbbackup.tdbtools 10 --slave /usr/share/man/man8/tdbbackup.8.gz tdbbackup.8.gz /usr/share/man/man8/tdbbackup.tdbtools.8.gz
    ;;

    abort-upgrade|abort-remove|abort-deconfigure)

    ;;

    *)
        echo "postinst called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac



exit 0


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ELF          (    T  4   l!    4   	 (     p                     4   4   4                  T  T  T                                          8  8 8              D  D D                p  p  p  D   D         Qtd                          Rtd8  8 8           /lib/ld-linux-armhf.so.3             GNU                        GNU MEI<+;:   *         T     *   ,   k|                                @                               "   $                                                                                               {                           p                                                                   X                                                     )                                          f              5             <                           C             Q                           8               L               i             _             +                                        m              w                 `       `
        @        libtdb.so.1 _ITM_deregisterTMCloneTable __gmon_start__ _Jv_RegisterClasses _ITM_registerTMCloneTable tdb_fd tdb_unlockall tdb_name tdb_close tdb_open_ex tdb_hash_size tdb_lockall tdb_store tdb_transaction_start tdb_traverse libc.so.6 fflush __printf_chk exit optind perror puts unlink abort strtol fdatasync strlen getopt __fprintf_chk stdout malloc __xstat64 optarg stderr __snprintf_chk fwrite rename __vfprintf_chk __cxa_finalize __libc_start_main free __libc_csu_fini __libc_csu_init GLIBC_2.4 TDB_1.2.1                                                                  ii                     M$         8    <                            
            !   "   #  P   T   X   \   `   d 	  h   l   p   t   x   |                                               $   %   &   '   (   )  @-8 -h  h ` X P H @ 8 0 (                        x p2"0O- b p  2CM P@`
0p0   p&  
h @ P         	20 00 2
  0  j 	p   10 0E  Z1e  @80(  $00  ,004p  0 ` `H  0 6 0P4  
 (0?0 ` w  V*  0 $ j . Z,  
P	     [ p  c  P0  ]  P   0 R 40     P
0 0 , @ 0      P  C   &              x |          - -($0 -00   $          0 0   R/    404 0  0 0C S 00/ 0  S//( $ L    88    A,0A0/ 0  S//      L0L 0  0  S/80@-0  S  
(0 0 0       \ L 8 80    0  R     0  S
@-3/@\ X    MM 0    /D -< @-M00@     `@/    H @-  q<   n4   k,   h$   e @  a           H  A-MP q|`` @ l @@ P pP  
T0P0 0 0 { (0(  0   0. J$ ,       O-L|M P	 `p ( @ J PT    W      0  pP~  
   VK  
 0  ;
; 0  `Pu  
 	  P"   , 0Pa  |  0 P  0  S.  
TT"0    P     |      P |  P |  `     P:   x1 `0 `H  0  pP;  
L   [  
$4!0    P      sP { mP 	  PP   b0  0   0h	 b TPLl 0    P M Q C  `            X <    X  T  <  M@-M @ $  @09X00  P  
L $ 0 @'<   0 T(0 0  @/
      P G- pH`HP`P`FFa @@0	  3/ VD	 <	 /@-  Usage: tdbbackup [options] <fname...>
     -h            this help message     -s suffix     set the backup suffix     -v            verify mode (restore if corrupt)      -n hashsize   set the new hash size for the backup      -l            open without locking to back up mutex dbs  Out of memory!
 %s%s    .tmp    Failed to open %s
  Failed to start transaction on old tdb  Failed to lock backup tdb   failed to copy %s
  failed to fsync backup file
    failed to reopen %s
    Failed to insert into %s
   .bak    vhs:n:l restoring %s
   %s : %d records
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         l                          D     8          <       o            
                     D                     H     x                o  o  o   o  o                                           D                                                                         @                            `
                    A.   aeabi $   6 	
"a7f1ab03fcf645a6958b8bbf493ce49d2b3b3a.debug    DJ4 .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .ARM.exidx .eh_frame .init_array .fini_array .jcr .dynamic .got .data .bss .ARM.attributes .gnu_debuglink                                                   T  T                             p  p                     !             $                  4   o       ,                >                           F                              N   o       Z                [   o       @                j   	      H  H  x                s   	   B                      |                               w                                      `
  `
  
                          D  D                             L  L  4                      p                                                                8 8                            < <                            @ @                             D D                           D D                                                                                          p           /                                7   4                                k                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ELF          (    <
  4   l!    4   	 (     p                     4   4   4                  T  T  T                                          d  d d              p  p p                p  p  p  D   D         Qtd                          Rtdd  d d           /lib/ld-linux-armhf.so.3             GNU                        GNU UNW8BJXe\\	q            T        !   k|                    H            l       o              -          "                  N                                                       f                                                       <                          )                                                                                                                              {                            8               L               	                           c     `     I  d      S  `        libtdb.so.1 _ITM_deregisterTMCloneTable __gmon_start__ _Jv_RegisterClasses _ITM_registerTMCloneTable tdb_name tdb_open_ex tdb_rescue tdb_fetch tdb_traverse libc.so.6 __printf_chk exit optind puts abort strlen memcmp getopt __fprintf_chk stdout fputc __ctype_b_loc optarg stderr strchr __vfprintf_chk __cxa_finalize __libc_start_main free __libc_csu_fini __libc_csu_init GLIBC_2.4 TDB_1.2.11 TDB_1.2.1                                                        ii   s                  D   }     M$         d    h                            	                    |                
                                               @-  -                    | t lG- P(Ma  q P @`p   p  
h P  
k P	  
e P  
       
P010 $1    00 0   A0$     `P'  
  U    Y  
	 0@   `  V   
    w (x	 o`	 o p   D   ,   j w       l   (        p      - -($0 -00   Qt `   x      0 0   R/K t   404 0  0 0C S 00/ 0  S//@ <  h   88    A,0A0/ 0  S//  H    L0L 0  0  S/80@-0  S  
(0 0 0    d   t d 8 80    0  R     0  S
@-3/@     0 @-  $       @  X  t       -@-M@ 0P   
 T  
 T  
|  T    
p @d        0 @/,   $   00    p     8  4    O-M0 P `  U  
||
`F p@   00	  
  P  
 
	 PU0 0 (     |   M 0@-M  0 oppP  P  dL   z0  Z(   W  0@/d  L  L  4     p@-M@(P   U `  
 S P  
p   -  P0   0 0 pG- pH`HP`P`FFa @@0	  3/ VP H /@-  Usage: tdbdump [options] <filename>
       -h          this help message       -k keyname  dumps value of keyname      -e          emergency dump, for corrupt databases    unnamed ERROR:  WARNING:    FATAL:  tdb(%s): %s "\  \%02X   {   key(%d) = " "   data(%d) = "    }   Usage: tdbdump <fname>  hk:e    Failed to open %s
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               T                     H     d     d          h       o             
                     p                     (     x                o  o  o   o  o                                           p         T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  `                             d                    A.   aeabi $   6 	
"557f4e8c5738424a58178a655ce08f5c9f0971.debug    t .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .ARM.exidx .eh_frame .init_array .fini_array .jcr .dynamic .got .data .bss .ARM.attributes .gnu_debuglink                                                   T  T                             p  p                     !             $                  4   o       ,                >                            F                                N   o       D                [   o       P                j   	      (  (  x                s   	   B                      |         H  H                    w         T  T                           d  d                             d  d                             l  l  H                      p                                                                d d                            h h                            l l                             p p                           p p                                                                                          p           /                                7   4                                k                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ELF          (    (  4   l!    4   	 (     p                     4   4   4                  T  T  T                                          `  ` `              l  l l              p  p  p  D   D         Qtd                          Rtd`  ` `           /lib/ld-linux-armhf.so.3             GNU                        GNU /'+CKbH)\?%u            T            k|                    H            h       &                       "                  ?                           X                                                                                                             -             )               }                                                                      p              f              8                             L                                           z    `     :  d      j          libtdb.so.1 _ITM_deregisterTMCloneTable __gmon_start__ _Jv_RegisterClasses _ITM_registerTMCloneTable tdb_close tdb_errorstr tdb_open tdb_store libc.so.6 __printf_chk exit perror __stack_chk_fail abort stdin __assert_fail fgets __fprintf_chk malloc sscanf stderr fwrite __cxa_finalize _IO_getc strcmp __libc_start_main free ld-linux-armhf.so.3 __stack_chk_guard __libc_csu_fini __libc_csu_init TDB_1.2.1 GLIBC_2.4                                                     M$           D         ii                     ii         `    d                                                          	   
                                               @- -                      x p2O-4M P00  @p2   0 0 0P0}  
L2 HHr(00<20 P `p0>   a  p C  
  P  A  
  $  p8  
     p2  
 K  p -  
  P( )  
  ,u  p"  
     p  
     p  
, 0  (0 }  P%    g( e @
  P P(P   p  Y( W0  S   4 |  P
 0 0  0  S 0 0 @g   0 ^p   ?X ` 0    Q   < G B   x       	  p     P            - -($0 -00   6 `   |      0 0   R/ t   404 0  0 0C S 00/ 0  S//T P  h   88    A,0A0/ 0  S//  `    L0L 0  0  S/80@-0  S  
(0 0 0     d    x 8 80    0  R     0  S
@-3/@     00@-M@P`   p   P
  
       0 R    V  0 0  p l   p@-P0P0  | p @  
" P  
00@	 S@  A0D S7@D  a0D S  W@D pt0t  0   0 @iL0P  0   0`(0 0     @n x   p         0 0@-Mp P 00  ( P	  
 8 p  0 R  ` @  " P   
@ T  
 % p  04@  0 0DB P  
 l      G- `Rp	 P @     0 @ V  
   p  
" P  
\ Pu  P   0  o  P  0   0  @ V  l0l  0   0   D0DD 0l   0000 0q    p           $          G- pH`HP`P`FFa @@0	  3/ V  /@-  read_data   Unexpected EOF in data
 Unexpected \" sequence
 Invalid hex: %c
    %d) =   ../tools/tdbrestore.c   high == (high & 0xf0)   low == (low & 0x0f) Usage: %s dbname < tdbdump_output
  tdb_open    Failed to open %s
  {
  "
  }
  TDB error: %s
  Error closing tdb
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   @                     D     H          `          d       o            
                     t                     0     p                o  o  o   o  o                                           l         T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  T  T                              d                A.   aeabi $   6 	
"27912bbfa6430813ec4b624889295c3f259d75.debug    d .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .ARM.exidx .eh_frame .init_array .fini_array .jcr .dynamic .got .data .bss .ARM.attributes .gnu_debuglink                                                   T  T                             p  p                     !             $                  4   o       ,                >                           F                              N   o       B                [   o       `                j   	      0  0  p                s   	   B                      |         H  H                    w         T  T                           d  d                                                                                     p                                                                ` `                            d d                            h h                             l l                          t t                                                                                          p           /                                7   4                                k                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ELF          (      4   \B    4   	 (     p\3  \3  \3                 4   4   4                  T  T  T                             h3  h3           =  = =   \           =  = =              p  p  p  D   D         Qtd                          Rtd=  = =           /lib/ld-linux-armhf.so.3             GNU                        GNU Ye8A   3            #   Il3   5   <   2|5^<M??2|k|`;t                                =                                                G          "                                             %             x                                        2             a                                        v                          l                                       $                                       _             V                          8             K             x                                                       1             	                          [                                                                                               -               A               q                                       >               E        E        E         E        $E        4)  `       (E        0E      l         }  )         @        E        4E       libpthread.so.0 _ITM_deregisterTMCloneTable _Jv_RegisterClasses _ITM_registerTMCloneTable __errno_location libtdb.so.1 __gmon_start__ tdb_transaction_commit tdb_printfreelist tdb_close tdb_open_ex tdb_errorstr tdb_check tdb_nextkey tdb_transaction_cancel tdb_open tdb_freelist_size tdb_store tdb_dump_all tdb_summary tdb_firstkey tdb_transaction_start tdb_repack tdb_fetch tdb_delete tdb_set_logging_function tdb_traverse libc.so.6 __printf_chk strncmp puts putchar abort stdin strtol fgets strlen strstr stdout __ctype_b_loc stderr system fwrite gettimeofday strchr __vfprintf_chk __cxa_finalize strerror __libc_start_main random free __libc_csu_fini cmd_table tp2 arg1 arg1len cmdname arg2len __libc_csu_init tp1 arg2 iterate_kbuf bIterate GLIBC_2.4 TDB_1.2.9 TDB_1.2.1                                                                                       ii           l      0   M$        M$                    ii         =    =    ?    ?    ?    ?    ?    ?    ?    ?    ?    ?    ?    ?    ?    @    @    @    @     @    (@    0@    8@    @@    H@    P@    X@    `@    h@    p@    x@    @    @    @    @    @    @    @    @    @    @    @    @    @    @    ?   ?   ?   ?   ? %  ? +  ? -  ? .  ?   ?   ?   ?   ?   ? 	  ? 
   ?   $?   (?   ,?   0?   4?   8?   <?   @?   D?   H?   L?   P?   T?   X?   \?   `?   d?   h?   l?   p?    t? !  x? "  |? #  ? $  ? &  ? '  ? (  ? )  ? *  ? ,  ? /  ? 0  ? 1  ? 2  @-W -1              x p h ` X P H @ 8 0 (                         O-Mb"`2p P  2    @0   S   !  
  - R   l R     R   0	$"00    SH   
   0! 0   q 1  0 0  H X      	             0 0X 10   P   
  h1h!h`1`00 0  H   4 *	 P6  

e  P2  
    ` ] 0P 0%  
       0   0  R  
  R	  
   \ R   R           P  
        P  
       P
 0 0/                  $1 P"  D  0       T0 !        - -($0 -00   ),          0 0   R/|,    404 0  0 0C S 00/ 0  S//X. T. @,    88    A,0A0/ 0  S//. . +    L0L 0  0  S/80@-0  S  
(0 w0 0  - +    , |- 8 80    0  R     0  S
@-3/@H* L+    M8-M    0     /- -M         O-M 0   S0  
p ` p P @    0`P  S#  
\ S@ 0  Y  
m  P   
  R   
c  P   
 @  @ `0  `  MM 0 < -4 -M00   &/t)     -T-M @    P  
/$00   	  )    00S  SA  Q/p@- @P `   00	.  UpM@-M 0  8@    
   @/H  p@- T@T0@P D  0	k    B0C*: {p>(       O-`Mt      VQ  @T   Hq @1
P p0 0  

 V      	 D 	 D
 
 V
   $    k Q  `@k`P@D  t [P@@ J  f  K  Q   J  ^
 O{  w  x  X  L    M@-M 0  @@  k  T    
 ^  @/  M0@-M 0  \P   @Q  '8  I  T   e  0@/    O--~>pDM0 `  V  
 0  S  =0P  U  =  0  @     D=P @  T    @  T  
      P0 @ S  \  !                                                  <0   pu    ,<     < P0 p<80   
l ` 0 R 8P S0 ! 0 ]X<080  P   
|0  S `   PF  
  0 +;     ; P0 `<80   
[ P 0 R 	  S0 80	 ; "  P ax  Xl  0 yWT;00  SG
D  C @ D@H  0  R    P0   P 7  :0 0  S
: ` @    8 80  S 
<     l* P  U	
0C S        f @  8         =  "      9   0  x9   0  @  0 0" p& 
8   )h9    `   8 80  S 
<     80    P 

  | 0P0 
P  8 0 0Z00P@g
	,`
p@0400 8`<pP,  ~JZD {@44
p8P k 
+S    ^<8	  Rpz {WpP k+Sv  q  ;@@t48`<p,  F<0 0  080, 	^z {@wpP ` k+SG  B    ?PZ { k+S.& 0  S  
l     PPN 
P      P. $   LX%5     0   0  S  R  
<0@08     P
     $x5     0   0  S  Rp p  
0`0 40 8 8P  U  
(5< 0p   0 f o<H$4     0    Q  \  
$4 0   0  S  RP P    z   _3 0   Uu3\ 0   Kkd3   0  AdH3   0  .],38#  3     0   S  Rp p  
  X  
0`0 40 8 *80  S  
#< p   = 0 0 9 PP  
< 0 80   P>  
,   H 8D"2     0 `   Q  V'  
"2  00`    0  40 8<  P
  00B|@  l  `  T  H  <<b  048 <0<0` ( 0P80 <0  0 80  P
              10 |   h  \  P  D  C%    &   `  `        @  % Pl% H  $ $ B  l  $   #    # pT       <! d          t  (    l    Ld   4       P       `       \  @ 
  	  `  t	  d	  T	  	  	   x	    x	    
      d L	  P  l  L  <  G- pH`HP`P`FFa @@0	  3/ V  /@-  0123456789abcdefABCDEF  Can use mutexes only with MUTEX_LOCKING or NOLOCK
  key %d bytes:   [%03X]  %02X        key %d bytes
   
key %d bytes
  
data %d bytes
 Could not create %s: %s
    Could not open %s: %s
  system() call failed
   database not open   
tdbtool: 
  create    dbname     : create a database
  open      dbname     : open an existing database
  transaction_start    : start a transaction
  transaction_commit   : commit a transaction
  transaction_cancel   : cancel a transaction
  erase                : erase the database
  dump                 : dump the database as strings
  keys                 : dump the database keys as strings
  hexkeys              : dump the database keys as hex values
  info                 : print summary info about the database
  insert    key  data  : insert a record
  move      key  file  : move a record to a destination tdb
  store     key  data  : store a record (replace)
  show      key        : show a record by key
  delete    key        : delete a record by key
  list                 : print the database hash table and freelist
  free                 : print the database freelist
  freelist_size        : print the number of records in the freelist
  check                : check the integrity of an opened database
  repack               : repack the database
  speed                : perform speed tests on the database
  ! command            : execute system command
  1 | first            : print the first record
  n | next             : print the next record
  q | quit             : terminate
  \n                   : repeat 'next' command
   need key    insert failed   need destination tdb name   fetch failed    unable to open destination tdb  failed to move record   record moved    need data   Storing key:    store failed    delete failed   Error getting freelist size.    freelist size: %d
  Error = %s
 %s  Testing store speed for %u seconds
 store test  %10.3f ops/sec
 Testing fetch speed for %u seconds
 Testing transaction speed for %u seconds
   transaction test    Testing traverse speed for %u seconds
  mmap is disabled    mmap is enabled Integrity check for the opened database failed. Database integrity is OK and has %d records.
   open    tdb>    create  transaction_start   transaction_commit  transaction_cancel  erase   dump    insert  move    store   show    keys    hexkeys delete  list    free    freelist_size   info    speed   mmap    first   1   next    check   quit    q   !   repack                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ,               l                )     =          =       o            
                     >    P                
                    o  o	  o   o	  o-                                           =                                                                                             )  @         E E     E  E     $E     4)  (E 0E 4E                E     @ d2      T2     l2     2     2     2     2     2     2     2  	   2  
   2     2     2     2     2      3     3     3      3     (3     03     43     *     <3     D3     L3     P3     T3            A.   aeabi $   6 	
"c21115fbab59ff1995c265f1b4a7b70f823841.debug    vD .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .ARM.exidx .eh_frame .init_array .fini_array .jcr .dynamic .got .data .bss .ARM.attributes .gnu_debuglink                                                   T  T                             p  p                     !             $                  4   o       `                >                            F                              N   o   	  	                  [   o   	  	  p                j   	      
  
                 s   	   B       P              |                               w                                            x                          )  )                             )  )  	                      p   \3  \3                            d3  d3                             = =                            = =                            = =                             = =                          > >                            @  @                             @ @  H                      p        @  /                                'A  4                                [A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \zni(n"Zu8=T\Lh 7y}}}=qe(Nbs? U<'gl3Yy*@r)hk'BR^WWIDb15_
IxH$MU<bqC>iXh,Z%&YE^Hg\$	!uCfM'Uv-YI)R/XkJ`bc8~&7WqLT9<l#ETI>|F?_Y_dKV$IF4<<UOH2Y*xUP&&h_BFbqXr,|Mj!2G3A%_XmfhQg1/cI@t,'g`Zb2A:VHm{>\^]^7z~h=>21?tEYS#16Pii-bS7&#)yAZd%MCR =Oi2-IcrVyy9&o1#'[?$;8"Cei<JO&fgGo7 H"RW )7	{Gny'XRIEu9b^iAy~__V9q(yUF/N`\f_)%TqH^Zvt1I <m"YB?W)C```~d?^QP=*3uB7FY
I"$zgfco^IK9^6Z"`NwO_&*3CR'|\U%$*3qW@0exjTRoeu];+/D&x0+mo/n+P)FA1K-T3	dj}>A~+9Ha6;;Id2OF~Dtdy 
X_hzw:.~\dI 9S+Xy[b.8=_rEWEQ-Bn1 ^$ NxU?:ek4(4w@Z,x9a;D
!" X7Bp~A-6>]lTYXE6SF,QPc (ECQ:OAU*Q+%/0<^VK_t16N:7GZj@9380oA\.+ .+;70%t&[cXCOz*L\jUFWC(UDUQ<^SY(z3C,9X9xQb.cL#HCl n($Wb!i]#gp'H+d48=I*M!\6qQd4llPn4qCXq
\&I!j>M\QE+sz?sbm,K+SmR ,C
>XAGnHNGe*Kk^V*S	f@Lw?DJ vMh~q=aqsC*SV%icP
[#
`93g:l Daz#MmJ@Q"2>VZU]!'`sWDFeRT_T TUI-]#}?HWLB$L"k tq`i46,ve=#'.+#lhBU%rVa,ZA%lB{Z#-M>`CD6}O:b
;H$0}eH"RrC"0,RX&aOy~V0 k34dB[zUP-gHksn4k^8;v^f'_3HDu(Gtzt; "#?2pMT~"r5 @r]jIO^	w_^x+ww
+xeZk=uGl5eMzCaRU'*Q\7`Haj)a%iL*pz*BzZ8UbJPi
Vbz]$DJP_	x]Q,&:T0-ZFg?.wUJ`%;MW(!3bhEIN+5ilH[\ ZUT$pWGG*Dm!jt,Udv73m7XJUs}:r r}M~gfgHHLY)tOv 	t7?n
=?Oo2Iar[qOnuG	d9uW<9hD/ug7*y3hQHTk z.u6|38j4`k'cA#*<:'q+ i:-7:88UnL`
x,),bgYsqO,hZ/{0uDS)vbc5Bv;r'-q,F%|5_<`U@
46AcmlV=-P{nB`APc9[&viYL3'@J|p%tJ}>>K{ibq:MFrlNJ~<f/	H=wo8	m()hZ$^Q'80j[|2czx9yhxW8%$*C QC\i]	_R!EkC}!S=H( {KA2d{M3Y"$oPE}=;/J:P@]w{HwHM22}p|9_`pTX6(@(CwfREdCg_&}{> ^@d/,$H-^=6gIn'tCz?>V4dx>u=@%	qrYL:mB652odAVb%2muRTvQ.3rZ:f1J x	<'1=4\eNk`FoyYn s/bPC#.q&&':[MUcX-\d Ej6TIIn:6|aW^|?aL&O3e
*_e4=iui[z0cO"[	c)<kfM"z(h{o_"FP"hUt:u#zV :)pB&ZN}sjBo|t;C_h!t[9>Iob37$QUEmB=ZM}%Ts45qff.S|DskII>pBN^-B)bffC\|TP0u;*)0%I![)U
[jfRH> MZ70&%88y,,i6lG-TOd""~p qaDsuUe	!t
plLD* A<<R%Q3\KO73p^ScbE@\<]34,j2^S\5@D`E%*E~`IMnOk#,=1[c..
2O}fbW'NMq@'8CY/"v5[ 8[T/f#@k`3k>JU{s{)*Ej,Po+kku*r @TEf C+89[@,2ds)\HeV=GukMv;A^3:ay,ytqyY0(\MjQ/! U`NH'j3kA3 Xg%)e$d$67#ZP#h98QqJ{/c@m3(P66]b<s	 _`;/rnE4TesC659nS}1<{0(ky;j$'>]v4:NM^wLiTZt5\zE|`W EW[bOJWd^w>1nF&skJa-Y(L[X=pZ0GsX)o( 56`Q{{X<V/1Yca3V0lmZ<$S+^qLd[q%E69r ^)yXhk/k@
+S}4&M?F:h$;#N\yg@!Fe66e&eT8n`&Mw;*ac$[@ec~ "F)L0cXfBBijGFoGFu86Ft;pc{DRDo=] )5#[
gmq>@E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Format: http://www.debian.org/doc/packaging-manuals/copyright-format/1.0/
Upstream-Name: tdb
Upstream-Contact: Rusty Russell <rusty@samba.org>
Source: http://tdb.samba.org/

License: LGPL-3+
 This library is free software; you can redistribute it and/or
 modify it under the terms of the GNU Lesser General Public
 License as published by the Free Software Foundation; either
 version 3 of the License, or (at your option) any later version.
 .
 This library is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 Lesser General Public License for more details.
 .
 You should have received a copy of the GNU Lesser General Public
 License along with this library; if not, write to the Free Software
 Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA.
 .
 On Debian GNU/Linux systems, the complete text of the GNU Lesser General
 Public License can be found in `/usr/share/common-licenses/LGPL-3'.

Files: *
Copyright:
  1999-2005 Andrew Tridgell <tridge@samba.org>
  2000-2012 Rusty Russell <rusty@samba.org>
  2000-2003 Jeremy Allison <jra@samba.org>
  2012-2013 Volker Lendecke <vl@samba.org>
  2013-2014 Stefan Metzmacher <metze@samba.org>
  2014 Michael Adam <obnox@samba.org>
License: LGPL-3+

Files: debian/*
Copyright:
  2001-2005 Marek Habersack <grendel@debian.org> on
  2007-2012 Jelmer Vernooij <jelmer@samba.org>
License: LGPL-3+

Files: lib/replace/*.c
Copyright:
  Copyright (c) Andrew Tridgell                1999-2006
  Copyright (c) Jeremy Allison	               2000-2003,2007
  Copyright (c) PostgreSQL Global Development Group 1996-2007
  Copyright (c) The Regents of the University of California 1994
  Copyright (c) Michael Adam <obnox@samba.org> 2008
  Copyright (c) Patrick Powell                 1995
  Copyright (c) Free Software Foundation, Inc. 1991-2001
  Copyright (c) Jelmer Vernooij                2006-2009
License: LGPL-3+

Files: lib/replace/inet_ntop.c lib/replace/inet_pton.c
Copyright: Internet Software Consortium. 1996-2001
License: ISC
 Permission to use, copy, modify, and distribute this software for any
 purpose with or without fee is hereby granted, provided that the above
 copyright notice and this permission notice appear in all copies.
 .
 THE SOFTWARE IS PROVIDED "AS IS" AND INTERNET SOFTWARE CONSORTIUM
 DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL
 IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL
 INTERNET SOFTWARE CONSORTIUM BE LIABLE FOR ANY SPECIAL, DIRECT,
 INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING
 FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,
 NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION
 WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

Files: common/*.c
Copyright:
  Copyright (c) Andrew Tridgell                1999-2006
  Copyright (c) Paul `Rusty' Russell           2000
  Copyright (c) Jeremy Allison	               2000-2003,2007
License: LGPL-3+

Files: tools/*.c
Copyright:
  Copyright (c) Andrew Tridgell                1999-2006
  Copyright (c) Paul `Rusty' Russell           2000
  Copyright (c) Jeremy Allison	               2000-2003,2007
  Copyright (c) Andrew Esh                     2001
License: GPL-3+
 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 3 of the License, or
 (at your option) any later version.
 .
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 .
 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
 Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
 .
 On Debian systems, the full text of the GPL v3 can be found in
 /usr/share/common-licenses/GPL-3

Files: pytdb.c
Copyright:
  Copyright (c) Tim Potter <tpot@samba.org>    2004-2006
  Copyright (c) Jelmer Vernooij                2006-2008
License: LGPL-3+

Files: lib/replace/timegm.c
Copyright:
  Copyright (c) Kungliga Tekniska Hgskolan    1997
License: BSD-3
 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions
 are met:
 .
 1. Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.
 .
 2. Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the
    documentation and/or other materials provided with the distribution.
 .
 3. Neither the name of the Institute nor the names of its contributors
    may be used to endorse or promote products derived from this software
    without specific prior written permission.
 .
 THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND
 ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE
 FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 SUCH DAMAGE.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Wn7}WLP;i\( jI)ZdjPJ{\]'OKX.9srVw~|>c=_?)uR/%u/=r2wa+id%<5JKWJ-/#~~n6`_Hu.g'7BhQ7)_ ov#[Wl"$y\3zf+y/io|qv=v~O? l?&O
V,LV^LV~EEWTvRO]&HwR-d3V(q{N$gTIJA2$wDJ^B:)V32t+'&ZRl%C*T@@^~%-O3QM!kQ+9MMOhGtCMo2J79K<aY<,-VzSi,{PPbWp;.l0-)/mzRr-{h7:^}mK"~|E \p-/yEI9`]J]K4r>0-4z
R 2$\tDRi+pA<3=I,d8Wj)DF,xkvq.] Fl&sqDqM!KQrs)D6\5

2r.EV6{2r2"KD8LR8:lUs>eB;]	4
7@wL[+jmVms.\zp#!G|9qFPB"jQIwtX"9Xk\<[.q'yOY:eXTYy^GIwXoqtm0ros	{P8JdAC^dG#.4
EU~ED,qjJ>s2;1^bvw8JPr&a!v]F%bezhv%Kik $. bZ =*q4n,vra&Q2vd(;m>`RO4eOxQ+=Mt|H4w7naHDP`vUu;$^pNsUA(eO60xY<a2q<*j7 pmH~i5F6TGo8;Tk8|<:Y(a5s@Tld61q+CQkB!nq) K(BjQ4bF 1f85SZqgWFnc|=q<[%w	L0~K`<H pC}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               VQo6~8aqZv&YaS6,PNTH*1l}GJN}X}wQtwWk:kz<nl5|3`KK|X`jJ:Joz?;V)Cx
a5&%YJltz1]vlhk,V0*. 0;H5:%Ukeqd6n9[ezO(zBo^?q?{y`%QBek.M0??{y0akdt1]]^&,dNKVbXh`t6L1NCwL9B"aaf`I=!V{s!2nZ D{l9O[Yw)[.%8Y4gsyQ<^NWS89T:y>nA2hZs,Ur`@9BDhQ;.!%M`o%|[*^>_FL2-d6S./2nd80H;%#4 xUS[2IL/	73xiq
1Tc	ATL&,"kP)f!R;(\1j2|-!YwIfjH#v4nrVYnAydtOx2Nu	UO%<AjY>}ciGOTGWJ%'aQHC\ SuS\BP9fBP%Yy/"]kJ5ctkJ:,yX wNotpKB4Z:c):nR[^oa,3 if
NUT
Uo)(j
	$8=PpA!nw\6NZW7Q-hnI.(*P_jZn	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            VMo6W|h dt1 ,5hQ@I#TH^h{i- vD7f8Y=fFcngR; -_S[5AJo3v'f~&Sim}7e*M.0y ~<0K\'u3gaX4/V)a:P5:%U	xfhXA3YnJGGY->?S 1E@{}O5\\"U!J[pmL|QM&@bt=: 	
}opTJ
|t9/G)*p{#rdo[/@_zvBaa!WbrY"%%J@}n9Ov-/@`nb^2'a>}Z"-":
qhB:|C8jdN{`@rNi|B-}\O!8?`:~W.YHi=-Z62QuhML{ixL=eAMcW5vJY//~JZ424p&4f7 "#BH,)AU;SUULf]tSK&LgDNWe$CrAI_S&!!Yu{ZfmjI*2[V$*zTNUH{*Qs:Xv]]l|[r4n*(YCI9ARrR"Z.-.vlYe^QK]mCeB|He93W$]]H0
gM+Z/PQ<r(:"-96(s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Wn8}WLIFv6X,,oE]4HCRv3_	-s3MXOSuZ.>YDpB|8jI>B#Tk7-s0?
IhJ
];C+r>z}~uxzs)T)aJZGz`hKH(WA*-EJ=fwOE+	f[oz=(TV3m\%XW&jW?i *&mn}	
AJ/L92W$ive{OeD  iW[=EZtc"AM!*}Bb#dYlkkiLdTu_ o0TU<h"Ipl8c8JMH<\RrVTU|r"QC"@Ur*W0YMe&W6Vx>M0IEZKgs+#l1{&rY"-C*P^hNQ\,| T"wha+.*xs)rTX<bF'63%g70\/ ~E%=32.kQ3GXF!"gf"%z%Z|2^3):_?`WDy(-3P})[L (dM}W}L@::j!m%?d'%vxW_ Y"C.^yC6Ua[D%"c3.+Q`:Be9dxK[x.GJcPwX;rqYb]zW
>; #(gT5Hx!X|&exX K*k+Rv.C.Ej
}u;ZO"vUaJ^9~.;1?84O\	JQ9!L/4`i}Enr~'\wo0ef814{m<^@j#o1*RP`Hsw~qWh&e]oX~r	S&6F..oswfn\`r >wohzt3vc|uj>PN3#V,f9YBQo42nrv|9xA?EntKtU~9j^m+sC/wi#i >`o^o2=z;S
(`+2OQHsOx#p(
.o,O_!+BTRFc+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /.
/usr
/usr/bin
/usr/bin/tdbbackup.tdbtools
/usr/bin/tdbdump
/usr/bin/tdbrestore
/usr/bin/tdbtool
/usr/share
/usr/share/doc
/usr/share/doc/tdb-tools
/usr/share/doc/tdb-tools/changelog.Debian.gz
/usr/share/doc/tdb-tools/copyright
/usr/share/man
/usr/share/man/man8
/usr/share/man/man8/tdbbackup.tdbtools.8.gz
/usr/share/man/man8/tdbdump.8.gz
/usr/share/man/man8/tdbrestore.8.gz
/usr/share/man/man8/tdbtool.8.gz
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     22e58aa600147b6a84f6c9b240b95d1f  usr/share/perl5/File/Copy/Recursive.pm
2d6fac0032b61fee6fe2feb790c3136f  usr/share/man/man3/File::Copy::Recursive.3pm.gz
7cd2be79ef832725ebf667896f6c174c  usr/share/doc/libfile-copy-recursive-perl/copyright
c8fafd378d668bc909cb707fb7b5060c  usr/share/doc/libfile-copy-recursive-perl/changelog.gz
2a65ef7999b8403b59e7d125d06a1679  usr/share/doc/libfile-copy-recursive-perl/changelog.Debian.gz
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      package File::Copy::Recursive;

use strict;
BEGIN {
    # Keep older versions of Perl from trying to use lexical warnings
    $INC{'warnings.pm'} = "fake warnings entry for < 5.6 perl ($])" if $] < 5.006;
}
use warnings;

use Carp;
use File::Copy; 
use File::Spec; #not really needed because File::Copy already gets it, but for good measure :)

use vars qw( 
    @ISA      @EXPORT_OK $VERSION  $MaxDepth $KeepMode $CPRFComp $CopyLink 
    $PFSCheck $RemvBase $NoFtlPth  $ForcePth $CopyLoop $RMTrgFil $RMTrgDir 
    $CondCopy $BdTrgWrn $SkipFlop  $DirPerms
);

require Exporter;
@ISA = qw(Exporter);
@EXPORT_OK = qw(fcopy rcopy dircopy fmove rmove dirmove pathmk pathrm pathempty pathrmdir);
$VERSION = '0.38';

$MaxDepth = 0;
$KeepMode = 1;
$CPRFComp = 0; 
$CopyLink = eval { local $SIG{'__DIE__'};symlink '',''; 1 } || 0;
$PFSCheck = 1;
$RemvBase = 0;
$NoFtlPth = 0;
$ForcePth = 0;
$CopyLoop = 0;
$RMTrgFil = 0;
$RMTrgDir = 0;
$CondCopy = {};
$BdTrgWrn = 0;
$SkipFlop = 0;
$DirPerms = 0777; 

my $samecheck = sub {
   return 1 if $^O eq 'MSWin32'; # need better way to check for this on winders...
   return if @_ != 2 || !defined $_[0] || !defined $_[1];
   return if $_[0] eq $_[1];

   my $one = '';
   if($PFSCheck) {
      $one    = join( '-', ( stat $_[0] )[0,1] ) || '';
      my $two = join( '-', ( stat $_[1] )[0,1] ) || '';
      if ( $one eq $two && $one ) {
          carp "$_[0] and $_[1] are identical";
          return;
      }
   }

   if(-d $_[0] && !$CopyLoop) {
      $one    = join( '-', ( stat $_[0] )[0,1] ) if !$one;
      my $abs = File::Spec->rel2abs($_[1]);
      my @pth = File::Spec->splitdir( $abs );
      while(@pth) {
         my $cur = File::Spec->catdir(@pth);
         last if !$cur; # probably not necessary, but nice to have just in case :)
         my $two = join( '-', ( stat $cur )[0,1] ) || '';
         if ( $one eq $two && $one ) {
             # $! = 62; # Too many levels of symbolic links
             carp "Caught Deep Recursion Condition: $_[0] contains $_[1]";
             return;
         }
      
         pop @pth;
      }
   }

   return 1;
};

my $glob = sub {
    my ($do, $src_glob, @args) = @_;
    
    local $CPRFComp = 1;
    
    my @rt;
    for my $path ( glob($src_glob) ) {
        my @call = [$do->($path, @args)] or return;
        push @rt, \@call;
    }
    
    return @rt;
};

my $move = sub {
   my $fl = shift;
   my @x;
   if($fl) {
      @x = fcopy(@_) or return;
   } else {
      @x = dircopy(@_) or return;
   }
   if(@x) {
      if($fl) {
         unlink $_[0] or return;
      } else {
         pathrmdir($_[0]) or return;
      }
      if($RemvBase) {
         my ($volm, $path) = File::Spec->splitpath($_[0]);
         pathrm(File::Spec->catpath($volm,$path,''), $ForcePth, $NoFtlPth) or return;
      }
   }
  return wantarray ? @x : $x[0];
};

my $ok_todo_asper_condcopy = sub {
    my $org = shift;
    my $copy = 1;
    if(exists $CondCopy->{$org}) {
        if($CondCopy->{$org}{'md5'}) {

        }
        if($copy) {

        }
    }
    return $copy;
};

sub fcopy { 
   $samecheck->(@_) or return;
   if($RMTrgFil && (-d $_[1] || -e $_[1]) ) {
      my $trg = $_[1];
      if( -d $trg ) {
        my @trgx = File::Spec->splitpath( $_[0] );
        $trg = File::Spec->catfile( $_[1], $trgx[ $#trgx ] );
      }
      $samecheck->($_[0], $trg) or return;
      if(-e $trg) {
         if($RMTrgFil == 1) {
            unlink $trg or carp "\$RMTrgFil failed: $!";
         } else {
            unlink $trg or return;
         }
      }
   }
   my ($volm, $path) = File::Spec->splitpath($_[1]);
   if($path && !-d $path) {
      pathmk(File::Spec->catpath($volm,$path,''), $NoFtlPth);
   }
   if( -l $_[0] && $CopyLink ) {
      carp "Copying a symlink ($_[0]) whose target does not exist" 
          if !-e readlink($_[0]) && $BdTrgWrn;
      symlink readlink(shift()), shift() or return;
   } else {  
      copy(@_) or return;

      my @base_file = File::Spec->splitpath($_[0]);
      my $mode_trg = -d $_[1] ? File::Spec->catfile($_[1], $base_file[ $#base_file ]) : $_[1];

      chmod scalar((stat($_[0]))[2]), $mode_trg if $KeepMode;
   }
   return wantarray ? (1,0,0) : 1; # use 0's incase they do math on them and in case rcopy() is called in list context = no uninit val warnings
}

sub rcopy { 
    if (-l $_[0] && $CopyLink) {
        goto &fcopy;    
    }
    
    goto &dircopy if -d $_[0] || substr( $_[0], ( 1 * -1), 1) eq '*';
    goto &fcopy;
}

sub rcopy_glob {
    $glob->(\&rcopy, @_);
}

sub dircopy {
   if($RMTrgDir && -d $_[1]) {
      if($RMTrgDir == 1) {
         pathrmdir($_[1]) or carp "\$RMTrgDir failed: $!";
      } else {
         pathrmdir($_[1]) or return;
      }
   }
   my $globstar = 0;
   my $_zero = $_[0];
   my $_one = $_[1];
   if ( substr( $_zero, ( 1 * -1 ), 1 ) eq '*') {
       $globstar = 1;
       $_zero = substr( $_zero, 0, ( length( $_zero ) - 1 ) );
   }

   $samecheck->(  $_zero, $_[1] ) or return;
   if ( !-d $_zero || ( -e $_[1] && !-d $_[1] ) ) {
       $! = 20; 
       return;
   } 

   if(!-d $_[1]) {
      pathmk($_[1], $NoFtlPth) or return;
   } else {
      if($CPRFComp && !$globstar) {
         my @parts = File::Spec->splitdir($_zero);
         while($parts[ $#parts ] eq '') { pop @parts; }
         $_one = File::Spec->catdir($_[1], $parts[$#parts]);
      }
   }
   my $baseend = $_one;
   my $level   = 0;
   my $filen   = 0;
   my $dirn    = 0;

   my $recurs; #must be my()ed before sub {} since it calls itself
   $recurs =  sub {
      my ($str,$end,$buf) = @_;
      $filen++ if $end eq $baseend; 
      $dirn++ if $end eq $baseend;
      
      $DirPerms = oct($DirPerms) if substr($DirPerms,0,1) eq '0';
      mkdir($end,$DirPerms) or return if !-d $end;
      chmod scalar((stat($str))[2]), $end if $KeepMode;
      if($MaxDepth && $MaxDepth =~ m/^\d+$/ && $level >= $MaxDepth) {
         return ($filen,$dirn,$level) if wantarray;
         return $filen;
      }
      $level++;

      
      my @files;
      if ( $] < 5.006 ) {
          opendir(STR_DH, $str) or return;
          @files = grep( $_ ne '.' && $_ ne '..', readdir(STR_DH));
          closedir STR_DH;
      }
      else {
          opendir(my $str_dh, $str) or return;
          @files = grep( $_ ne '.' && $_ ne '..', readdir($str_dh));
          closedir $str_dh;
      }

      for my $file (@files) {
          my ($file_ut) = $file =~ m{ (.*) }xms;
          my $org = File::Spec->catfile($str, $file_ut);
          my $new = File::Spec->catfile($end, $file_ut);
          if( -l $org && $CopyLink ) {
              carp "Copying a symlink ($org) whose target does not exist" 
                  if !-e readlink($org) && $BdTrgWrn;
              symlink readlink($org), $new or return;
          } 
          elsif(-d $org) {
              $recurs->($org,$new,$buf) if defined $buf;
              $recurs->($org,$new) if !defined $buf;
              $filen++;
              $dirn++;
          } 
          else {
              if($ok_todo_asper_condcopy->($org)) {
                  if($SkipFlop) {
                      fcopy($org,$new,$buf) or next if defined $buf;
                      fcopy($org,$new) or next if !defined $buf;                      
                  }
                  else {
                      fcopy($org,$new,$buf) or return if defined $buf;
                      fcopy($org,$new) or return if !defined $buf;
                  }
                  chmod scalar((stat($org))[2]), $new if $KeepMode;
                  $filen++;
              }
          }
      }
      1;
   };

   $recurs->($_zero, $_one, $_[2]) or return;
   return wantarray ? ($filen,$dirn,$level) : $filen;
}

sub fmove { $move->(1, @_) } 

sub rmove { 
    if (-l $_[0] && $CopyLink) {
        goto &fmove;    
    }
    
    goto &dirmove if -d $_[0] || substr( $_[0], ( 1 * -1), 1) eq '*';
    goto &fmove;
}

sub rmove_glob {
    $glob->(\&rmove, @_);
}

sub dirmove { $move->(0, @_) }

sub pathmk {
   my @parts = File::Spec->splitdir( shift() );
   my $nofatal = shift;
   my $pth = $parts[0];
   my $zer = 0;
   if(!$pth) {
      $pth = File::Spec->catdir($parts[0],$parts[1]);
      $zer = 1;
   }
   for($zer..$#parts) {
      $DirPerms = oct($DirPerms) if substr($DirPerms,0,1) eq '0';
      mkdir($pth,$DirPerms) or return if !-d $pth && !$nofatal;
      mkdir($pth,$DirPerms) if !-d $pth && $nofatal;
      $pth = File::Spec->catdir($pth, $parts[$_ + 1]) unless $_ == $#parts;
   }
   1;
} 

sub pathempty {
   my $pth = shift; 

   return 2 if !-d $pth;

   my @names;
   my $pth_dh;
   if ( $] < 5.006 ) {
       opendir(PTH_DH, $pth) or return;
       @names = grep !/^\.+$/, readdir(PTH_DH);
   }
   else {
       opendir($pth_dh, $pth) or return;
       @names = grep !/^\.+$/, readdir($pth_dh);       
   }
   
   for my $name (@names) {
      my ($name_ut) = $name =~ m{ (.*) }xms;
      my $flpth     = File::Spec->catdir($pth, $name_ut);

      if( -l $flpth ) {
	      unlink $flpth or return; 
      }
      elsif(-d $flpth) {
          pathrmdir($flpth) or return;
      } 
      else {
          unlink $flpth or return;
      }
   }

   if ( $] < 5.006 ) {
       closedir PTH_DH;
   }
   else {
       closedir $pth_dh;
   }
   
   1;
}

sub pathrm {
   my $path = shift;
   return 2 if !-d $path;
   my @pth = File::Spec->splitdir( $path );
   my $force = shift;

   while(@pth) { 
      my $cur = File::Spec->catdir(@pth);
      last if !$cur; # necessary ??? 
      if(!shift()) {
         pathempty($cur) or return if $force;
         rmdir $cur or return;
      } 
      else {
         pathempty($cur) if $force;
         rmdir $cur;
      }
      pop @pth;
   }
   1;
}

sub pathrmdir {
    my $dir = shift;
    if( -e $dir ) {
        return if !-d $dir;
    }
    else {
        return 2;
    }

    pathempty($dir) or return;
    
    rmdir $dir or return;
}

1;

__END__

=head1 NAME

File::Copy::Recursive - Perl extension for recursively copying files and directories

=head1 SYNOPSIS

  use File::Copy::Recursive qw(fcopy rcopy dircopy fmove rmove dirmove);

  fcopy($orig,$new[,$buf]) or die $!;
  rcopy($orig,$new[,$buf]) or die $!;
  dircopy($orig,$new[,$buf]) or die $!;

  fmove($orig,$new[,$buf]) or die $!;
  rmove($orig,$new[,$buf]) or die $!;
  dirmove($orig,$new[,$buf]) or die $!;
  
  rcopy_glob("orig/stuff-*", $trg [, $buf]) or die $!;
  rmove_glob("orig/stuff-*", $trg [,$buf]) or die $!;

=head1 DESCRIPTION

This module copies and moves directories recursively (or single files, well... singley) to an optional depth and attempts to preserve each file or directory's mode.

=head1 EXPORT

None by default. But you can export all the functions as in the example above and the path* functions if you wish.

=head2 fcopy()

This function uses File::Copy's copy() function to copy a file but not a directory. Any directories are recursively created if need be.
One difference to File::Copy::copy() is that fcopy attempts to preserve the mode (see Preserving Mode below)
The optional $buf in the synopsis if the same as File::Copy::copy()'s 3rd argument
returns the same as File::Copy::copy() in scalar context and 1,0,0 in list context to accomidate rcopy()'s list context on regular files. (See below for more info)

=head2 dircopy()

This function recursively traverses the $orig directory's structure and recursively copies it to the $new directory.
$new is created if necessary (multiple non existant directories is ok (IE foo/bar/baz). The script logically and portably creates all of them if necessary).
It attempts to preserve the mode (see Preserving Mode below) and 
by default it copies all the way down into the directory, (see Managing Depth) below.
If a directory is not specified it croaks just like fcopy croaks if its not a file that is specified.

returns true or false, for true in scalar context it returns the number of files and directories copied,
In list context it returns the number of files and directories, number of directories only, depth level traversed.

  my $num_of_files_and_dirs = dircopy($orig,$new);
  my($num_of_files_and_dirs,$num_of_dirs,$depth_traversed) = dircopy($orig,$new);
  
Normally it stops and return's if a copy fails, to continue on regardless set $File::Copy::Recursive::SkipFlop to true.

    local $File::Copy::Recursive::SkipFlop = 1;

That way it will copy everythgingit can ina directory and won't stop because of permissions, etc...

=head2 rcopy()

This function will allow you to specify a file *or* directory. It calls fcopy() if its a file and dircopy() if its a directory.
If you call rcopy() (or fcopy() for that matter) on a file in list context, the values will be 1,0,0 since no directories and no depth are used. 
This is important becasue if its a directory in list context and there is only the initial directory the return value is 1,1,1.

=head2 rcopy_glob()

This function lets you specify a pattern suitable for perl's glob() as the first argument. Subsequently each path returned by perl's glob() gets rcopy()ied.

It returns and array whose items are array refs that contain the return value of each rcopy() call.

It forces behavior as if $File::Copy::Recursive::CPRFComp is true.

=head2 fmove()

Copies the file then removes the original. You can manage the path the original file is in according to $RemvBase.

=head2 dirmove()

Uses dircopy() to copy the directory then removes the original. You can manage the path the original directory is in according to $RemvBase.

=head2 rmove()

Like rcopy() but calls fmove() or dirmove() instead.

=head2 rmove_glob()

Like rcopy_glob() but calls rmove() instead of rcopy()

=head3 $RemvBase

Default is false. When set to true the *move() functions will not only attempt to remove the original file or directory but will remove the given path it is in.

So if you:

   rmove('foo/bar/baz', '/etc/');
   # "baz" is removed from foo/bar after it is successfully copied to /etc/
   
   local $File::Copy::Recursive::Remvbase = 1;
   rmove('foo/bar/baz','/etc/');
   # if baz is successfully copied to /etc/ :
   # first "baz" is removed from foo/bar
   # then "foo/bar is removed via pathrm()

=head4 $ForcePth

Default is false. When set to true it calls pathempty() before any directories are removed to empty the directory so it can be rmdir()'ed when $RemvBase is in effect.

=head2 Creating and Removing Paths

=head3 $NoFtlPth

Default is false. If set to true  rmdir(), mkdir(), and pathempty() calls in pathrm() and pathmk() do not return() on failure.

If its set to true they just silently go about their business regardless. This isn't a good idea but its there if you want it.

=head3 $DirPerms

Mode to pass to any mkdir() calls. Defaults to 0777 as per umask()'s POD. Explicitly having this allows older perls to be able to use FCR and might add a bit of flexibility for you.

Any value you set it to should be suitable for oct()

=head3 Path functions

These functions exist soley because they were necessary for the move and copy functions to have the features they do and not because they are of themselves the purpose of this module. That being said, here is how they work so you can understand how the copy and move funtions work and use them by themselves if you wish.

=head4 pathrm()

Removes a given path recursively. It removes the *entire* path so be carefull!!!

Returns 2 if the given path is not a directory.

  File::Copy::Recursive::pathrm('foo/bar/baz') or die $!;
  # foo no longer exists

Same as:

  rmdir 'foo/bar/baz' or die $!;
  rmdir 'foo/bar' or die $!;
  rmdir 'foo' or die $!;

An optional second argument makes it call pathempty() before any rmdir()'s when set to true.

  File::Copy::Recursive::pathrm('foo/bar/baz', 1) or die $!;
  # foo no longer exists

Same as:PFSCheck

  File::Copy::Recursive::pathempty('foo/bar/baz') or die $!;
  rmdir 'foo/bar/baz' or die $!;
  File::Copy::Recursive::pathempty('foo/bar/') or die $!;
  rmdir 'foo/bar' or die $!;
  File::Copy::Recursive::pathempty('foo/') or die $!;
  rmdir 'foo' or die $!;

An optional third argument acts like $File::Copy::Recursive::NoFtlPth, again probably not a good idea.

=head4 pathempty()

Recursively removes the given directory's contents so it is empty. returns 2 if argument is not a directory, 1 on successfully emptying the directory.

   File::Copy::Recursive::pathempty($pth) or die $!;
   # $pth is now an empty directory

=head4 pathmk()

Creates a given path recursively. Creates foo/bar/baz even if foo does not exist.

   File::Copy::Recursive::pathmk('foo/bar/baz') or die $!;

An optional second argument if true acts just like $File::Copy::Recursive::NoFtlPth, which means you'd never get your die() if something went wrong. Again, probably a *bad* idea.

=head4 pathrmdir()

Same as rmdir() but it calls pathempty() first to recursively empty it first since rmdir can not remove a directory with contents.
Just removes the top directory the path given instead of the entire path like pathrm(). Return 2 if given argument does not exist (IE its already gone). Return false if it exists but is not a directory.

=head2 Preserving Mode

By default a quiet attempt is made to change the new file or directory to the mode of the old one.
To turn this behavior off set
  $File::Copy::Recursive::KeepMode
to false;

=head2 Managing Depth

You can set the maximum depth a directory structure is recursed by setting:
  $File::Copy::Recursive::MaxDepth 
to a whole number greater than 0.

=head2 SymLinks

If your system supports symlinks then symlinks will be copied as symlinks instead of as the target file.
Perl's symlink() is used instead of File::Copy's copy()
You can customize this behavior by setting $File::Copy::Recursive::CopyLink to a true or false value.
It is already set to true or false dending on your system's support of symlinks so you can check it with an if statement to see how it will behave:

    if($File::Copy::Recursive::CopyLink) {
        print "Symlinks will be preserved\n";
    } else {
        print "Symlinks will not be preserved because your system does not support it\n";
    }

If symlinks are being copied you can set $File::Copy::Recursive::BdTrgWrn to true to make it carp when it copies a link whose target does not exist. Its false by default.

    local $File::Copy::Recursive::BdTrgWrn  = 1;

=head2 Removing existing target file or directory before copying.

This can be done by setting $File::Copy::Recursive::RMTrgFil or $File::Copy::Recursive::RMTrgDir for file or directory behavior respectively.

0 = off (This is the default)

1 = carp() $! if removal fails

2 = return if removal fails

    local $File::Copy::Recursive::RMTrgFil = 1;
    fcopy($orig, $target) or die $!;
    # if it fails it does warn() and keeps going

    local $File::Copy::Recursive::RMTrgDir = 2;
    dircopy($orig, $target) or die $!;
    # if it fails it does your "or die"

This should be unnecessary most of the time but its there if you need it :)

=head2 Turning off stat() check

By default the files or directories are checked to see if they are the same (IE linked, or two paths (absolute/relative or different relative paths) to the same file) by comparing the file's stat() info. 
It's a very efficient check that croaks if they are and shouldn't be turned off but if you must for some weird reason just set $File::Copy::Recursive::PFSCheck to a false value. ("PFS" stands for "Physical File System")

=head2 Emulating cp -rf dir1/ dir2/

By default dircopy($dir1,$dir2) will put $dir1's contents right into $dir2 whether $dir2 exists or not.

You can make dircopy() emulate cp -rf by setting $File::Copy::Recursive::CPRFComp to true.

NOTE: This only emulates -f in the sense that it does not prompt. It does not remove the target file or directory if it exists.
If you need to do that then use the variables $RMTrgFil and $RMTrgDir described in "Removing existing target file or directory before copying" above.

That means that if $dir2 exists it puts the contents into $dir2/$dir1 instead of $dir2 just like cp -rf.
If $dir2 does not exist then the contents go into $dir2 like normal (also like cp -rf)

So assuming 'foo/file':

    dircopy('foo', 'bar') or die $!;
    # if bar does not exist the result is bar/file
    # if bar does exist the result is bar/file

    $File::Copy::Recursive::CPRFComp = 1;
    dircopy('foo', 'bar') or die $!;
    # if bar does not exist the result is bar/file
    # if bar does exist the result is bar/foo/file

You can also specify a star for cp -rf glob type behavior:

    dircopy('foo/*', 'bar') or die $!;
    # if bar does not exist the result is bar/file
    # if bar does exist the result is bar/file

    $File::Copy::Recursive::CPRFComp = 1;
    dircopy('foo/*', 'bar') or die $!;
    # if bar does not exist the result is bar/file
    # if bar does exist the result is bar/file

NOTE: The '*' is only like cp -rf foo/* and *DOES NOT EXPAND PARTIAL DIRECTORY NAMES LIKE YOUR SHELL DOES* (IE not like cp -rf fo* to copy foo/*)

=head2 Allowing Copy Loops

If you want to allow:

  cp -rf . foo/

type behavior set $File::Copy::Recursive::CopyLoop to true.

This is false by default so that a check is done to see if the source directory will contain the target directory and croaks to avoid this problem.

If you ever find a situation where $CopyLoop = 1 is desirable let me know (IE its a bad bad idea but is there if you want it)

(Note: On Windows this was necessary since it uses stat() to detemine samedness and stat() is essencially useless for this on Windows. 
The test is now simply skipped on Windows but I'd rather have an actual reliable check if anyone in Microsoft land would care to share)

=head1 SEE ALSO

L<File::Copy> L<File::Spec>

=head1 TO DO

I am currently working on and reviewing some other modules to use in the new interface so we can lose the horrid globals as well as some other undesirable traits and also more easily make available some long standing requests.

Tests will be easier to do with the new interface and hence the testing focus will shift to the new interface and aim to be comprehensive.

The old interface will work, it just won't be brought in until it is used, so it will add no overhead for users of the new interface.

I'll add this after the latest verision has been out for a while with no new features or issues found :)

=head1 AUTHOR

Daniel Muey, L<http://drmuey.com/cpan_contact.pl>

=head1 COPYRIGHT AND LICENSE

Copyright 2004 by Daniel Muey

This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself. 

=cut
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    [YsF~0NH$#OR#k)mDN*8 qXD3o;4Hj$S$}>{7IKy?s`tS7(_8g}c?L8O;5sSO%viwj(VLwUgZj5svL+g4"%yzOva}GFS@r1q:~Dsj2yi,:-K.!M$*Ck,S7ZG"qAVI;S?&=A]7&"d]l'wZ;Wz3 /.CiEsr_-L!:A*g4Mvra<in3|S=S1nJpo\?\<_-J8_6.,|=KIgmeFM{'^?iOc$;akTH
M5!"MyADDw;}PNy|	
GHMZDbxjOwKIGm!_mDv	l&Zee'my
1$vAHW,D$+g+9tP@%G=*mqD?*9D`aNS4q._v{j]Y1Ll^at *nzM!		|fqfd #I2p"Ohv0Kv#+%xfiVc!;GI$onsT}3	` ff;D/a;Oggjz\g{\C %&GH{MOwI<a'|Yrygyb=&~=Dv:b3A:'a/|l_7}-qPn6_=T}];>0b~`\/	4rXlwdMr}M`/sv<voO4Ee=l6dj!twxDc|:#|-avh30Cm&&LB<hdI=6$b8?iO#M~a3m |0,Vdc o6Z|R.C;E=V%d@>!v;En1=`P5OKXqZ\+#jRYeTv~qS}wj+#,>M<Pmp1[dh7M^
%E,
JQ.",Y$OT_dv.JW,bVIXOWkz^C4oO5bo9G&'O\-!THTB(
"o4rR5^mDy<!LT#"$28RpA[d?zHG]ebP)!ZgQ:hBJ0-" =C"x.im_38YlOtAvi9NV-Kvbdf`x8ikvB>,;sR)&w4oz#({"<}g;S <f<
iY^VO=+3Wn.tjpt9<J0
;"7?M>SqUKP:!nNUDBV-p"XWmL;&+7q d-Q/@ux/L5yxy;rs/vdhd>RUZfH,"6	N	GbrE48JB:VmrSt
FyDsh5$mRLk5Cr)2vI VsdU'BgJ>72)bjAk$$1~w u|W#P,}%5LmSi0/ Q6"`owG[O+P5B))t
p.mKY3(Zm<[C^1B5u}T^<sx:H>M/,2+$2Ubgl1L *ak,#]
SGHxU	n^	_W@]s!
ue%Jc:ltZ4O?3`FJ* F*].MC )EE8%GKUHpj>L`CD)#8V+{B`e-BYW}{LD8YcIYN~Xs]? Ga)dp|'gAh$SdB>A\k.QPq[L0mBPjhu|Js|\dSRqz2I$c~-wtCV(S2yp&fH.v[5=7(H6Qi3x%uc8J$CQ7xw&Ad<ZB1{Jz	h"B5a*-?JDU}&8Dgm@Ic+:iJ\,TM.I&iHjjF0']&wzq&e:'^%{=)'%5CD>]eYF9Fjzp3M:vthkA&\&hD.N*>^!7J J<%!$YN%;M}m
6A4HchIcck$T-^vR&^-zCD4cOdHL[4.=SaMIr$bkY)Lv;G>}djrO Ob|w^eT3 ~J^o@KAm9U|s`Xa[%/!YVe+l@}*-Sn[kq!5QS11*h$h*g1cTCp=Cm+k}Ko	r$[|MzxGy	VG6|=;W^,So8PIJ
s  4(B6^'P9B6O7Pc;<%m.E\uLkEX2;[`ru@=:?QB 6F^}|>p/PseCjJ/HH$"
4$DO-"@,o(m9ej*X
4,YX-!(3+E\H[H2&["L"A$E9?{!y !8NTgNsLKxAXEW)LrCHYDgv.KH^rWffu3"_|aJ=(v6zkXh6:_"Ll)XuV(LRsduinAVq8I\ zv].w ycTt*,F1
epSVejEhpkR;qy.a3SY*7}
)]!!T}G2^(2R8bcvzUj[s9Rz4#fZV[~{C@BXw?[=C<)^2[WmA\K{K_ujntCo	<[dD+.yk}U2*E$BS]BY?m[h6{BMVw[9Cv&(b|GHK=Vp"mjicU
_WOndI^n9S$>2EXp>Xp#[uJj\mQm>^v8XaK/oH<GF
U.:Aut{:0{7^zK[H>U2$MNA`!l.kMsT:;lVTg}k*yMi@-{v<*OL*{$SK8^9J@V%2CN&I|hN;vOkQ&fQSs;1U2/I} hnhyMt2U[ipyzjUYgVJyWPJg4ne{Lu%LYRsdaw-Sefz:<c,IS!#>1.jZJbn9G`q7<sAvu?-Oe*_|HrptK.fq4qFg<q@Rql~lf+b!@vK;C\S(7D	xMsK&q.U=02z~w.847.i3jmn=_&3\<l%+<]ATuJ&|s;z?QgZ2a 3ae&f\)GQpja+rZX">/"vgaMFiK10#QKg>[6jU9rlo-'y|Xe|M8C4:rg|WMiLmIe!AW%lcH=U,O]_{k2o\MOYhj&_W>87Ph6a>4HuDe*+"RQGI=7+w.>#KN}%IEH>+GDOKQ8 ~eX$d}wIl>SVfYf9k *5YJPm<8"hKS:6fXhp9EC+x.gYsQ#*wDnZy
\WP*U:unfn&]q'ceVb>8:zsR>..GO|f\>WvY#nM|RzICUW%vqVRm9
WeE^|gw{&Q#gYE:f!_oeM{@4auXpv2?/\ 0lsFftO8]~!i?{	7qy98gnfKGkD z+|CH SAH(J$h*zBW5v}M9VvYy3.o*HdwxVA$b|=rJ@Uuj0<ugT8-95yY{fc6o+|rY/[,)1nC7+tkYZDu
@-xY{wy)
Iu$b#(uaS@WMd3ukNzDWI)T;1	\#BB^)
apSP!o$%P_[Xqc?}	Yy"\}v06Ay&<O5cloEY7>GLihXL'z1.
H3`LSu,~<qXon|S<:m+~_`	gev:knM|xX?|YW_x2tt7%:VS/zF}^`gG~8YEQUr
gGBP&~I                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Format-Specification: http://wiki.debian.org/Proposals/CopyrightFormat?action=recall&rev=228
Upstream-Name: File-Copy-Recursive
Upstream-Maintainer: Daniel Muey
Upstream-Source: http://search.cpan.org/dist/File-Copy-Recursive/

Files: *
Copyright:  2004, Daniel Muey
License: GPL-1+ | Artistic
 This library is free software; you can redistribute it and/or modify
 it under the same terms as Perl itself.
 .
 Perl is distributed under your choice of the GNU General Public License or
 the Artistic License.  On Debian GNU/Linux systems, the complete text of the
 GNU General Public License can be found in `/usr/share/common-licenses/GPL'
 and the Artistic Licence in `/usr/share/common-licenses/Artistic'.

Files: debian/*
Copyright:
  2005-2008, Krzysztof Krzyzaniak (eloy) <eloy@debian.org>
  2008,      gregor herrmann <gregoa@debian.org>
  2008,      Ansgar Burchardt <ansgar@43-1.org>
License: GPL-1+ | Artistic
 It is assumed that all contributors put their work under the same license
 as the module itself.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uXioFl@#P`GFdif}UKO2:^zwQee+(:7>TRR?t<': ;GutL~s]E6vfG6`1=:Ttx-L3l*+
'~?;QZ#"ZGa
<o1/\#h}F');V>**N
#^o.nzKE\%[US;DbYaF 8UgbMCh2R:3zWQK-VEa]Qx:=xKR:OU'\N3:DzCG<
l	#(`o^	U+'oM-eSS TT^@#N)&~x:};:~Sc{:=m=A/ KcQ;]B=}@N0B<\0-pv:	Z))pt&_{%7tL>X(EEb:2;{*cfJYl(`.9n*PWH{Iq1Nlh?kiq
N-$t{+k:5;-jP	I `bo-v9ZU[JaOZu`s*@WX,OKDdUP:|n?,u|/K1l!8(|B^7DZr=Pr\5WVo62:F\). .s/K8.nJ+*f7,LAOIW[p8>on/./>]rzyE`+f<yB./zEDe(JkZ	G!5zK)a7.m\{_v&KZ^Hq`aCY=~kpcNn!NquY*CPOuF4aE1^@!&.?17GQW7	eB y4L4vvV-~Sz'5~.Q!=NnzPS)jdt7s=r@`l/=YiDGfq VzMK_zD8S!F<eME:Oj]:bSzU2mQYSNn?mA2k.Wj:Z ]ck+]W{K#n^n{Vbb_$#Enc$:+>Fb4%UA(T $304TnwIjVAA=EmK4/kFL|E.SnJyxejm_5	6nKPGYy|(rIox3C]QD6e`G,Xh,v&iLak2G2t #4/gm*ilFW|Ib.;+%pMzu ?MF(UqSkpj Mm>}p<m<E;;='O+F8-(uygHL'UW}@j>gy@Nr5ZWiFUw8P|	I`\R]|3^E|BPwW"2.ybl?jwt02rzh30 q{D)]2<~T;k(bu8)WrF  %J .Uv@R|o".>>!.j7!uKxAHi8"KW@.^-Q}+E1.!2']2(& Eis0Zc[B-;YrB
EJ{$m2)19q ?v
e[~[?Ayl~\D:<8AgZ=0-)68RoG>?[HXJXY;>~POo?|n*u8Q!d_qO&b%7kq%WpL"jfZ]aQY	l'T'5o$|?GEuiwQQ[AY3<mtqCXfTv>%Ub5ehE/P1.lKDsY)aI#nj@)L\<Ajdj-djaXPr/~Rn4SvV5-N8[BZ.56\stjS4$N1A6^                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          XMs6WLSARPc;;Ic9LB' @9o+/[n46kd.o^gDRW#aTk)~,J6H}(9!b\?IuD+gdfR7KV"z'FXa`	p9 4 <]<XV+?jk`^ 1(!S|F'Mo8Vv 7+M!S5jXh)+bS!5O0I7Zq-W
Z]hB<YeJ <B}RQZQC3n"mEC^wsw $X2{K/
X7x|uYm=p/\T L!-^ca\L=LUr3pT>.~|\m}#=RxaB:oU(N0zt*Q:2hWtw
|
YExy2G}E#'mk?8MF%f*1uM`:2VvDR;CdgwQ>CBWDH9H	H}94DNi_d(M?A?Yt63 p-RB59NLcF/\ySl,Ct)}AJfH(}E4don@a9[H'.Hs{ex*+]69ewq)hn&88LNM,YARR"SvW9;5Hb}>NsQQUUv|8R                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /.
/etc
/etc/cron.daily
/etc/cron.daily/samba
/etc/init
/etc/init/nmbd.conf
/etc/init/reload-smbd.conf
/etc/init/samba-ad-dc.conf
/etc/init/smbd.conf
/etc/init.d
/etc/init.d/nmbd
/etc/init.d/samba
/etc/init.d/samba-ad-dc
/etc/init.d/smbd
/etc/logrotate.d
/etc/logrotate.d/samba
/etc/ufw
/etc/ufw/applications.d
/etc/ufw/applications.d/samba
/lib
/lib/systemd
/lib/systemd/system
/lib/systemd/system/nmbd.service
/lib/systemd/system/samba-ad-dc.service
/lib/systemd/system/smbd.service
/usr
/usr/bin
/usr/bin/eventlogadm
/usr/bin/oLschema2ldif
/usr/bin/pdbedit
/usr/bin/profiles
/usr/bin/sharesec
/usr/bin/smbcontrol
/usr/bin/smbstatus
/usr/lib
/usr/lib/arm-linux-gnueabihf
/usr/lib/arm-linux-gnueabihf/samba
/usr/lib/arm-linux-gnueabihf/samba/libHDB-SAMBA4.so.0
/usr/lib/arm-linux-gnueabihf/samba/libdb-glue.so.0
/usr/lib/arm-linux-gnueabihf/samba/libhdb-samba4.so.11.0.2
/usr/lib/arm-linux-gnueabihf/samba/libkdc-samba4.so.2.0.0
/usr/lib/arm-linux-gnueabihf/samba/libpac.so.0
/usr/lib/arm-linux-gnueabihf/samba/service
/usr/lib/arm-linux-gnueabihf/samba/service/cldap.so
/usr/lib/arm-linux-gnueabihf/samba/service/dcerpc.so
/usr/lib/arm-linux-gnueabihf/samba/service/dns.so
/usr/lib/arm-linux-gnueabihf/samba/service/dns_update.so
/usr/lib/arm-linux-gnueabihf/samba/service/drepl.so
/usr/lib/arm-linux-gnueabihf/samba/service/kcc.so
/usr/lib/arm-linux-gnueabihf/samba/service/kdc.so
/usr/lib/arm-linux-gnueabihf/samba/service/ldap.so
/usr/lib/arm-linux-gnueabihf/samba/service/nbtd.so
/usr/lib/arm-linux-gnueabihf/samba/service/ntp_signd.so
/usr/lib/arm-linux-gnueabihf/samba/service/s3fs.so
/usr/lib/arm-linux-gnueabihf/samba/service/web.so
/usr/lib/arm-linux-gnueabihf/samba/service/winbindd.so
/usr/lib/arm-linux-gnueabihf/samba/service/wrepl.so
/usr/lib/python2.7
/usr/lib/python2.7/dist-packages
/usr/lib/python2.7/dist-packages/samba
/usr/lib/python2.7/dist-packages/samba/dckeytab.arm-linux-gnueabihf.so
/usr/sbin
/usr/sbin/mksmbpasswd
/usr/sbin/nmbd
/usr/sbin/samba
/usr/sbin/samba_dnsupdate
/usr/sbin/samba_spnupdate
/usr/sbin/samba_upgradedns
/usr/sbin/smbd
/usr/share
/usr/share/doc
/usr/share/doc/samba
/usr/share/doc/samba/NEWS.Debian.gz
/usr/share/doc/samba/README.Debian
/usr/share/doc/samba/TODO.Debian
/usr/share/doc/samba/changelog.Debian.gz
/usr/share/doc/samba/copyright
/usr/share/doc/samba/examples
/usr/share/doc/samba/examples/LDAP
/usr/share/doc/samba/examples/LDAP/README
/usr/share/doc/samba/examples/LDAP/get_next_oid
/usr/share/doc/samba/examples/LDAP/ol-schema-migrate.pl.gz
/usr/share/doc/samba/examples/LDAP/samba-nds.schema.gz
/usr/share/doc/samba/examples/LDAP/samba-schema-FDS.ldif.gz
/usr/share/doc/samba/examples/LDAP/samba-schema-netscapeds5.x.README
/usr/share/doc/samba/examples/LDAP/samba-schema.IBMSecureWay
/usr/share/doc/samba/examples/LDAP/samba.ldif.gz
/usr/share/doc/samba/examples/LDAP/samba.schema.at.IBM-DS.gz
/usr/share/doc/samba/examples/LDAP/samba.schema.gz
/usr/share/doc/samba/examples/LDAP/samba.schema.oc.IBM-DS
/usr/share/doc/samba/examples/logon
/usr/share/doc/samba/examples/logon/genlogon
/usr/share/doc/samba/examples/logon/genlogon/genlogon.pl
/usr/share/doc/samba/examples/logon/mklogon
/usr/share/doc/samba/examples/logon/mklogon/mklogon.conf
/usr/share/doc/samba/examples/logon/mklogon/mklogon.pl.gz
/usr/share/doc/samba/examples/logon/ntlogon
/usr/share/doc/samba/examples/logon/ntlogon/README.gz
/usr/share/doc/samba/examples/logon/ntlogon/ntlogon.conf
/usr/share/doc/samba/examples/logon/ntlogon/ntlogon.py.gz
/usr/share/doc/samba/examples/printing
/usr/share/doc/samba/examples/printing/VampireDriversFunctions.gz
/usr/share/doc/samba/examples/printing/prtpub.c.gz
/usr/share/doc/samba/examples/printing/readme.prtpub
/usr/share/doc/samba/examples/printing/smbprint.sysv
/usr/share/doc/samba/examples/smbadduser.in
/usr/share/lintian
/usr/share/lintian/overrides
/usr/share/lintian/overrides/samba
/usr/share/man
/usr/share/man/man1
/usr/share/man/man1/log2pcap.1.gz
/usr/share/man/man1/oLschema2ldif.1.gz
/usr/share/man/man1/profiles.1.gz
/usr/share/man/man1/sharesec.1.gz
/usr/share/man/man1/smbcontrol.1.gz
/usr/share/man/man1/smbstatus.1.gz
/usr/share/man/man8
/usr/share/man/man8/eventlogadm.8.gz
/usr/share/man/man8/idmap_script.8.gz
/usr/share/man/man8/mksmbpasswd.8.gz
/usr/share/man/man8/nmbd.8.gz
/usr/share/man/man8/pdbedit.8.gz
/usr/share/man/man8/samba.8.gz
/usr/share/man/man8/smbd.8.gz
/usr/share/samba
/usr/share/samba/setup
/usr/share/samba/setup/DB_CONFIG
/usr/share/samba/setup/ad-schema
/usr/share/samba/setup/ad-schema/MS-AD_Schema_2K8_Attributes.txt
/usr/share/samba/setup/ad-schema/MS-AD_Schema_2K8_Classes.txt
/usr/share/samba/setup/ad-schema/MS-AD_Schema_2K8_R2_Attributes.txt
/usr/share/samba/setup/ad-schema/MS-AD_Schema_2K8_R2_Classes.txt
/usr/share/samba/setup/aggregate_schema.ldif
/usr/share/samba/setup/cn=samba.ldif
/usr/share/samba/setup/display-specifiers
/usr/share/samba/setup/display-specifiers/DisplaySpecifiers-Win2k0.txt
/usr/share/samba/setup/display-specifiers/DisplaySpecifiers-Win2k3.txt
/usr/share/samba/setup/display-specifiers/DisplaySpecifiers-Win2k3R2.txt
/usr/share/samba/setup/display-specifiers/DisplaySpecifiers-Win2k8.txt
/usr/share/samba/setup/display-specifiers/DisplaySpecifiers-Win2k8R2.txt
/usr/share/samba/setup/dns_update_list
/usr/share/samba/setup/fedora-ds-init.ldif
/usr/share/samba/setup/fedorads-dna.ldif
/usr/share/samba/setup/fedorads-index.ldif
/usr/share/samba/setup/fedorads-linked-attributes.ldif
/usr/share/samba/setup/fedorads-pam.ldif
/usr/share/samba/setup/fedorads-partitions.ldif
/usr/share/samba/setup/fedorads-refint-add.ldif
/usr/share/samba/setup/fedorads-refint-delete.ldif
/usr/share/samba/setup/fedorads-samba.ldif
/usr/share/samba/setup/fedorads-sasl.ldif
/usr/share/samba/setup/fedorads.inf
/usr/share/samba/setup/idmap_init.ldif
/usr/share/samba/setup/krb5.conf
/usr/share/samba/setup/memberof.conf
/usr/share/samba/setup/mmr_serverids.conf
/usr/share/samba/setup/mmr_syncrepl.conf
/usr/share/samba/setup/modules.conf
/usr/share/samba/setup/named.conf
/usr/share/samba/setup/named.conf.dlz
/usr/share/samba/setup/named.conf.update
/usr/share/samba/setup/named.txt
/usr/share/samba/setup/olc_mmr.conf
/usr/share/samba/setup/olc_seed.ldif
/usr/share/samba/setup/olc_serverid.conf
/usr/share/samba/setup/olc_syncrepl.conf
/usr/share/samba/setup/olc_syncrepl_seed.conf
/usr/share/samba/setup/prefixMap.txt
/usr/share/samba/setup/provision.ldif
/usr/share/samba/setup/provision.reg
/usr/share/samba/setup/provision.zone
/usr/share/samba/setup/provision_basedn.ldif
/usr/share/samba/setup/provision_basedn_modify.ldif
/usr/share/samba/setup/provision_basedn_options.ldif
/usr/share/samba/setup/provision_basedn_references.ldif
/usr/share/samba/setup/provision_computers_add.ldif
/usr/share/samba/setup/provision_computers_modify.ldif
/usr/share/samba/setup/provision_configuration.ldif
/usr/share/samba/setup/provision_configuration_basedn.ldif
/usr/share/samba/setup/provision_configuration_modify.ldif
/usr/share/samba/setup/provision_configuration_references.ldif
/usr/share/samba/setup/provision_dns_accounts_add.ldif
/usr/share/samba/setup/provision_dns_add_samba.ldif
/usr/share/samba/setup/provision_dnszones_add.ldif
/usr/share/samba/setup/provision_dnszones_modify.ldif
/usr/share/samba/setup/provision_dnszones_partitions.ldif
/usr/share/samba/setup/provision_group_policy.ldif
/usr/share/samba/setup/provision_init.ldif
/usr/share/samba/setup/provision_partitions.ldif
/usr/share/samba/setup/provision_privilege.ldif
/usr/share/samba/setup/provision_rootdse_add.ldif
/usr/share/samba/setup/provision_rootdse_modify.ldif
/usr/share/samba/setup/provision_schema_basedn.ldif
/usr/share/samba/setup/provision_schema_basedn_modify.ldif
/usr/share/samba/setup/provision_self_join.ldif
/usr/share/samba/setup/provision_self_join_config.ldif
/usr/share/samba/setup/provision_self_join_modify.ldif
/usr/share/samba/setup/provision_self_join_modify_config.ldif
/usr/share/samba/setup/provision_users.ldif
/usr/share/samba/setup/provision_users_add.ldif
/usr/share/samba/setup/provision_users_modify.ldif
/usr/share/samba/setup/provision_well_known_sec_princ.ldif
/usr/share/samba/setup/refint.conf
/usr/share/samba/setup/schema-map-fedora-ds-1.0
/usr/share/samba/setup/schema-map-openldap-2.3
/usr/share/samba/setup/schema_samba4.ldif
/usr/share/samba/setup/secrets.ldif
/usr/share/samba/setup/secrets_dns.ldif
/usr/share/samba/setup/secrets_init.ldif
/usr/share/samba/setup/secrets_sasl_ldap.ldif
/usr/share/samba/setup/secrets_simple_ldap.ldif
/usr/share/samba/setup/share.ldif
/usr/share/samba/setup/slapd.conf
/usr/share/samba/setup/spn_update_list
/usr/share/samba/setup/ypServ30.ldif
/var
/var/lib
/var/lib/samba
/var/lib/samba/printers
/var/lib/samba/printers/COLOR
/var/lib/samba/printers/IA64
/var/lib/samba/printers/W32ALPHA
/var/lib/samba/printers/W32MIPS
/var/lib/samba/printers/W32PPC
/var/lib/samba/printers/W32X86
/var/lib/samba/printers/WIN40
/var/lib/samba/printers/x64
/var/spool
/var/spool/samba
/lib/systemd/system/samba.service
/usr/lib/arm-linux-gnueabihf/samba/libhdb-samba4.so.11
/usr/lib/arm-linux-gnueabihf/samba/libkdc-samba4.so.2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      8dab517a5261c3012e4de9357a5e9e0a  usr/bin/attr
a2c91d972cee540cd68832cb50b8c3bb  usr/bin/getfattr
690d1d0f636352d31a5bfe0064e90642  usr/bin/setfattr
601174ef0835dd2f4cdfec6e92137dc6  usr/share/doc/attr/CHANGES.gz
b6f14c27824f61fa363668770fe99c97  usr/share/doc/attr/PORTING
62961c60371497ed780ec2bd0fc348fa  usr/share/doc/attr/README
9f2bb85f9c9d59ee59602ee958e5e42d  usr/share/doc/attr/changelog.Debian.gz
9bc6b3d60c7a71a1a72a68301136f014  usr/share/doc/attr/changelog.gz
6697e729027ca22da7584a736c9632a5  usr/share/doc/attr/copyright
a3f8205fcae2be77bd190da6dea8cd23  usr/share/locale/cs/LC_MESSAGES/attr.mo
264030b313073a8b9605502dfd4f67ff  usr/share/locale/de/LC_MESSAGES/attr.mo
a3310cd8cc3f67c3b0ac07dafa165434  usr/share/locale/es/LC_MESSAGES/attr.mo
ccde8755c4d71af11461435d3f339fdf  usr/share/locale/fr/LC_MESSAGES/attr.mo
614072c5da58e77e96cdd3fa6d3a5b66  usr/share/locale/gl/LC_MESSAGES/attr.mo
fb6be737cf197e414f31dfdc2f1856c4  usr/share/locale/nl/LC_MESSAGES/attr.mo
571228468c60737bf28a71b015f1e5ea  usr/share/locale/pl/LC_MESSAGES/attr.mo
0c9109cd203dce6175861e7a8c3d336b  usr/share/locale/sv/LC_MESSAGES/attr.mo
0c04c85baeafdfc23abb974d7b92d7ce  usr/share/man/man1/attr.1.gz
17a7c05bd7fa5aa606f716fdae5c2edc  usr/share/man/man1/getfattr.1.gz
151410d0bd221bcdf835940b5a4f9c7d  usr/share/man/man1/setfattr.1.gz
39104edb5425d4aeedd14e688068faf6  usr/share/man/man5/attr.5.gz
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ELF          (    h 4   !   4   	 (     p                   4   4  4                 T  T T                                           t                                p  p p D   D         Qtd                          Rtd                /lib/ld-linux-armhf.so.3             GNU                        GNU !@b:G^Q7V'%            B.(p!   (e 	                       	           
                                                                     "                   $   '   <9]a[4/N=Bw)9(}Q20Yy>~|[s1l42AZ+qX|y_t;BEgUaW{|vT<v                               *               9               M                                          m              g   P                 S                           H             *                                                                            x                                             8                           w              e             #         u  x                                D                                         n  x                                              	         x        1                            libattr.so.1 _ITM_deregisterTMCloneTable __gmon_start__ _Jv_RegisterClasses _ITM_registerTMCloneTable _fini attr_list attr_remove attr_get _init attr_set libc.so.6 __printf_chk exit setlocale optind perror dcgettext puts putchar abort stdin strlen memset getopt __fprintf_chk stdout malloc optarg stderr fwrite __fread_chk bindtextdomain __libc_start_main basename _edata __bss_start __bss_start__ __bss_end__ __end__ _end GLIBC_2.7 GLIBC_2.4 ATTR_1.2 ATTR_1.0                                                          0   ii        ii                     r(	        p(	         l    x          #                                   $  (  (  %  ,    0  
  4    8    <    @     D    H    L    P  !  T    X    \    `  )  d    h    @- -           | t l d \ T L D < 4 , $   O- P$M  @|5 x`p`   L HH< 4% p 0\  
L C' RJ   $ $ $ $ $   $ $  $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $  $ $ $ $  $ $ $ $     p  V `  V  ` V  0`0000 V   `  V   `#   @ 0H0s0   oL 3PE 0 U    X0   [  S0 00`F0 Vz      
3 PP  
   B0 0 *0  P   0  S @`       0  @  . 0 S	    W  0@ S0  S    
  P{    $ @Pp  
 0(   #
   PO    W4   2  0 0  S6  
  0  0
	 0  PG    W
 0 
   1	  0 
 h1|    @     X 0 
   (1  P  
!0     0    @ 
0     0   y  uh0   oP0  @0  00  t 0  h  (     ,    x  l          l x d  $ D P <       - -- 0EnL `
  0 0   R/=L l   0 0` S/0  S//{  x      $$ `A/0  S//x  x      @-@ 0  S0 0  @-$  0  S  @0  S
3/     D0- M8   @,0 0 000      \   C- pL`LP`P`eFaPE @@0 	 3/ T   /@-  Usage: %s [-LRSq] -s attrname [-V attrvalue] pathname  # set value
       %s [-LRSq] -g attrname pathname                 # get value
       %s [-LRSq] -r attrname pathname                 # remove attr
       %s [-LRq]  -l pathname                          # list attrs 
      -s reads a value from stdin and -g writes a value to stdout
  attr    /usr/share/locale   Only one of -s, -g, -r, or -l allowed
  -V only allowed with -s
    Unrecognized option: %c
    s:V:g:r:lqLRS   A filename to operate on is required
   malloc  attr_set    Could not set "%s" for %s
  Attribute "%s" set to a %d byte value for %s:
  attr_get    Could not get "%s" for %s
  Attribute "%s" had a %d byte value for %s:
 attr_remove Could not remove "%s" for %s
   attr_list   Could not list "%s" for %s
 Attribute "%s" has a %d byte value for %s
  At least one of -s, -g, -r, or -l is required
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         X 0                     	    P                     o         
                                       `    0    0         o o   oz                                                          ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	 ,	             A0   aeabi &   6 	
" .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .ARM.exidx .eh_frame .init_array .fini_array .jcr .dynamic .got .data .bss .ARM.attributes                                                    T T                             p p                     !            $                  4   o      X               >                          F                             N   o   z z  T                [   o      `                j   	      0 0  0                s   	   B   ` `                 |          	  	                    w         ,	 ,	  4                         `
 `
                            P P                             X X  p                      p                                                                                                                                                                                           p                          p  p                              x  x   $                       p        x   1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ELF          (     4   3   4   	 (     p.  . .                4   4  4                 T  T T                          .  .           .  . .   d           /  / /                p  p p D   D         Qtd                          Rtd.  . .           /lib/ld-linux-armhf.so.3             GNU                        GNU * +]'bA>bJG%         	   	e  @   "   D " A  	#"    A+   @              	   
                                         $   &               '   *   ,   .       /   1   4   5           6   7   <   ]a#H> 4G>*"sU:=msW/N= ^Bw)8sPTHH(}Q-8R20'Yy?~|w|NqX<vop|_9@_t;2 fII"CE!tm!Wh{|vT<v                               #             *               9               M               o  1                    4                           g   t)       W  `2                                 m   L                                  Z                                                                                  1                   ,             v  \2      S  1                   E             %                              1                                 b  `2                                    1 (     n                           1      <  1                    e             j  `2                                               y   l        w                           5  1       m                          V  `2                                   x              L       H  1                     libattr.so.1 _ITM_deregisterTMCloneTable __gmon_start__ _Jv_RegisterClasses _ITM_registerTMCloneTable _fini llistxattr lgetxattr _init libc.so.6 __xpg_basename strcpy __rawmemchr __printf_chk exit setlocale optind regexec perror dcgettext closedir puts __stack_chk_fail realloc abort seekdir strlen telldir __errno_location __fprintf_chk stdout __lxstat64 opendir __xstat64 __ctype_b_loc regcomp optarg stderr getopt_long fwrite __memcpy_chk strchr readdir64 qsort getrlimit64 bindtextdomain strcmp strerror __libc_start_main ld-linux-armhf.so.3 __stack_chk_guard _edata __bss_start __bss_start__ __bss_end__ __end__ _end closed num_dir_handles head GLIBC_2.4 ATTR_1.0                                                                                 ii                     ii                     p(	         0   0   1    1   1   1 )  0 1  0 .  0   0 !  0 /   0   $0   (0 	  ,0   00 8  40   80   <0 =  @0 '  D0 (  H0 ,  L0 9  P0   T0 $  X0 6  \0   `0 "  d0 2  h0 %  l0   p0   t0 :  x0   |0   0 3  0   0   0   0   0 +  0 0  0 5  0   0   0   0   @- -#      x p h ` X P H @ 8 0 (                        x p h ` X< <0-M @ P  0     1  2 X* O- pM  `ttttt    X \\Pr<C P0 P 8# p~  
H @. P ~   4 4 4  4 4 4  4  4 4 4  4 4 4 4 4 4 4 4 4 4  4 4  X 4 4 H 4 4 4 4   4 4 4 4 4 4 4  `"0 0T" 0  0 00  - R0  S2!  00 0 @    P  
 0h S=  0e S:  0x S7  0  S4  1 @0 0 00   <   00 0 000 0~ 000 0y   D 0 W  818    @ 0$0         P
 	   P   P@
	   P   0            W0   P l0   P0 0 0     2 - 0 1 ,2 - - - (2 $2 ) X2 - 1 1  . * ) 82 42  -     - -- 0p)  ) 0 0   R/     0 0` S/0  S//1 1     $$ `A/0  S//1 1     @-@ 0  S0 01 @-$  0  S  @0  S
3//        +@-@ @ @/0  l -0  0/0 L  = P   
C   ) 8@- PQ  
 @E    000	  TU #  38 8C-@L4 p P  U  
 8  P
  
 0h S`  
   P  
T      W  * @PG `0  S
 S  S  ^`  \ S" S`  US      P    "0    ^)  
G\    ^$  
   0"#0  C  8 !0  C   0  C   ^      R
 R
 R
\ R" R    0 0   ^ "     0 c    0e Sx X`  V  xR      Pi   00 `     R  
<0 `0g.C C  \: 0 0 0`c `   E  Pp 0!0Q3  !    P7    0s00  QW  x 0S`p! BSS 	0!	BSS	!	BS?B  Qn Q  
 Q#  
 0 0 0c * `@0  "    00 0 0 = #10H 0#2200H0 H010H 0H =#10H 0HH020H X2 ) ) 1 ) )  2 42  G- @   0M PP`0  r 0  S  
 0r   
0 </  PN      Pn   0  
p 07/  P>  Tr 0  S  
 0/ Sr  
. Sd  
<"  S@ 0  S   0  S	  
"2  0       Pq  
 0 0 `  V@  T.  
1  @PE  
 p   P[  
0  a h @b  0PM  
 `! @ @X  PPC  
  B00!      G   P2  
t 0  \   0 0 00/ S    0/ S@
     P  
0/ S
p0  'h0 0  	 r0 0 0/ S
u,2 0 (2 l  1 * 1 ) <* H* L* 1  * X*  2 42 02 * O-<<B<b 0  00 M 3/  PT     ` Q 7  pP@   0  @ 4/ `P[  @e  
    0!0@ T  
 0  S
   0x  Pp0 [  00@  81  W
 @0 	 @ T @    P
0`    00 0 0  @ P   pP#  
`  {0 p      00 0 h{    P  
L ` 00 0  00  L 1 82  2  2 42 1 ) T* p@-M 00  0   Q"  
  @0  S   px x0x @ PF   `P  
  w `0L    p4 e p1 @$2 1  2 ) T* - 8@- x  +p@p0    s`   !T  @ P    0 d,   8@  \`*  2 * * * * A- @PJ  
 0  S  
`P p\ S   
<  P   
p0  S  W   p Pd  0    P*   0 P  S   
\p   p 0P#3000E 010000E 00000E0  S  
\ S 

  P 0P0E0  S0  0      < |  0 S  :  /p@-@@ `P    P  
     @p pO-5M 0 0 P  0
` V  S` `  
0  S@  
H	    P  X0:

S  
	S   
 	 0</  p|  <  S ``  Vn  
  Z  4 00 0  S  4$0   ` V  
  `0U0   0     00 0 l  P `8   
  Z  
H4   0$ #0 0 00C 080+    P  
0. S  
`  5  _
0e 0	 S}  b$  0  </80 p e  P 0$  $  0  00 08 m  PO   `Lm`g<X0:	S|  >S@k 	 H  P  $
@"^ +0 </$
"Px# \Y
p   \I  
` Q Pa S Rp  0 Sj  
 S S
 +0 </ 0  S  
. Sz0  Sw80n
 /000  00  0 080  S p\   P 8 L  
@D!  0 0C 0 80 Hp	    Pk
$"  P(  
 a   Q  
	 S R	 W VpM ,0 </Kp
T0T 0     P
 ` `  +0</ 2            G-M M@Ap ` 0  R 0 P0#  
0   T
P  * : %  0 e:0   0 R   E$0 +  7/       P!I  S R0b          C- pL`LP`P`eFaPE @@0 	 3/ T  /@-  No such attribute   text    0123456789abcdef    base64  ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/    
  %s:     %s: Removing leading '/' from absolute path names
  # file: %s
 =
 %s=%s
  %s: %s: %s
 %s %s -- get extended attributes
   2.4.47  Usage: %s %s
   [-hRLP] [-n name|-d] [-e en] [-m pattern] path...     -n, --name=name         get the named extended attribute value
  -d, --dump              get all extended attribute values
  -e, --encoding=...      encode values (as 'text', 'hex' or 'base64')
      --match=pattern     only get attributes with names matching pattern
      --only-values       print the bare values only
  -h, --no-dereference    do not dereference symbolic links
      --absolute-names    don't strip leading '/' in pathnames
  -R, --recursive         recurse into subdirectories
  -L, --logical           logical walk, follow symbolic links
  -P  --physical          physical walk, do not follow symbolic links
      --version           print version and exit
      --help              this help text
  attr    /usr/share/locale   %s 2.4.47
  n:de:m:hRLP %s: invalid regular expression "%s"
    Usage: %s %s
Try `%s --help' for more information.
 ^user\. name    dump    encoding    match   only-values no-dereference  absolute-names  recursive   logical physical    version help                                                                \                         L    t)    .           /       o    X    x 
                      0    H               
    0         ot
 o   o	                                                 /         X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X 1     \2     1                   4. <.        n   D.         d   L.        e   X.        m   `.         v   l.         h   |.         a   .         R   .         L   .         P   .         V   .         H                       1     1 1                                 A0   aeabi &   6 	
" .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .ARM.exidx .eh_frame .init_array .fini_array .jcr .dynamic .got .data .bss .ARM.attributes                                                    T T                             p p                     !            $                  4   o                     >         x x                F         X X                   N   o   	 	  |                [   o   t
 t
  `                j   	      
 
  0                s   	   B      H              |         L L                    w         X X                            X X                            t) t)                             |) |)  @                      p   . .                            . .                             . .                              /  /                             / /                             / /                            0  0                            0 0                            1 1                         p        1  1                                2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ELF          (     4   @2   4   	 (     p#  # #                4   4  4                 T  T T                          #  #           /  / /   t           /  / /                p  p p D   D         Qtd                          Rtd/  / /             /lib/ld-linux-armhf.so.3             GNU                        GNU @'xy=<%            ` <"p` l$$TB                        
                                                       "   $   &   '   (   )   +                   -   /   ]a# 4?s|=/N=Bw)8}5sQ-8R20'Xye?~||EH?f`qX|!	Q1n_t;fII"BEgUaWvT<v                               *               9               M                                          g   \          x1       m                                                                              S  (1      m                                        )                                            1                    Z               x1       t                                                      {                         L  41                    n             1         x1       7             z   4
                      |             >                             1          01        x1          	         1       f              libattr.so.1 _ITM_deregisterTMCloneTable __gmon_start__ _Jv_RegisterClasses _ITM_registerTMCloneTable _fini lremovexattr lsetxattr _init libc.so.6 __xpg_basename strcpy __printf_chk exit setlocale strncmp optind perror dcgettext realloc abort stdin feof fgets strlen __errno_location getpagesize __fprintf_chk fclose __ctype_b_loc optarg stderr getopt_long fwrite strchr fopen64 bindtextdomain strerror __libc_start_main free _edata __bss_start __bss_start__ __bss_end__ __end__ _end ATTR_1.0 GLIBC_2.4                                                                     p(	                     ii         0    1   (1   01 ,  41    0 
  0 '  0 &  0   0    0   $0   (0 0  ,0   00   40   80   <0   @0 )  D0   H0   L0   P0   T0   X0   \0   `0 "  d0   h0 *  l0   p0 %  t0   x0   |0 (  0 !  0   0 	  @-T -%                x p h ` X P H @ 8 0 (         G- PM  @cs      0 0 "2 p  
B @6 P l                                              d        8    0  S2   0  S/  ! 0  01    R%  !    R!       0  S  |1 0  S    0   0`1       L^      0   0 1    @ 000    E 0 0  S  0 0  S  0 0  Sp
p`	        
 F  00 0 0 Ul0     Tp 0 U\1 # d1 41 `1 h1 8# @# `# 0 p1 l1 0 T# (1 h#      1 t1     - -- 0X    0 0   R/     0 0` S/0  S//1 1     $$ `A/0  S//1 1     @-@ 0  S0 081 @-$  0  S  @0  S
3//     = P   
   wh  0@-M$@$$ P @ U @</00  4
  0   \0/0   @-   W|@|0    l   M  \0  P   D  @0  {4   ;@  s|  \1           ! 00@s 	 R	  A0@ S  a0@ SW @  /7 @/ /A0@s  R  a0@ S
  00@	 S  + P	  
/ P  
= P   /G @/ /> / /? /O- @ 0M`0 SK  
  p W   " S    P  U    P   T 0  *    W 0   \ Q@   \ P" P  @ W   0  0  c    0 @p \  0Aq \@     @  0Lq \  @@ 0  0X S@  
S SpS"!   @  P   	 Tp
  * 00  0
  
@	 Tp:	 T  
 Ye  :  i  f  c  ` 
2JK1@o  t  J 00W" SpG@wR  h @  PL   T p p!F  * X   T@  
  '@ X   p0    S@  
@   
 T  
  @	0  J	 X "  X0    S@
@   
 { z   
05  
1 0 +!   00 0 0pc pD!1 @ P?  0!   F r
 r 000 { p
1J2 { 00  
 p
2K10 0  
 Y=  
    	 W@  
@000
0 Y  : 0= S   
 Y      	 T  
000
 Y 0c 	@   0
 0= S0= S0= S@p Y*<1 (1 " t1 \1 " A-M 0 @R P`0  
  !  @P?  
41 0  S  
(1  $ p   W  0  </  P    0 0  S 0    P0 3/  P  `@  P p   P  
  0    |   0 0 0  P @  c0@     gh1 0  4
 d1   (1 \1 " " t1 " O-  0M- S  
	 x PP  
20  0  Sp20 Phr `@      R  @ 2  P 9  PE  
   P   
0 0 U  
 K  [ !  00 0 K@  P=      `    0P   `      R  
@  P  `
     
 5    = P`,1  !1  [ @ `  0    0   0 U0  
  @0 0 `     @t0 0 `   T L0 @ P  0 0    " 01 <1 t1 ,# D1 \1 (1 " " " A- @PJ  
 0  S  
`P p\ S   
  P   
p0  S  W   p Pd  c    P*   0 P  S   
\p   p 0P#3000E 010000E 00000E0  S  
\ S 
j  P 0P0E0  S0  0          P@- 0  S\ S 0    \ R  
   R \  B    Q  
0\ Q0L| \0N~ ^@0D~ ^B0 0 S  :  /p@-@@ `P    P  
     @p pO- P,A@   [=  
Aq@p `
0k    P4  
   0  S  *0P
 S S  0@ `C  Q  *  
 R R
 
0  
0   
0 	   P   
       P 
    | x  C- pL`LP`P`ewFaPE @@0 	 3/ T  /@-  No such attribute   %s %s -- set extended attributes
   2.4.47  Usage: %s %s
   {-n name} [-v value] [-h] file...          %s %s
   {-x name} [-h] file...    -n, --name=name         set the value of the named extended attribute
  -x, --remove=name       remove the named extended attribute
  -v, --value=value       use value as the attribute value
  -h, --no-dereference    do not dereference symbolic links
      --restore=file      restore extended attributes
      --version           print version and exit
      --help              this help text
   bad input encoding
 
  %s: %s: %s
 r   %s: %s: No filename found in line %d, aborting
 %s: No filename found in line %d of standard input, aborting
   # file:     attr    /usr/share/locale   %s 2.4.47
  n:x:v:h Usage: %s %s
       %s %s
Try `%s --help' for more information.
    name    remove  value   no-dereference  restore version help    0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	    \     /          /       o    8    ( 
                      0                        (         o o   o0                                                 /         
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                #        n   #        x   #        v   #         h   #        B   #         V   #         H                   A0   aeabi &   6 	
" .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .ARM.exidx .eh_frame .init_array .fini_array .jcr .dynamic .got .data .bss .ARM.attributes                                                    T T                             p p                     !            $                  4   o      t               >         ( (                F         8 8                   N   o   0 0  b                [   o      @                j   	         (                s   	   B                     |         	 	                    w         
 
                                                        \  \                              d  d                         p   # #                            # #                             / /                             / /                             / /                             / /                            0  0                            0 0                              1 1  X                       p        1  1                                M1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 XoFb/gmZWI: )I"$]Jofe+M0lyf3qeWF9~bKZDZgdl	[~h'SXDnR^g7dUvU^:4W&nu%77U++K1kWpR\LN	DCwFb%)NZ\X)Vlu	UH+'0-{QJX;aV(L983*"3
8S*k\+Uc*c?M<ptJz5.yU`/+wx![Dn4nqId">wf4yc}T#6tRLn>|r3l(V[jJHwYz7_:]~_b!^D&ezz2b:9	 >W^;xXb#
RBfuA(V	BSoo^^^vn/`]#|+&\<g{P:0Wq_/UXd&`wO@BL!xl.q]$wwx&)pqzB
Rw>,[_7k7Xi?'`~?Dy5LT1OIIUdI6	a;mYTbR^ f	qrW.G$@|$v8_@Ru,V"G$oZ^CgkTZO74@k9TPiKV][\/. ;*jhAry
DAIEHfqm	Yg+H<$ie.?l7z_6($	YnJ'g%pgHC!mn8mMrn{M0|+*q%|h\ (U]KhhS~uP6UGvIyOVQUsnuEq/CaW[i#L2 0yDP*`}hd@5 2j yD4]}2J]A@P>;9a>04HAs&/1'Q0y%1L%
7y>h8b7|Fyq,FVQxg)R](SDg4V4)P.hs3P~ q=Byu kMPr.ECTv4/BF8XkW7;LDA"wE)06GZ qeHuj=jMt}T47arJ;P1X`-aFGN4u	1qxmCq:#f7eaOjzY]^<o;CNkq9$D~>FCrH@Vi#RpPrClF7:quW~6|k0s_F3
(x 7W
UzFZIeq<Zt  0 U+r>pirsNhfDrXU]RTpbkYpqTq	~/tJA\lFqJ!"]#CA,i>8J4$rkf@1Mi87q[8!3?[?IxfQ'T|kh<zN9G
.LBtE?Qa?@.Rw;o~1o*}=24C7 *Sa^d5N%lkF7uq8$0(#/S50.gO4$X'Ne(^.(RjPT)ki	lt~p3;h3ZN-=;L;g7XRC/8Nr|00FhnD3(9T9py[5$E& }yO}8xw19{;pcC8G>GR}	>+(JNqMF'\/n(C/*2|D` G                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         WnH}W8d2AGvxlAg6X-)dsM=UMJd RS.litpqHg''g#\;&5])LF4eIrQntDYN+j_]t,H-VklU[BQjYu^r7BmqusGW*i)]TNr"UWVr,lU/AxvAt%"oRGd[:Po6|oT~w7|uT;bN=6A A~i+0GWVM=CFN%SnJyo5;7>y] /-+rQWH<3^G<;_lf!VT>@+yWDN%o||N
I? TMi kU7C~/z>^N7.o4x^]4n0-&`D3)@eFzg'Il6Tki}jGt}}1Y]bqY/t5Y^9R<y:>KSj 
o%/t3mIV;~:zs;[LQR} >?_/jU&]7$I~D`Rp$7b>-7%`Ay1")&T!o3Pk?GP9
BQeUv#8s6bXlCKa|x/Y\}t"J!Kt'o#:*M_c1$~g6bc$MWLnXJJ8bL_%9V78&wgVAr?.IQL^I mL 1t9s`N;5#[8UH}vx^+Z*vW
}:x&5(C?GoG^V9K>
$]&)?0)RN<k|AQ^i]IkogpXX.	: 25"77OCNd&*X|y+@K0[U6A*Baa$w!'U]FqE]~]o/ +;[h@	"on*`G" aG5X.LzxRZfJ}BOY&Y$bt90fRF8VgM?`TRB~CQ,j	@N$D|0b2S3`vznf	Z9[BmJd++(-TR8xsyV1HZ/	;
5(4z|7a!D] d%*i{y]xTQ+^_ XB _:0[cX3taZZ7v!i}Pplx(]0U _SmXRv .*d)EA{x8G~F@F!#W+_,wx!W^ESzO*Y?+$?.0
66D{{:zG\&oY4?p;@'-/. .~d\	q|[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 WnF}W\6 K>48-QFb}CqZ}!%q{?\7[C:;99WD*Uk4)Tj4F%dG7Fuf jei!K^q&1-BeFXIIB\!.e-(i.)]TVzQzIk
VFT1$Z!Y)M\zuk<.=~t3~rGNJN8g3j:IcmJg*f[gwT][r$:wka@0BVXB<P?<[*}o)B.Sii2uX& Ai;PWpVluM=P^\J8^0,:YmW,j4N Wna*t\dy[=nnN{<F7>!J,U54gD}>gWx30f$tq;MGz4lzdB#;$#I'Ti_u.YU]~W|F4oDd4r]`E2e9*%9S8nF$Gz8B$vHl`!(4$Q\CsX?gMhE+QWt8.f>~q&&CE*aNf,R(S"^^8D zLUZ^
g~@!`/iv000%urVAN^_IW:8.Omt%Q
K<<%b`9JwKme%'[(GmP0F
}4l)H,sa) CyWR `<0[K&!.Ox!c@@.)-)&^{(.SK!(9L|CaO1\:?/C&l.Fdu[-0EiG~XFVzfa/GTF"
KawQ3Gw@3JUe}fr)v [_TQEAwqjBOlqG]&5{E:aJ/Z|Zv9u->Y[5Q_!Qe<CKn:OuZYpmI{ R)+'yGpY6S,{DdhSG|`q3=vN _GF;]bt9j9r~X bw\NEg%K	Xmr^[a32%laP^Kh
w'^'xLvQT?<m                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Ymo8_A&vvn(&NE@hITI)3C'FEyy5Bj]f:7PerYWjrUcy\+{:~	zMMnR[BV&9.\y/,j9[/gMB-T8m^Yze]]Y=Jk<h*SBrTHt<%,NEi<R5)14\S7B;]sm;NkL|tjks85&@)z].+ *S.zS!Zo|yaeFh)w9bAkt^o 1 \4E`6}m8/g?zA)@4TYo(}MNb<A6gT_MP^'p"o&WQ"TbV	L3Pag=A6OOo[l7x!K[A|j^'I[CTkEg|'y9:&!v=gd|=_]CD+UWyDa{:  E@Ya+t\R[g4X~+7OMKY|>,;(S(s?$na?A]T/~|M=+yS"}!It i' GN8I'W?R&{6Yf)OSo(1|
3rUo/)UO/qDJFM^'.z3VR0ZlPpR$N&: faIz>A@>p0hElU#PzeqClxK)5EZ`D|*W)'6-4#6KAi )Y ?fAa1tt}sS6
A'7~t >Nb{X%Fg3lD6b?TLy	HVZm JfaZe'A#e;.)Lo/EYRdL*JAMm	x+CLJdJK!h#rn%dCeT`pdb7	QP(SU9D_**4HOgK-z!V+JhkTJ<Vbkr]MQD/>junnSG"S(".%(OW}){n=F{ m"26fT)Nq2`.[cCK{ (T^Ytgfqsi2\v[Q+?V.<d%4\5X>z:/;PoCPSmGr8xB_yYTClwC+#v+Vt;~#YL/yn7`aahK"^Eyplf!kkse9B3:R4!mt[;+	#8].rh-}{//`_ZoVm UKCns*#)5o-^`	M(eW!%st$]a=vzrtj3Pg'/&xPNM1,MwHsX|/?v]ZD\H@)m68:W#lJ96Xcg-Z'j*`B5ikyV+6]m\+DOsBcuy UP(b|l]tDblF{@2I|=5i,uT^M7
R9-z#=	rw'o`|MWcd2 P0r;C>gl|~>.uXP}[
`
eS#(?} };GXOmYY#M;L6XOxEM>qxnH+wF>3?d
Go@jLqGp_. KC.N@M '1R~0	N7W^)2~;SchcR j@CTfa(UWE7HS+C7"si~A#h~RN_nM|pxv6yy5CNwh%ycc3{?{+">:.]iMn %u"H	 Z`ZwR}<@F}LIp9R%nm8h?<f`fbQ*Z<|X_$E!0bz%^1V{C"Y5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
1. unpack the source tarball and cd to the resulting dir

2. # autoconf  
   this reads configure.in and generates the ./configure script

3. # ./configure 
   this probes your system and then, for each "file" named
   in the AC_OUTPUT() macro near the end of configure.in,
   read "file".in and generate "file". Variables named @somevariable@
   will be substituted with literal values.

4. step (3) produces several files. These files are generated by
   configure from their respective .in file in the same directory.
   You should have a read of these generated files and diff them
   against their respective .in files to see what was substituted
   by configure.

   src/include/builddefs
   	common definitions for the build environment. This is included
	by all Makefiles, in conjunction with src/include/buildrules.
	Note that most autoconf/configure build environments generate
	Makefile (from Makefile.in) in every src dir. Instead, we
	generate builddefs, and then include it in every Makefile.

   src/include/platform_defs.h 
   	header containing conditional macros defining the C run-time
	environment discovered by the configure script.

5. read some or all of the GNU tool chain documentation
   GNU make :
       http://www.delorie.com/gnu/docs/make/make_toc.html
   autoconf :
    	http://www.delorie.com/gnu/docs/autoconf/autoconf_toc.html
   libtool :
    	http://www.delorie.com/gnu/docs/libtool/libtool_toc.html
   gcc/g++ :
    	http://www.delorie.com/gnu/docs/gcc/gcc_toc.html

6. Makefiles and build environment
   First have a look at some Makefiles

   	example using SUBDIRS :  attr/Makefile
        example static library:  attr/libattr/Makefile
        example command       :  attr/getfattr/Makefile

   All Makefiles must define TOPDIR as the root of the project. This
   allows other stuff to be found relative to $(TOPDIR).

   All Makefiles should have the following structure, which is
   much like commondefs and commonrules in the IRIX build environment, e.g.

   # ----------------------------------------------------------------------
   # TOPDIR must point to the root of the project
   # The builddefs file defines lots of things. Read it.
   TOPDIR = ..
   include $(TOPDIR)/include/builddefs

   # first rule should always be "default"
   default : sometarget
   	commands to build targets, if necessary

   # $(BUILDRULES) is defined in builddefs and includes rules for
   # descending subdirs, building targets and installation rules
   include $(BUILDRULES)

   install : default
   	$(INSTALL) sometargets somewhere
   # ----------------------------------------------------------------------

7. packaging

   # ./Makepkgs
   this script generates all of the packages supported - each has a
   subdirectory below attr/package where knowledge specific to each
   package type is maintained.

   The script produces logs of each stage of the build (this info is
   also echoed to the screen when the "verbose" option is provided):

	attr/Logs/configure	- `autoconf; ./configure' output
	attr/Logs/default	- `make default' output
	attr/Logs/dist		- `make package dist' output

   On successful completion, the script echoes the names of packages
   successfully generated.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ZQZr<N\;|59?8e'ZV }iY35 	J$D6F9eY=qWd"1SLKaPIUXNfkrJ<efGBLd`*/=J^|,`bZ}^T)~}lHVv0oGd/_zM3U={FKJSLZeUyxB='j[j*u?V&vV2Y;:k,>M%Vk3ujb0D[YDB|VUA:{"J#Ke0S@+IJ1Px >KM
-MmlUm3MQTyASjY,'7[s
0JszH.h?6lHU+IwFYTyBS0F/!<7a*M?+d1	0=-9Or%5/Z*	aPL"zT^ksV2)$SNe
kfl)ww%=i$H!`R2%Q5r-[PQL2vm-8yiEQ^<x?_e^bR z.O>-X(W5DGPxP:%Df@0`&["[ggMA ,u~O@,zs{[#*\$Jaw*UQ[ukc@fj0p-8xyPm^b$ah)WTyR;z;U>su]0W|}97rRU4&ke7<?cKh{d wXUc^e^^s~(@J@s',ynDrn)cTj1y3R(-*) &'>9%Kb (zz=!J/9+0P	 {`iTb;kZ|1kU:9X# PN*'MY(TiB w 2 Jf7W?EhWj7'VkjN;DJe[k0V|"b$h)|K!1 4TLLF,O_fYcWoY|:os]j`tR26,:3De>)=l sU}M'U+Rdn/?&+d"abxRU.MDxnI >d9=1(5&k~z-/sC(myIHt<|"7L)AxaJL^eh FL#xEz-c4aKLy(pQer`F1SW TLSnx{RH]*:S^6{5H`	 J_h|e32pUQ %f=U1&<E7f/.'sc$_}_MH<& sN)&do9]$SqU~P',syE+T#<dwZ3<z:ZB`dX[tH1.Ft YM~`EGR;NQaHCqZ]w!`(l	]@uLHW	'XtE9c"\QTKipmY{{:%u7ZOT6[R'}b'-\A2&K3(7my8K|htWk jTmdU3Gag~M:FF-C%M^qR[^w_bz<|g+A:CPZ<)V{mF}?5[W<v+}qL<%@mh1+.`49 'cYe`4|{l{U :!h~a	&lzF.Iy(KGe "0BDT~)M#T9+*\|qw'gl-{ P
QA1QWOcB24CR@~1VP8`I"=ir;&L{arYj@a; CYxq 7vZY
7ByP"52/
k~SbZbz$"ZMl&sF6k=s#)-v
S	'{ZB]t@4uG5*66B|~1=|Hkj$CDz#&G}\zcnv5Mn  f@uq	 4b@wk;JC4pe2mKD@YJm_30	pkh:;M'&HDTur2	A<'R	Vhr#ASo'wYFOPx.#'iKIx w#Emuf>x3JcwH
Jim"sVD30=vfo$ESx8BsB4WE`9A%JJ`C @K"CYHC+ok[[@P='HkWfGDR=C	( y|}_9x Em"T7/Yjf!CPSj'lQ>)g05(CKRiqubUC4QZK}u0pVW|A(aJxMe6wZ(%'T3^HAf|TOaDx
-
R'gb"6H;b~Q}b!I?UD]GpAA,)^3Hp[,D3	We!:i\rV1FicfCO58H;X	JVn6p81#KnQ_ab6sR71np'hg>t:Zlug-b]R^8ArQ/<T[~Qw/:+?p!&dBE>& $#+ i,Vo5N
h}KM5tJ.nTh=@|z%F5_x*YFJ5S}7t$- 'G/uiUr/hYGyV;LgJ?O(krVZ\Dj{(CE]>_T2Y>yr}s@>sOPo g}<_b>7N{tPI1Z~1!v%(<gjQ%jQ+^FS~}Snnmj.L{qXxl=ver+*S`Ovw;nMP5nQOO8ff_gh/|}8 	t)05c.oc!x:8?<$i_vwwxw{"zBXT#	)a?'2v#($7	fZ3,o)WOS>;`@dJ?>[w/CO8/%!w.O9LF$1.q]^	;|E`"P&N%CwRuzSUJw	*/x^<QDMI-s0afv4F~bI7>B'~ "(T].{<p\7V;6u.yn	&@'wT}dv6>dC,m|z~I.[{I>[kP&r;)??KEPn`+2;rWZfzI>q2P^|R1Kh|./
;9a\gZQe&	55>}n3]^l:#Fw55W*uyajeQMZ`UL6w|4wx<0]p|BWft@in$:NHHdI8;dS6z4jdE|B_XKrTQ%wSq5Y8(.{Y8Q#2R99+^Im(.Y/G-kJ_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Extended attribute package README
_________________________________

Package home: http://savannah.nongnu.org/projects/attr

See the file doc/INSTALL for build, installation and post-
install configuration steps.

Refer to the attr(5) manual page for general extended attribute
(EA) information and references to other EA manual pages.

For more information on the build process, please refer to
the doc/PORTING document.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          This package was debianized by Nathan Scott nathans@debian.org on
Sun, 19 Nov 2000 07:37:09 -0500.

It can be downloaded from http://download.savannah.gnu.org/releases-noredirect/attr/

Copyright:

Copyright (C) 2001-2002 Silicon Graphics, Inc.  All Rights Reserved.
Copyright (C) 2001 Andreas Gruenbacher.

You are free to distribute this software under Version 2.1
of the GNU Lesser General Public License.
On Debian systems, refer to /usr/share/common-licenses/LGPL-2.1
for the complete text of the GNU Lesser General Public License.

Certain components (as annotated in the source) are licensed
under version 2 of the terms of the GNU General Public License.
On Debian systems, the complete text of the GNU General Public
License can be found in /usr/share/common-licenses/GPL-2 file.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                [r?OQRCPI"3)k6-SuS.4b 7/'w\rTy!F;,],U*a)OE5}oei\J<b^wN	{\Xj8`-Wcv,!V!X&t1w"{6I|Ud*^on	;xJ9gybX\"e2D>}}SQe}FgAVGqb:+"1iWhd61(Y;!\Dzg/qw,hU}vg#=gge-;[3~<1X2oj;wUeLH 5zn{r\;Fl6lU^qAHYzH:xX.H\WB"8&4bDi4Jh;V1,V\+FWY-SX\Nkc V!3`B!yNLk3[zN}\Dy2~3&'v#9`zrR>C\`?DlW?VQw4*"2UX?alMcSvDCT\fVH9A/gxaH-C	"iwz	ls8%m{^"FFh/\l:7,'X)
DNjVyY95_[=9l(ZXE?Dx?D G{u~woNNrgP;YY-5O7&."6:qDE<*MbHdi,tHq=8.KN_CY}i\%	I"7d$GM~- >r5Ql uM-u{F\L*7EXGE2B\IPK]`QQTv43{AgiGQ^hI&2')'~ w)DH/Da* 79J^KIX)g1s`Hgkp>\V`9X Zr?TYb~;f9sf__CXU<>:;4>{NX3P&MI!XOKN&{[:1(VN(w0ofPa/r{@dfYSqD3Y CMebpjeek;sPH}Uev8oP l4ig#Pdy1Xl`XrI*,a,U^s@,)$Jg*I(,6r#W|^:=8]JsKY@umPZ47FQ]+JW+Y*ht31E5^m{Q("^cO$}|)R5rI4X_u[b_ifAig
z"2\qD+0S>jBfsTU osjNk:7&n]+i<1[v:z6o+,q2*ALp=@#nA~ib}xg'o//_ bF=zaYorWw1^}8*	RQb4Tv`<//
y5"60C8)qKh,J5L'UF<\]3H^+X4;l~tM+J5Cr/v^yA#t:D(|T,*Ui!8vnK0q&,2{>kc/]E|{N52k^a: oxl |xjMpkgjD,Zh]iz-1a*C|;p~0Z5#'s@1Ds6Tr1jSv]K2zm}z}[O}]76`_U~p"E--LyazAqz:,Mwu%1<.^z5=7"],&bOC flrk23-imehjm.f,{vPn"U}JF6CQ]T#1'0nhD:uN2sn*t9p`
7T7M?7]27sU1 7QB)c6
H?-El[O .^MRx~q.N# UwHjDCC%OOiLdYR@!I#;XN"Z
.>'tF&B$(1Dk93[pQ>3.N?7	itmyuB$ :w=z!&Qy!;091 {j2FN7Ol~V!r?TC3 :,Alu4@}7$8)N45M=R(T(xd7.	m@.arEm3l^:w$:Bb z2jdd6k|/Q2JMG5vl$RzI5H7@/)Z$3]fnhyNQZa"[z,N>?z~yL:We;587lw
Z(/#g8MhRQlEe=F>%@M	Rv4+!H|l!}R

L&kHB	68018:SO?u:zO0
y):"RW=$FO_Z)V4!|9=:5n0"ueZTg~e1@-5sL<bIqs<f	ELft|1'6S7Pakz{;"wTdp7R)lw=>gB{Y\|Y#46M<hKPk2:
Im/eGt.M_.H^YT
3[@tLIj$5>'Ttc#i)l,2{>).;*u3tWkyi<?.nQ Q }y^m]nRwkuw_&P*c"wzxj|Ek"$|'
8O2)Z@]'dj"7SLn50e=L3UQ6`U5gL{95DBCo'KyNyPrLL	 {;58HsFsD@i4$~0:
9(t9p qHW/@fc/vtof{sq:u:E3 U(JU>iV i _(j8rd.Mn<@ }$ZytA|h+(2Vk`AtwynYgm0 C_mg^S9
~_7p>[<%&z:\:N:.,&kVA(( Hg7w,5=`Y*0'w<ia}ztL'Q(t#
Vdm=]:>t-aK}"?A  eBPP!o"m)P%cYV4#ms>g4
Tvq?hx9                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Zr<N\;|59?8e'ZV }iY35 	J$D6F9eY=qWd"1SLKaPIUXNfkrJ<efGBLd`*/=J^|,`bZ}^T)~}lHVv0oGd/_zM3U={FKJSLZeUyxB='j[j*u?V&vV2Y;:k,>M%Vk3ujb0D[YDB|VUA:{"J#Ke0S@+IJ1Px >KM
-MmlUm3MQTyASjY,'7[s
0JszH.h?6lHU+IwFYTyBS0F/!<7a*M?+d1	0=-9Or%5/Z*	aPL"zT^ksV2)$SNe
kfl)ww%=i$H!`R2%Q5r-[PQL2vm-8yiEQ^<x?_e^bR z.O>-X(W5DGPxP:%Df@0`&["[ggMA ,u~O@,zs{[#*\$Jaw*UQ[ukc@fj0p-8xyPm^b$ah)WTyR;z;U>su]0W|}97rRU4&ke7<?cKh{d wXUc^e^^s~(@J@s',ynDrn)cTj1y3R(-*) &'>9%Kb (zz=!J/9+0P	 {`iTb;kZ|1kU:9X# PN*'MY(TiB w 2 Jf7W?EhWj7'VkjN;DJe[k0V|"b$h)|K!1 4TLLF,O_fYcWoY|:os]j`tR26,:3De>)=l sU}M'U+Rdn/?&+d"abxRU.MDxnI >d9=1(5&k~z-/sC(myIHt<|"7L)AxaJL^eh FL#xEz-c4aKLy(pQer`F1SW TLSnx{RH]*:S^6{5H`	 J_h|e32pUQ %f=U1&<E7f/.'sc$_}_MH<& sN)&do9]$SqU~P',syE+T#<dwZ3<z:ZB`dX[tH1.Ft YM~`EGR;NQaHCqZ]w!`(l	]@uLHW	'XtE9c"\QTKipmY{{:%u7ZOT6[R'}b'-\A2&K3(7my8K|htWk jTmdU3Gag~M:FF-C%M^qR[^w_bz<|g+A:CPZ<)V{mF}?5[W<v+}qL<%@mh1+.`49 'cYe`4|{l{U :!h~a	&lzF.Iy(KGe "0BDT~)M#T9+*\|qw'gl-{ P
QA1QWOcB24CR@~1VP8`I"=ir;&L{arYj@a; CYxq 7vZY
7ByP"52/
k~SbZbz$"ZMl&sF6k=s#)-v
S	'{ZB]t@4uG5*66B|~1=|Hkj$CDz#&G}\zcnv5Mn  f@uq	 4b@wk;JC4pe2mKD@YJm_30	pkh:;M'&HDTur2	A<'R	Vhr#ASo'wYFOPx.#'iKIx w#Emuf>x3JcwH
Jim"sVD30=vfo$ESx8BsB4WE`9A%JJ`C @K"CYHC+ok[[@P='HkWfGDR=C	( y|}_9x Em"T7/Yjf!CPSj'lQ>)g05(CKRiqubUC4QZK}u0pVW|A(aJxMe6wZ(%'T3^HAf|TOaDx
-
R'gb"6H;b~Q}b!I?UD]GpAA,)^3Hp[,D3	We!:i\rV1FicfCO58H;X	JVn6p81#KnQ_ab6sR71np'hg>t:Zlug-b]R^8ArQ/<T[~Qw/:+?p!&dBE>& $#+ i,Vo5N
h}KM5tJ.nTh=@|z%F5_x*YFJ5S}7t$- 'G/uiUr/hYGyV;LgJ?O(krVZ\Dj{(CE]>_T2Y>yr}s@>sOPo g}<_b>7N{tPI1Z~1!v%(<gjQ%jQ+^FS~}Snnmj.L{qXxl=ver+*S`Ovw;nMP5nQOO8ff_gh/|}8 	t)05c.oc!x:8?<$i_vwwxw{"zBXT#	)a?'2v#($7	fZ3,o)WOS>;`@dJ?>[w/CO8/%!w.O9LF$1.q]^	;|E`"P&N%CwRuzSUJw	*/x^<QDMI-s0afv4F~bI7>B'~ "(T].{<p\7V;6u.yn	&@'wT}dv6>dC,m|z~I.[{I>[kP&r;)??KEPn`+2;rWZfzI>q2P^|R1Kh|./
;9a\gZQe&	55>}n3]^l:#Fw55W*uyajeQMZ`UL6w|4wx<0]p|BWft@in$:NHHdI8;dS6z4jdE|B_XKrTQ%wSq5Y8(.{Y8Q#2R99+^Im(.Y/G-kJ_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               )                        !      !   B  /   d  =     2     $        *  %   C  .   i  +     *     .        	     9	     U	     s	     	  &   	     	     	  @   	  3   /
  R  c
                      U        v  <        +   t  +     D     T     5   f  (          >     B     ;   b  9     A     1     0   L  3   }  /          =        :     Y  M   k  >         !   ~                                                                                                    	                                      
                    %s %s
   -n, --name=name         get the named extended attribute value
  -d, --dump              get all extended attribute values
  -e, --encoding=...      encode values (as 'text', 'hex' or 'base64')
      --match=pattern     only get attributes with names matching pattern
      --only-values       print the bare values only
  -h, --no-dereference    do not dereference symbolic links
      --absolute-names    don't strip leading '/' in pathnames
  -R, --recursive         recurse into subdirectories
  -L, --logical           logical walk, follow symbolic links
  -P  --physical          physical walk, do not follow symbolic links
      --version           print version and exit
      --help              this help text
   -n, --name=name         set the value of the named extended attribute
  -x, --remove=name       remove the named extended attribute
  -v, --value=value       use value as the attribute value
  -h, --no-dereference    do not dereference symbolic links
      --restore=file      restore extended attributes
      --version           print version and exit
      --help              this help text
 %s %s -- get extended attributes
 %s %s -- set extended attributes
 %s: %s: No filename found in line %d, aborting
 %s: No filename found in line %d of standard input, aborting
 %s: Removing leading '/' from absolute path names
 %s: invalid regular expression "%s"
 -V only allowed with -s
 A filename to operate on is required
 At least one of -s, -g, -r, or -l is required
 Attribute "%s" had a %d byte value for %s:
 Attribute "%s" has a %d byte value for %s
 Attribute "%s" set to a %d byte value for %s:
 Could not get "%s" for %s
 Could not list "%s" for %s
 Could not remove "%s" for %s
 Could not set "%s" for %s
 No such attribute Only one of -s, -g, -r, or -l allowed
 Unrecognized option: %c
 Usage: %s %s
 Usage: %s %s
       %s %s
Try `%s --help' for more information.
 Usage: %s %s
Try `%s --help' for more information.
 Usage: %s [-LRSq] -s attrname [-V attrvalue] pathname  # set value
       %s [-LRSq] -g attrname pathname                 # get value
       %s [-LRSq] -r attrname pathname                 # remove attr
       %s [-LRq]  -l pathname                          # list attrs 
      -s reads a value from stdin and -g writes a value to stdout
 getting attribute %s of %s listing attributes of %s setting attribute %s for %s setting attributes for %s Project-Id-Version: attr 2.4.41
Report-Msgid-Bugs-To: 
POT-Creation-Date: 2008-02-11 17:34+1100
PO-Revision-Date: 2008-04-09 16:30+0200
Last-Translator: Petr Pisar <petr.pisar@atlas.cz>
Language-Team: Czech <translation-team-cs@lists.sourceforge.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
        %s %s
   -n, --name=nzev        zjist hodnotu jmenovanho rozenho atributu
  -d, --dump              zjist hodnoty vech rozench atribut
  -e, --encoding=        zakduje hodnotu (jako text, hex nebo base64)
      --match=vzor        zsk jen atributy, jejich jmna vyhovuj vzoru
      --only-values       vype ist jenom hodnoty
  -h, --no-dereference    nensleduje symbolick odkazy
      --absolute-names    neodstrauje vodn / zcest ksouborm
  -R, --recursive         sestupuje do podadres
  -L, --logical           logick prchod, nsleduje symbolick odkazy
  -P  --physical          fyzick prchod, symbolick odkazy nensleduje
      --version           vype verzi a skon
      --help              text tto npovdy
   -n, --name=nzev        nastav hodnotu jmenovanho rozenho atributu
  -x, --remove=nzev      odstran jmenovan rozen atribut
  -v, --value=hodnota     jako hodnotu atributu pouije hodnotu
  -h, --no-dereference    do not dereference symbolic links
      --restore=soubor    obnov rozen atributy
      --version           vype verzi a skon
      --help              text tto npovdy
 %s %szsk rozen atributy
 %s %s nastav rozen atributy
 %s: %s: dn jmno souboru nenalezeno na dku %d, konm.
 %s: dn jmno souboru nenalezeno na dku %d standardnho vstupu, konm
 %s: Odstrauji vodn / zabsolutn cesty
 %s: chybn regulrn vraz %s
 -Vje povoleno sej s -s
 Jmno souboru, se kterm se bude pracovat, je vyadovno.
 Alespo jeden zpepna -s, -g, -r nebo -l je vyadovn
 Atribut %1$s souboru %3$s ml %2$dbajtovou hodnotu:
 Atribut %1$s souboru %3$s m %2$dbajtovou hodnotu
 Atributu %1$s souboru %3$s nastavena %2$dbajtov hodnota:
 Ze souboru %2$s nelze zskat atribut %1$s
 Ze souboru %2$s nelze vypsat atribut %1$s
 Ze souboru %2$s nelze odstranit atribut %1$s
 Souboru %2$s nelze nastavit atribut %1$s
 Takov atribut neexistuje Povolen je prv jeden zpepna -s, -g, -r nebo -l
 Nerozpoznan pepna: %c
 Pouit: %s %s
 Pouit: %s %s
         %s %s
Pro vce informac zkuste %s --help.
 Pouit: %s %s
Pro vce informac zkuste %s --help.
 Uit: %s [-LRSq] -s nzev_atributu [-V hodnota] cesta  # nastav hodnotu
       %s [-LRSq] -g nzev_atributu cesta               # zjist hodnotu
       %s [-LRSq] -r nzev_atributu cesta               # odstran atribut
       %s [-LRq]  -l cesta                              # vype atributy
  -s te hodnotu ze standardnho vstupu a -g ji vypisuje na standardn vstup.
 zskvm atribut %s souboru %s vypisuji atribut souboru %s nastavuji atribut %s souboru %s nastavuji atributy souboru %s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    %         `    a    4  !     !     /     <   6  2   s  $          %     *   
  +   5  .   a                      "        	     2	  3   @	  
  t	     
     
     
     
  (  
          $     %     5     E     4   Z  )          4     3     3   9  ;   m       #     !          .   %     T     k  /   ~  *                      5           
                                                                                        	                           -n, --name=name         get the named extended attribute value
  -d, --dump              get all extended attribute values
  -e, --encoding=...      encode values (as 'text', 'hex' or 'base64')
      --match=pattern     only get attributes with names matching pattern
      --only-values       print the bare values only
  -h, --no-dereference    do not dereference symbolic links
      --absolute-names    don't strip leading '/' in pathnames
  -R, --recursive         recurse into subdirectories
  -L, --logical           logical walk, follow symbolic links
  -P  --physical          physical walk, do not follow symbolic links
      --version           print version and exit
      --help              this help text
   -n, --name=name         set the value of the named extended attribute
  -x, --remove=name       remove the named extended attribute
  -v, --value=value       use value as the attribute value
  -h, --no-dereference    do not dereference symbolic links
      --restore=file      restore extended attributes
      --version           print version and exit
      --help              this help text
 %s %s -- get extended attributes
 %s %s -- set extended attributes
 %s: %s: No filename found in line %d, aborting
 %s: No filename found inline %d of standard input, aborting
 %s: Removing leading '/' from absolute path names
 %s: invalid regular expression "%s"
 -V only allowed with -s
 A filename to operate on is required
 At least one of -s, -g, or -r is required
 Attribute "%s" had a %d byte value for %s:
 Attribute "%s" set to a %d byte value for %s:
 Could not get "%s" for %s
 Could not remove "%s" for %s
 Could not set "%s" for %s
 No such attribute Only one of -s, -g, or -r allowed
 Unrecognized option: %c
 Usage: %s %s
 Usage: %s %s
Try `%s --help' for more information.
 Usage: %s [-LRq] -s attrname [-V attrvalue] pathname  # set value
       %s [-LRq] -g attrname pathname                 # get value
       %s [-LRq] -r attrname pathname                 # remove attr
      -s reads a value from stdin and -g writes a value to stdout
 getting attribute %s of %s listing attributes of %s setting attribute %s for %s setting attributes for %s Project-Id-Version: attr-2.2.0
POT-Creation-Date: 2002-12-02 00:45+0100
PO-Revision-Date: 2003-01-23 01:31+0100
Last-Translator: Andreas Grnbacher <a.gruenbacher@computer.org>
Language-Team:  <de@li.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
   -n, --name=name         Das angegebene erweiterte Attribut lesen
  -d, --dump              Alle erweiterten Attribute lesen
  -e, --encoding=...      Wert codieren (als 'text', 'hex' oder 'base64')
      --match=muster      Nur Attribute, die mit muster bereinstimmen
      --only-values       Die Attributwerte ohne Codierung ausgeben
  -h, --no-dereference    Symbolische Links nicht dereferenzieren
      --absolute-names    Fhrende '/' in Pfadnamen nicht entfernen
  -R, --recursive         In Unterverzeichnisse wechseln
  -L, --logical           Alle symbolischen Links verfolgen
  -P  --physical          Symbolische Links nicht verfolgen
      --version           Die Version ausgeben
      --help              Diese Hilfe
   -n, --name=name         Name des Attributs, das gesetzt werden soll
  -x, --remove=name       Entfernt das angegebene erweiterte Attribut
  -v, --value=wert        Wert fr das erweiterte Attribut
  -h, --no-dereference    Symbolische Links nicht dereferenzieren
      --restore=datei     Erweiterte Attribute wiederhestellen
      --version           Die Version ausgeben
      --help              Diese Hilfe
 %s %s -- erweiterte Attribute lesen
 %s %s -- Erweiterte Attribute setzen
 %s: %s: Kein Dateiname in Zeile %d gefunden, Abbruch
 %s: Kein Dateiname in Zeile %d der Standardeingabe gefunden, Abbruch
 %s: Entferne fhrenden '/' von absoluten Pfadnamen
 %s: ungltiger regulrer Ausdruck "%s"
 -V nur mit -s erlaubt
 Der Name der zu verwendenden Datei ist erforderlich
 Eine der Optionen -s, -g, oder -r ist erforderlich
 Attribut "%1$s" von %3$s hat einen %2$d-Byte-Wert:
 Attribut "%1$s" von %3$s auf einen %2$d-Byte-Wert gesetzt:
 Konnte "%s" von %s nicht lesen
 Konnte "%s" von %s nicht entfernen
 Konnte "%s" fr %s nicht setzen
 Kein solches Attribut Nur eine der Optionen -s, -g, oder -r erlaubt
 Unbekannte Option: %c
 Verwendung: %s %s
 Weiterfhrende Informationen mit `%s --help'.
 Verwendung: %s [-LRq] -s attrname [-V attrvalue] pfadname  # Wert setzen
            %s [-LRq] -g attrname pfadname                 # Wert lesen
            %s [-LRq] -r attrname pfadname                 # Wert entfernen
            -s liest einen Wert von stdin, -g schreibt einen Wert auf stdout
 Lesen von Attribut %s von %s Auslisten von Attributen von %s Setzen von Attribut %s fr %s Setzen von Attributen fr %s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          )                        !      !   B  /   d  =     2     $        *  %   C  .   i  +     *     .        	     9	     U	     s	     	  &   	     	     	  @   	  3   /
  R  c
                      V        w  #        &   N  )   u  B     W     8   :  &   s        5     -     2     0   R  4                !     #        ?  3   T            D     7     u  ,            !                                                                                             	                                      
                    %s %s
   -n, --name=name         get the named extended attribute value
  -d, --dump              get all extended attribute values
  -e, --encoding=...      encode values (as 'text', 'hex' or 'base64')
      --match=pattern     only get attributes with names matching pattern
      --only-values       print the bare values only
  -h, --no-dereference    do not dereference symbolic links
      --absolute-names    don't strip leading '/' in pathnames
  -R, --recursive         recurse into subdirectories
  -L, --logical           logical walk, follow symbolic links
  -P  --physical          physical walk, do not follow symbolic links
      --version           print version and exit
      --help              this help text
   -n, --name=name         set the value of the named extended attribute
  -x, --remove=name       remove the named extended attribute
  -v, --value=value       use value as the attribute value
  -h, --no-dereference    do not dereference symbolic links
      --restore=file      restore extended attributes
      --version           print version and exit
      --help              this help text
 %s %s -- get extended attributes
 %s %s -- set extended attributes
 %s: %s: No filename found in line %d, aborting
 %s: No filename found in line %d of standard input, aborting
 %s: Removing leading '/' from absolute path names
 %s: invalid regular expression "%s"
 -V only allowed with -s
 A filename to operate on is required
 At least one of -s, -g, -r, or -l is required
 Attribute "%s" had a %d byte value for %s:
 Attribute "%s" has a %d byte value for %s
 Attribute "%s" set to a %d byte value for %s:
 Could not get "%s" for %s
 Could not list "%s" for %s
 Could not remove "%s" for %s
 Could not set "%s" for %s
 No such attribute Only one of -s, -g, -r, or -l allowed
 Unrecognized option: %c
 Usage: %s %s
 Usage: %s %s
       %s %s
Try `%s --help' for more information.
 Usage: %s %s
Try `%s --help' for more information.
 Usage: %s [-LRSq] -s attrname [-V attrvalue] pathname  # set value
       %s [-LRSq] -g attrname pathname                 # get value
       %s [-LRSq] -r attrname pathname                 # remove attr
       %s [-LRq]  -l pathname                          # list attrs 
      -s reads a value from stdin and -g writes a value to stdout
 getting attribute %s of %s listing attributes of %s setting attribute %s for %s setting attributes for %s Project-Id-Version: attr-2.4.37.0
Report-Msgid-Bugs-To: 
POT-Creation-Date: 2007-03-06 12:02+0100
PO-Revision-Date: 2007-03-16 23:29+0100
Last-Translator: Antonio Trueba <atrueba@users.sourceforge.net>
Language-Team: Spanish
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Poedit-Language: Spanish
        %s %s
   -n, --name=nombre       obtener el atributo extendido "nombre"
  -d, --dump              obtener valor de todos los atributos extendidos
  -e, --encoding=...      codificar valores (como 'text', 'hex' o 'base64')
      --match=patrn      slo obtener atributos cuyo nombre coincida con "patrn"
      --only-values       slo mostrar los valores en crudo
  -h, --no-dereference    no resolver enlaces simblicos
      --absolute-names    no eliminar '/' iniciales en nombres de ruta
  -R, --recursive         recorrer subdirectorios recursivamente
  -L, --logical           recorrido lgico, siguiendo enlaces simblicos
  -P  --physical          recorrido fsico, no seguir enlaces simblicos
      --version           mostrar versin y salir
      --help              este texto de ayuda
   -n, --name=nombre       establecer valor para el atributo extendido "nombre"
  -x, --remove=nombre     eliminar atributo extendido "nombre"
  -v, --value=valor       usar "valor" como el valor del atributo
  -h, --no-dereference    no resolver enlaces simblicos
      --restore=archivo   restaurar atributos extendidos
      --version           mostrar versin y salir
      --help              este texto de ayuda
 %s %s -- obtener atributos extendidos
 %s %s -- establecer atributos extendidos
 %s: %s: No se encontr nombre de archivo en lnea %d, abortando
 %s: %s: No se encontr nombre de archivo en lnea %d de entrada estndar, abortando
 %s: Eliminando '/' inicial en nombres de ruta absolutos
 %s: expresin regular invlida "%s"
 -V slo est permitido con -s
 Se necesita un nombre de archivo sobre el que operar
 Se necesita al menos uno de -s, -g, -r, o -l
 El atributo "%s" tena el valor byte %d para %s:
 El atributo "%s" tiene el valor byte %d para %s
 Atributo "%s" establecido al valor byte %d para %s:
 No se pudo obtener "%s" para %s
 No se pudo listar "%s" para %s
 No se pudo eliminar "%s" para %s
 No se pudo establecer "%s" para %s
 Atributo inexistente Slo est permitido usar uno de -s, -g, -r, o -l
 Opcin no reconocida: %c
 Uso: %s %s
 Uso: %s %s
       %s %s
Escriba `%s --help' para ms informacin.
 Uso: %s %s
Escriba `%s --help' para ms informacin.
 Uso: %s [-LRSq] -s nomatrib ruta [-V valoratr] ruta  # establecer valor
     %s [-LRSq] -g nomatrib ruta                     # obtener valor
     %s [-LRSq] -r nomatrib ruta                     # borrar atributo
     %s [-LRq]  -l ruta                              # listar atributos 
    -s lee un valor de la entrada estndar y -g escribe un valor a la salida estndar
 obteniendo atributo %s de %s listando atributos de %s estableciendo atributo %s para %s estableciendo atributos para %s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    %         `    a    4  !     !     /     =   6  2   t  $          %     *     +   6  .   b                      "        	     3	  3   A	    u	     
     
     
     
  Z  
  Y  H      '   B  +   j  @     P     6   (  .   _       ?     6     :   %  A   `  $     %     "          4   !     V     l  B     _        $     E  %   c  "                                                                                                      	               
            -n, --name=name         get the named extended attribute value
  -d, --dump              get all extended attribute values
  -e, --encoding=...      encode values (as 'text', 'hex' or 'base64')
      --match=pattern     only get attributes with names matching pattern
      --only-values       print the bare values only
  -h, --no-dereference    do not dereference symbolic links
      --absolute-names    don't strip leading '/' in pathnames
  -R, --recursive         recurse into subdirectories
  -L, --logical           logical walk, follow symbolic links
  -P  --physical          physical walk, do not follow symbolic links
      --version           print version and exit
      --help              this help text
   -n, --name=name         set the value of the named extended attribute
  -x, --remove=name       remove the named extended attribute
  -v, --value=value       use value as the attribute value
  -h, --no-dereference    do not dereference symbolic links
      --restore=file      restore extended attributes
      --version           print version and exit
      --help              this help text
 %s %s -- get extended attributes
 %s %s -- set extended attributes
 %s: %s: No filename found in line %d, aborting
 %s: No filename found in line %d of standard input, aborting
 %s: Removing leading '/' from absolute path names
 %s: invalid regular expression "%s"
 -V only allowed with -s
 A filename to operate on is required
 At least one of -s, -g, or -r is required
 Attribute "%s" had a %d byte value for %s:
 Attribute "%s" set to a %d byte value for %s:
 Could not get "%s" for %s
 Could not remove "%s" for %s
 Could not set "%s" for %s
 No such attribute Only one of -s, -g, or -r allowed
 Unrecognized option: %c
 Usage: %s %s
 Usage: %s %s
Try `%s --help' for more information.
 Usage: %s [-LRSq] -s attrname [-V attrvalue] pathname  # set value
       %s [-LRSq] -g attrname pathname                 # get value
       %s [-LRSq] -r attrname pathname                 # remove attr
      -s reads a value from stdin and -g writes a value to stdout
 getting attribute %s of %s listing attributes of %s setting attribute %s for %s setting attributes for %s Project-Id-Version: attr
Report-Msgid-Bugs-To: 
POT-Creation-Date: 2005-09-30 19:05+0200
PO-Revision-Date: 2005-10-05 20:02+0200
Last-Translator: Guilhelm Panaget <guilhelm.panaget@free.fr>
Language-Team: French <debian-l10n-french@lists.debian.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-15
Content-Transfer-Encoding: 8bit
  -n, --name=nom         donner la valeur de l'attribut tendu nom
 -d, --dump             donner la valeur de tous les attributs tendus
 -e, --encoding=...     typer les valeurs (text, hex ou base64)
     --match=motif      ne prendre en compte que les attributs correspondant
                        au motif
     --only-values      n'afficher que les valeurs
 -h, --no-dereference   ne pas drfrencer les liens symboliques
     --absolute-names   ne pas supprimer les / en tte des chemins
                        absolus
 -R, --recursive        parcourir rcursivement les sous-rpertoires
 -L, --logical          chemin logique, suivre les liens symboliques
 -P  --physical         chemin physique, ne pas suivre les liens symboliques
     --version          afficher la version et quitter
     --help             afficher cette aide
   -n, --name=nom          affecter la valeur  l'attribut tendu nom
  -x, --remove=nom        supprimer l'attribut tendu nom
  -v, --value=val         donner  l'attribut la valeur val
  -h, --no-dereference    ne pas drfrencer les liens symboliques
      --restore=file      rtablir les attributs tendus
      --version           afficher la version et quitter
      --help              afficher cette aide
 %s %s -- obtenir les attributs tendus
 %s %s -- positionner les attributs tendus
 %s: %s: la ligne %d ne contient aucun nom de fichier, abandon
 %s: la ligne %d de l'entre standard ne contient aucun nom de fichier, abandon
 %s: Suppression des / en tte des chemins absolus
 %s: expression rationnelle non valable %s
 -V n'est compatible qu'avec -s
 Le nom du fichier auquel s'applique la commande est ncessaire
 Au moins un des commutateurs -s, -g ou -r est requis.
 L'attribut %s avait une valeur de %d octets pour %s:
 L'attribut %s positionn  une valeur de %d octets pour %s:
 Impossible d'obtenir %s pour %s
 Impossible de supprimer %s de %s
 Impossible d'affecter %s  %s
 Attribut inconnu Un seul des commutateurs -s, -g ou -r est autoris.
 Option inconnue: %c
 Utilisation: %s %s
 Utilisation: %s %s
Taper %s --help pour plus d'informations.
 Utilisation:
       %s [-LRSq] -s nom_attr [-V val_attr] chemin   # affecter la valeur.
       %s [-LRSq] -g nom_attr chemin                 # obtenir la valeur.
       %s [-LRSq] -r nom_attr chemin                 # supprimer l'attribut.
       -s lire la valeur  affecter sur l'entre standard.
       -g envoyer la valeur sur la sortie standard.
 obtention de l'attribut %s de %s affichage des attributs de %s positionnement de l'attribut %s de %s positionnement des attributs de %s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 )                        !      !   B  /   d  =     2     $        *  %   C  .   i  +     *     .        	     9	     U	     s	     	  &   	     	     	  @   	  3   /
  R  c
                      V        w  <        $   m  )     A     R     6   Q  (          (     ,     /   &  ,   V  4           !     #     %        E  '   Z            K     >     w  6                                                                                                          	                                      
                    %s %s
   -n, --name=name         get the named extended attribute value
  -d, --dump              get all extended attribute values
  -e, --encoding=...      encode values (as 'text', 'hex' or 'base64')
      --match=pattern     only get attributes with names matching pattern
      --only-values       print the bare values only
  -h, --no-dereference    do not dereference symbolic links
      --absolute-names    don't strip leading '/' in pathnames
  -R, --recursive         recurse into subdirectories
  -L, --logical           logical walk, follow symbolic links
  -P  --physical          physical walk, do not follow symbolic links
      --version           print version and exit
      --help              this help text
   -n, --name=name         set the value of the named extended attribute
  -x, --remove=name       remove the named extended attribute
  -v, --value=value       use value as the attribute value
  -h, --no-dereference    do not dereference symbolic links
      --restore=file      restore extended attributes
      --version           print version and exit
      --help              this help text
 %s %s -- get extended attributes
 %s %s -- set extended attributes
 %s: %s: No filename found in line %d, aborting
 %s: No filename found in line %d of standard input, aborting
 %s: Removing leading '/' from absolute path names
 %s: invalid regular expression "%s"
 -V only allowed with -s
 A filename to operate on is required
 At least one of -s, -g, -r, or -l is required
 Attribute "%s" had a %d byte value for %s:
 Attribute "%s" has a %d byte value for %s
 Attribute "%s" set to a %d byte value for %s:
 Could not get "%s" for %s
 Could not list "%s" for %s
 Could not remove "%s" for %s
 Could not set "%s" for %s
 No such attribute Only one of -s, -g, -r, or -l allowed
 Unrecognized option: %c
 Usage: %s %s
 Usage: %s %s
       %s %s
Try `%s --help' for more information.
 Usage: %s %s
Try `%s --help' for more information.
 Usage: %s [-LRSq] -s attrname [-V attrvalue] pathname  # set value
       %s [-LRSq] -g attrname pathname                 # get value
       %s [-LRSq] -r attrname pathname                 # remove attr
       %s [-LRq]  -l pathname                          # list attrs 
      -s reads a value from stdin and -g writes a value to stdout
 getting attribute %s of %s listing attributes of %s setting attribute %s for %s setting attributes for %s Project-Id-Version: attr-2.4.37
Report-Msgid-Bugs-To: 
POT-Creation-Date: 2007-03-06 12:02+0100
PO-Revision-Date: 2007-03-16 23:28+0100
Last-Translator: Antonio Trueba <atrueba@users.sourceforge.net>
Language-Team: Galician
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Poedit-Language: Galician
        %s %s
   -n, --name=nome         obter o valor de atributo estendido especificado
  -d, --dump              obt-lo valor de tdolos atributos estendidos
  -e, --encoding=...      codificar valores (coma 'text', 'hex' ou 'base64')
      --match=patrn      s obt-los atributos de nome coincidente co patrn
      --only-values       s amos-los valores crus dos atributos
  -h, --no-dereference    non resolv-los enlaces simblicos
      --absolute-names    non elimin-los '/' iniciis en nomes de rota
  -R, --recursive         recorrer subdirectorios recursivamente
  -L, --logical           percorrido lxico, seguindo enlaces simblicos
  -P  --physical          percorrido fsico, non segui-los enlaces simblicos
      --version           amosar versin e sair
      --help              este texto de axuda
   -n, --name=nome         establec-lo valor do atributo estendido especificado
  -x, --remove=nome       elimin-lo atributo estendido especificado
  -v, --value=valor       usar 'valor' coma o valor do atributo
  -h, --no-dereference    non resolver enlaces simblicos
      --restore=fich      restaurar atributos estendidos
      --version           amosar versin e sair
      --help              este texto de axuda
 %s %s -- obter atributos estendidos
 %s %s -- establecer atributos estendidos
 %s: %s: Non se atopuo un nome de ficheiro na lia %d, abortando
 %s: Non se atopou un nome de ficheiro na lia %d da entrada estndar, abortando
 %s: Borrando '/' iniciais dos nomes de rota absolutos
 %s: expresin regular incorrecta: "%s"
 -V s est permitido con -s
 Precsase un nome de ficheiro a tratar
  preciso alomenos un de -s, -g, -r, ou -l
 O atributo "%s" tia o valor byte %d para %s:
 O atributo "%s" ten o valor byte %d para %s
 Atributo "%s" establecido  valor byte %d para %s:
 Non se puido obter "%s" para %s
 Non se puido listar "%s" para %s
 Non se puido eliminar "%s" para %s
 Non se puido establecer "%s" para %s
 Non hai tal atributo S se permite un de -s, -g, -r, ou -l
 Opcin non recoecida: %c
 Uso: %s %s
 Uso: %s %s
       %s %s
Escriba `%s --help' para obter mis informacin.
 Uso: %s %s
Escriba `%s --help' para obter mis informacin.
 Uso:   %s [-LRSq] -s nomatrib rota [-V valatrib] rota  # establecer valor
       %s [-LRSq] -g nomatrib rota                     # obter valor
       %s [-LRSq] -r nomatrib rota                     # borrar atributo
       %s [-LRq]  -l rota                              # listar atributos 
      -s le un valor da entrada estndar e -g escrebe un valor  sada estndar
 obtendo atributo %s de %s listando atributos de %s establecendo atributo %s para %s establecendo atributos para %s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             %         `    a    4  !     !     /     =   6  2   t  $          %     *     +   6  .   b                      "        	     3	  3   A	    u	     
     
     
     
  .  
          )     $     9     I   L  :     '               +   8  .   d  3          "        	     '  -   @     n       9     +    "     #         D     `                                                                                                   	               
            -n, --name=name         get the named extended attribute value
  -d, --dump              get all extended attribute values
  -e, --encoding=...      encode values (as 'text', 'hex' or 'base64')
      --match=pattern     only get attributes with names matching pattern
      --only-values       print the bare values only
  -h, --no-dereference    do not dereference symbolic links
      --absolute-names    don't strip leading '/' in pathnames
  -R, --recursive         recurse into subdirectories
  -L, --logical           logical walk, follow symbolic links
  -P  --physical          physical walk, do not follow symbolic links
      --version           print version and exit
      --help              this help text
   -n, --name=name         set the value of the named extended attribute
  -x, --remove=name       remove the named extended attribute
  -v, --value=value       use value as the attribute value
  -h, --no-dereference    do not dereference symbolic links
      --restore=file      restore extended attributes
      --version           print version and exit
      --help              this help text
 %s %s -- get extended attributes
 %s %s -- set extended attributes
 %s: %s: No filename found in line %d, aborting
 %s: No filename found in line %d of standard input, aborting
 %s: Removing leading '/' from absolute path names
 %s: invalid regular expression "%s"
 -V only allowed with -s
 A filename to operate on is required
 At least one of -s, -g, or -r is required
 Attribute "%s" had a %d byte value for %s:
 Attribute "%s" set to a %d byte value for %s:
 Could not get "%s" for %s
 Could not remove "%s" for %s
 Could not set "%s" for %s
 No such attribute Only one of -s, -g, or -r allowed
 Unrecognized option: %c
 Usage: %s %s
 Usage: %s %s
Try `%s --help' for more information.
 Usage: %s [-LRSq] -s attrname [-V attrvalue] pathname  # set value
       %s [-LRSq] -g attrname pathname                 # get value
       %s [-LRSq] -r attrname pathname                 # remove attr
      -s reads a value from stdin and -g writes a value to stdout
 getting attribute %s of %s listing attributes of %s setting attribute %s for %s setting attributes for %s Project-Id-Version: attr 2.4.16-1
POT-Creation-Date: 
PO-Revision-Date: 2004-09-17 14:55+0100
Last-Translator: Luk Claes <luk.claes@ugent.be>
Language-Team: Debian l10n Dutch <debian-l10n-dutch@lists.debian.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
   -n, --name=naam       verkrijg de uitgebreide attribuutwaarde voor naam
  -d, --dump            verkrijg alle uitgebreide attribuutwaarden
  -e, --encoding=...    codeer waarden (als 'text', 'hex' of 'base64')
      --match=patroon   verkrijg enkel attributen met namen die overeenkomen met het patroon
      --only-values     print enkel de waarden
  -h, --no-dereference  zoek niet de verwijzing van symbolische koppelingen
      --absolute-names  laat de leidende '/' in padnamen staan
  -R, --recursive       ga recursief in submappen
  -L, --logical         logisch, volg symbolische koppelingen
  -P  --physical        fysisch, volg geen symbolische koppelingen
      --version         print versie en sluit af
      --help            deze helptekst
   -n, --name=naam       zet de waarde van het genoemde uitgebreide attribuut
  -x, --remove=naam     verwijder het genoemde uitgebreide attribuut
  -v, --value=waarde    gebruik waarde als de attribuutwaarde
  -h, --no-dereference  zoek niet naar verwijzingen van symbolische koppelingen
      --restore=bestand herstel uitgebreide attributen
      --version         print versie en sluit af
      --help            deze helptekst
 %s %s -- verkrijg uitgebreide attributen
 %s %s -- zet uitgebreide attributen
 %s: %s: geen bestandsnaam gevonden op regel %d, afbreken
 %s: geen bestandsnaam gevonden op regel %d van standaardinvoer, afbreken
 %s: de leidende '/' in absolute padnamen wordt verwijderd
 %s: ongeldige reguliere expressie "%s"
 -V is enkel toegestaan met -s
 Er is een bestandsnaam vereist
 Minstens n van -s, -g of -r is vereist
 Attribuut "%s" had een %d-bytewaarde voor %s:
 Attribuut "%s" gezet op een %d-bytewaarde voor %s:
 Kon "%s" niet krijgen voor %s
 Kon "%s" niet verwijderen voor %s
 Kon "%s" niet zetten voor %s
 Geen dergelijk attribuut Slechts n van -s, -g of -r is toegestaan
 Niet herkende optie: %c
 Gebruik: %s %s
 Gebruik: %s %s
Probeer `%s --help' voor meer informatie.
 Gebruik: %s [-LRSq] -s attr-naam [-V attr-waarde] padnaam # zet waarde
         %s [-LRSq] -g attr-naam padnaam                  # vraag waarde op
         %s [-LRSq] -r attr-naam padnaam                  # verwijder attr
         -s leest een waarde van stdin en -g schrijft een waarde naar stdout
 verkrijgen van attribuut %s van %s lijst opmaken met attributen van %s attribuut %s zetten voor %s attributen zetten voor %s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   )                        !      !   B  /   d  =     2     $        *  %   C  .   i  +     *     .        	     9	     U	     s	     	  &   	     	     	  @   	  3   /
  R  c
                      G        h    v      (     ,     @     R   \  5     $        
  )   #  4   M  3     0     ;        #  $   C     h            /               I     9   a         %     ?     X     v                                                                                     	                                      
                    %s %s
   -n, --name=name         get the named extended attribute value
  -d, --dump              get all extended attribute values
  -e, --encoding=...      encode values (as 'text', 'hex' or 'base64')
      --match=pattern     only get attributes with names matching pattern
      --only-values       print the bare values only
  -h, --no-dereference    do not dereference symbolic links
      --absolute-names    don't strip leading '/' in pathnames
  -R, --recursive         recurse into subdirectories
  -L, --logical           logical walk, follow symbolic links
  -P  --physical          physical walk, do not follow symbolic links
      --version           print version and exit
      --help              this help text
   -n, --name=name         set the value of the named extended attribute
  -x, --remove=name       remove the named extended attribute
  -v, --value=value       use value as the attribute value
  -h, --no-dereference    do not dereference symbolic links
      --restore=file      restore extended attributes
      --version           print version and exit
      --help              this help text
 %s %s -- get extended attributes
 %s %s -- set extended attributes
 %s: %s: No filename found in line %d, aborting
 %s: No filename found in line %d of standard input, aborting
 %s: Removing leading '/' from absolute path names
 %s: invalid regular expression "%s"
 -V only allowed with -s
 A filename to operate on is required
 At least one of -s, -g, -r, or -l is required
 Attribute "%s" had a %d byte value for %s:
 Attribute "%s" has a %d byte value for %s
 Attribute "%s" set to a %d byte value for %s:
 Could not get "%s" for %s
 Could not list "%s" for %s
 Could not remove "%s" for %s
 Could not set "%s" for %s
 No such attribute Only one of -s, -g, -r, or -l allowed
 Unrecognized option: %c
 Usage: %s %s
 Usage: %s %s
       %s %s
Try `%s --help' for more information.
 Usage: %s %s
Try `%s --help' for more information.
 Usage: %s [-LRSq] -s attrname [-V attrvalue] pathname  # set value
       %s [-LRSq] -g attrname pathname                 # get value
       %s [-LRSq] -r attrname pathname                 # remove attr
       %s [-LRq]  -l pathname                          # list attrs 
      -s reads a value from stdin and -g writes a value to stdout
 getting attribute %s of %s listing attributes of %s setting attribute %s for %s setting attributes for %s Project-Id-Version: attr-2.4.28
POT-Creation-Date: 2004-01-28 21:04+0100
PO-Revision-Date: 2006-01-21 21:13+0100
Last-Translator: Jakub Bogusz <qboosh@pld-linux.org>
Language-Team: Polish <translation-team-pl@lists.sourceforge.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-2
Content-Transfer-Encoding: 8bit
        %s %s
   -n, --name=nazwa        odczyt wartoci rozszerzonego atrybutu po nazwie
  -d, --dump              odczyt wartoci wszystkich rozszerzonych atrybutw
  -e, --encoding=...      kodowanie wartoci (jako 'text', 'hex' lub 'base64')
      --match=wzorzec     odczyt tylko wartoci atrybutw pasujcych do wzorca
      --only-values       wypisywanie tylko samych wartoci
  -h, --no-dereference    nie podanie za dowizaniami symbolicznymi
      --absolute-names    nie pomijanie wiodcych '/' ze cieek
  -R, --recursive         rekurencyjne wchodzenie do katalogw
  -L, --logical           przechodzenie logiczne, podanie za dowizaniami
                            symbolicznymi
  -P, --physical          przechodzenie fizyczne, nie podanie za dowizaniami
                            symbolicznymi
      --version           wywietlenie informacji o wersji i zakoczenie
      --help              ten tekst pomocy
   -n, --name=nazwa        ustawienie wartoci atrybutu po nazwie
  -x, --remove=nazwa      usunicie atrybutu po nazwie
  -v, --value=wartoci    uycie wartoci jako wartoci atrybutu
  -h, --no-dereference    nie podanie za dowizaniami symbolicznymi
      --restore=plik      odtworzenie rozszerzonych atrybutw
      --version           wywietlenie informacji o wersji i zakoczenie
      --help              ten tekst pomocy
 %s %s -- odczyt rozszerzonych atrybutw
 %s %s -- ustawianie rozszerzonych atrybutw
 %s: %s: Nie znaleziono nazwy pliku w linii %d, przerwanie pracy
 %s: Nie znaleziono nazwy pliku w linii %d standardowego wejcia, przerwanie pracy
 %s: Usunicie wiodcego '/' ze cieek bezwzgldnych
 %s: bdne wyraenie regularne "%s"
 -V dozwolone tylko z -s
 Nazwa pliku do operacji jest obowizkowa
 Wymagane jest co najmniej jedno z -s, -g, -r lub -l
 Atrybut "%1$s" dla %3$s mia warto %2$d-bajtow:
 Atrybut "%1$s" dla %3$s ma warto %2$d-bajtow
 Atrybut "%1$s" dla %3$s ustawiono na warto %2$d-bajtow:
 Nie mona odczyta "%s" dla %s
 Nie mona wypisa listy "%s" dla %s
 Nie mona usun "%s" dla %s
 Nie mona ustawi "%s" dla %s
 Nie ma takiego atrybutu Dozwolone jest tylko jedno z -s, -g, -r lub -l
 Nierozpoznana opcja: %c
 Skadnia: %s %s
 Skadnia: %s %s
          %s %s
`%s --help' wywietli wicej informacji.
 Skadnia: %s %s
`%s --help' wywietli wicej informacji.
 Skadnia: %s [-LRSq] -s atrybut [-V warto] cieka  # ustawienie wartoci
          %s [-LRSq] -g atrybut cieka               # odczytanie wartoci
          %s [-LRSq] -r atrybut cieka               # usunicie atrybutu
          %s [-LRq]  -l cieka                       # lista atrybutw
      -s odczytuje warto ze standardowego wejcia,
      -g zapisuje na standardowe wyjcie
 odczyt atrybutu %s dla %s wypisywanie atrybutw %s ustawianie atrybutu %s dla %s ustawianie atrybutw dla %s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            %         `    a    4  !     !     /     =   6  2   t  $          %     *     +   6  .   b                      "        	     3	  3   A	    u	     
     
     
     
  $  
              v       3     =     1   )  $   [       !     '     +     2        C     a            %               >      &  ?     f                                                                                                                  	               
            -n, --name=name         get the named extended attribute value
  -d, --dump              get all extended attribute values
  -e, --encoding=...      encode values (as 'text', 'hex' or 'base64')
      --match=pattern     only get attributes with names matching pattern
      --only-values       print the bare values only
  -h, --no-dereference    do not dereference symbolic links
      --absolute-names    don't strip leading '/' in pathnames
  -R, --recursive         recurse into subdirectories
  -L, --logical           logical walk, follow symbolic links
  -P  --physical          physical walk, do not follow symbolic links
      --version           print version and exit
      --help              this help text
   -n, --name=name         set the value of the named extended attribute
  -x, --remove=name       remove the named extended attribute
  -v, --value=value       use value as the attribute value
  -h, --no-dereference    do not dereference symbolic links
      --restore=file      restore extended attributes
      --version           print version and exit
      --help              this help text
 %s %s -- get extended attributes
 %s %s -- set extended attributes
 %s: %s: No filename found in line %d, aborting
 %s: No filename found in line %d of standard input, aborting
 %s: Removing leading '/' from absolute path names
 %s: invalid regular expression "%s"
 -V only allowed with -s
 A filename to operate on is required
 At least one of -s, -g, or -r is required
 Attribute "%s" had a %d byte value for %s:
 Attribute "%s" set to a %d byte value for %s:
 Could not get "%s" for %s
 Could not remove "%s" for %s
 Could not set "%s" for %s
 No such attribute Only one of -s, -g, or -r allowed
 Unrecognized option: %c
 Usage: %s %s
 Usage: %s %s
Try `%s --help' for more information.
 Usage: %s [-LRSq] -s attrname [-V attrvalue] pathname  # set value
       %s [-LRSq] -g attrname pathname                 # get value
       %s [-LRSq] -r attrname pathname                 # remove attr
      -s reads a value from stdin and -g writes a value to stdout
 getting attribute %s of %s listing attributes of %s setting attribute %s for %s setting attributes for %s Project-Id-Version: attr 2.4.25-1
POT-Creation-Date: 
PO-Revision-Date: 2006-01-21 18:46+0100
Last-Translator: Daniel Nylander <po@danielnylander.se>
Language-Team: Swedish <tp-sv@listor.tp-sv.se>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
   -n, --name=namn         hmta angivet utkat attributvrde
  -d, --dump              hmta alla utkade attributvrden
  -e, --encoding=...      koda vrden (som "text", "hex" eller "base64")
      --match=mnster     hmta endast attribut med namn som matchar mnster
      --only-values       skriv endast ut vrden
  -h, --no-dereference    behll referenser i symboliska lnkar
      --absolute-names    ta inte bort inledande "/" i skvgar
  -R, --recursive         rekursiv in i underkataloger
  -L, --logical           logisk gng, flj symboliska lnkar
  -P  --physical          fysisk gng, flj inte symboliska lnkar
      --version           skriv ut version och avsluta
      --help              den hr hjlptexten
   -n, --name=namn         stt vrdet fr angivet utkat attribut
  -x, --remove=namn       ta bort angivet utkat attribut
  -v, --value=vrde       anvnd vrde som attributvrde
  -h, --no-dereference    behll referenser i symboliska lnkar
      --restore=fil       restore extended attributes
      --version           print version and exit
      --help              this help text
 %s %s -- hmta utkade attribut
 %s %s -- stt utkade attribut
 %s: %s: Inget filnamn hittades p rad %d, avbryter
 %s: Inget filnamn hittades p rad %d i standard in, avbryter
 %s: Ta bort inledande "/" frn absoluta skvgar
 %s: ogiltigt reguljrt uttryck "%s"
 -V tillts endast med -s
 Ett filnamn att operera p krvs
 tminstone en av -s, -g eller -r krvs
 Attribut "%s" har ett %d bytevrde fr %s:
 Attribut "%s" satt till ett %d bytevrde  fr %s:
 Kunde inte hmta "%s" fr %s
 Kunde inte ta bort "%s" fr %s
 Kunde inte stta "%s" fr %s
 Inget sdant attribut Endast en av -s, -g eller -r tillts
 Oknd flagga: %c
 Anvndning: %s %s
 Anvndning: %s %s
Frsk med "%s --help" fr mer information.
 Anvndning: %s [-LRSq] -s attrnamn [-V attrvrde] skvg  # stt vrde
       %s [-LRSq] -g attrnamn skvg                   # hmta vrde
       %s [-LRSq] -r attrnamn skvg                   # ta bort attr
      -s lser ett vrde frn standard in och -g skriver ett vrde till standard ut
 hmtar attribut %s fr %s listar attribut fr %s stter attribut %s fr %s stter attribut fr %s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /.
/usr
/usr/bin
/usr/bin/attr
/usr/bin/getfattr
/usr/bin/setfattr
/usr/share
/usr/share/man
/usr/share/man/man1
/usr/share/man/man1/attr.1.gz
/usr/share/man/man1/getfattr.1.gz
/usr/share/man/man1/setfattr.1.gz
/usr/share/man/man5
/usr/share/man/man5/attr.5.gz
/usr/share/doc
/usr/share/doc/attr
/usr/share/doc/attr/PORTING
/usr/share/doc/attr/CHANGES.gz
/usr/share/doc/attr/README
/usr/share/doc/attr/copyright
/usr/share/doc/attr/changelog.Debian.gz
/usr/share/doc/attr/changelog.gz
/usr/share/locale
/usr/share/locale/cs
/usr/share/locale/cs/LC_MESSAGES
/usr/share/locale/cs/LC_MESSAGES/attr.mo
/usr/share/locale/de
/usr/share/locale/de/LC_MESSAGES
/usr/share/locale/de/LC_MESSAGES/attr.mo
/usr/share/locale/es
/usr/share/locale/es/LC_MESSAGES
/usr/share/locale/es/LC_MESSAGES/attr.mo
/usr/share/locale/fr
/usr/share/locale/fr/LC_MESSAGES
/usr/share/locale/fr/LC_MESSAGES/attr.mo
/usr/share/locale/gl
/usr/share/locale/gl/LC_MESSAGES
/usr/share/locale/gl/LC_MESSAGES/attr.mo
/usr/share/locale/nl
/usr/share/locale/nl/LC_MESSAGES
/usr/share/locale/nl/LC_MESSAGES/attr.mo
/usr/share/locale/pl
/usr/share/locale/pl/LC_MESSAGES
/usr/share/locale/pl/LC_MESSAGES/attr.mo
/usr/share/locale/sv
/usr/share/locale/sv/LC_MESSAGES
/usr/share/locale/sv/LC_MESSAGES/attr.mo
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ce669b5aec342c242060e8aaa57acdc7  lib/arm-linux-gnueabihf/libaio.so.1.0.1
8fb1f62db3b723660468f70260efb454  usr/share/doc/libaio1/TODO
136c9e4d2fd2efbc764dd23787484521  usr/share/doc/libaio1/changelog.Debian.gz
9960d0aa35a4cf9bfc72115d68e9ef46  usr/share/doc/libaio1/changelog.gz
7e418456ae97b9b34e02e41a84a7949f  usr/share/doc/libaio1/copyright
a051e6b9464637c4dbf0a5fa55ab781f  usr/share/lintian/overrides/libaio1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                libaio.so.1 libaio1 #MINVER#
 LIBAIO_0.1@LIBAIO_0.1 0.3.9
 LIBAIO_0.4@LIBAIO_0.4 0.3.93
 io_cancel@LIBAIO_0.1 0.3.9
 io_cancel@LIBAIO_0.4 0.3.93
 io_destroy@LIBAIO_0.4 0.3.93
 io_getevents@LIBAIO_0.1 0.3.9
 io_getevents@LIBAIO_0.4 0.3.93
 io_queue_init@LIBAIO_0.1 0.3.9
 io_queue_release@LIBAIO_0.1 0.3.9
 io_queue_run@LIBAIO_0.1 0.3.9
 io_queue_wait@LIBAIO_0.1 0.3.9
 io_queue_wait@LIBAIO_0.4 0.3.93
 io_setup@LIBAIO_0.4 0.3.93
 io_submit@LIBAIO_0.1 0.3.9
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       libaio 1 libaio1
udeb: libaio 1 libaio1-udeb
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   # Triggers added by dh_makeshlibs
activate-noawait ldconfig
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ELF          (      4       4    (                                                                            $   $         Qtd                          Rtd                       GNU K/Y >+%	s                  @uH         T|VF!TOU|V*dC*bf(fPL                                        m              \              A     x     )   l          D                      L     A     $     4     t               4   D  |                    X                      0       O           io_queue_init io_setup io_queue_release io_destroy io_getevents io_queue_wait io_queue_run __stack_chk_fail __stack_chk_guard io_submit io_cancel libc.so.6 ld-linux-armhf.so.3 libaio.so.1 LIBAIO_0.1 LIBAIO_0.4 GLIBC_2.4                         zw                   q0                  t0                                ii                      ii                            -P  P H @ 8 0  P       /-M 0  0 0A-0Mp` @ 0p`,0  P$0  5/ `0    P
,  0 R  0
     
  -p@    /0@-  P  
T@  ^do   \	  
   \    \  P@ U  
0@ 0
p-p   p/p-p   p/p-p   p/p-p   p/<0<0@-(M@  0$0$  0 R  (xL	     h0h 0@-  Q@M  0 00    0    d  0 R  Z 	     lp@-d@ SM@` P  0       E  0 R  p;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   o          |  
                   (            T     L              o  o          o   o  o   o                                                           |  |  |  |  |      A.   aeabi $   6 	
"4b042fbc59203ec797159ef39f2b2509188073.debug    n .shstrtab .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_d .gnu.version_r .rel.dyn .rel.plt .text .dynamic .got .bss .ARM.attributes .gnu_debuglink                                                        $                     o       d                (         |  |  0              0                               8   o       &                E   o       \                T   o       @                c   	      L  L                  l   	   B   T  T  (               p         |  |  P                 u                              {                                        $                                                      p           /                                /  4                                c                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    - Write man pages.
- Make -static links against libaio work.
- Fallback on userspace if the kernel calls return -ENOSYS.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Zrr*> E1>.+VYnr9&DsS}NUy$/OHD,XS:YL)x&{>ku]iv#[$Xg")OWVN[3gU.9gd	Yo<erdoDJ/kDiW8RMoKDQ/E9g3Qf\f*KjRufY%u%i")A9LJglf(kh\+-d?ad")aVrl=<{/ob/F{/n!CfQt8 
L=tgTVk%HjR,?{Jdt.:nGaXW'5K%*d/4~3r:/,^[oo#,t9+%v	eqTF+oUrLeYc`_6Aot?=	BX80gpUs2&	TTV<)=(.X.Ddk)EK~y2Q
YqV5Nt374eH$p_JBg~rfM2XZ\N|Ul-k&o <b&smv|&)q<
N[tv@yA!3Xy
<l!f"5	9;O!*}^y
^8f%O(M[\ KQ"MHju)oE^g~=D
0n*=hEp+=<@hYp> bq!3/?Xbxr@WJ~&vhW[/	#v?X)l=Dd8YR
+*Gmg~' Znb{DUwsHoqpkz
~,*Q rOe4k.@z#g%VR-%(U<3?<sh<Oy^|]q6y]5G`;y_U`+m>xF%*3e*LDWv5\Vd&m_ &6#-f&O$5{syWrqF/WBBmLp:k^[Y*aq$3Io3c"+2]~w A,"ib<~8Mz*3XM`<QW";ls('&x]Dd\y''[|hrJSk;/)7ow;$N/!73]P(N9p1JGn(
`:)}7^6)!,xucf2)vARrv?^]7?ZDrbA7s^[!:vENFPGp4^tV	yn$Bi@*$Jkp.pLQ|YSMw$A JH^j$q$z@7
|aQU	
ab%Qcq-Zq!U^^Aib=0Qz`SlTr` y=scnk0+y4o0n:;OaSuobZkJ[q:7>K$k?]-",9G9FiZ/V{Jw=$U-a_M%VrB6nS/%\;mh*.p~ P41%\8	&L
,%U0(J(	0rZkLCBJB}rE*|mp,B-n6uLuN''A'Rbox<>:`1{g&)<3p;|?Dz(N"9E6gIPW	XV7R(I8ha`;PiMn;j i:*lv{x zGWd>%[,|EuogD!@0n"@g;}cC8%<C+0$\+C8rjW<)<cw5'Zb$M!{u+B.3|^(edd""g('hD"Vx
({moZHAo8$hxB/+K]G$[tr+)<ji36z'n5i J5@<={g2p*TW9~qi g{:< qOC3nOM w\i' |6V1Nt4Ntr]B#]"lhSr^OI?(MwO*fS4Ma	't?_}xy}Pf5;_;-PV@pL6mrpQ\Cf#$n~5QqOHMnx02;c!!-ww,h8(4'v1^S04ccA@\qX*^%;^:?zu#hv@[&t=go3edv~m6}~MtEy%xoNmjH^bz=U88{#4}\N
h
eaY}C;x \FD';;lrV/r]zh305um1xj 3
/}acaxD_6.z885b3'vfp\c_W,?-Z1itb0;}2F_jXF;*8Q0x)#:)U^4&R`W|@xNlH{_LLu uXV\IBwi+Sg+lTa~^'	^etvR
;CaXN2;LW({yRF8b\e6RQ=eJ62)x}4e3dgnw_T5h.&d ~c;9ZMxl2,g: S2:\-E(a&Nigp&w0SQmL#'kHb,~TGL>mR>EwJ@+IeHhi	]rY_lrwB<D;""lp 1Hwa8olSau)Jfd=}P+'nncx"/m_*C@NlbjJ*l W/?-<93yn<Y%;:fd	j7<	@w{}m$yA'|zTa` @o}f|X'[Du=tGc#U}D nHy7]bGGQ8'DNw,^KeenE@jRiahOd9kYw{AnGwHeK_/6TRjAX7b0vl4/ynG_=ldQ A4V3DMA$zMUSqB$hOT6mtD0Zk!~%u`)EvOO~m?y"n*%F'y.
s9=;l:OMYq%Jz;\<iY-8>zWS`~oAz6SiE4._1GcWsSK};p1z]uv7f1LxyAMZntM|8rE<'WG ]4Hs>??g/V8MBj6yE{U)he1	c kh1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               mUQo7~l]ah2t(}4[	lLg\S :PFOp3)ORLihR=@YKb e6&p`M@ir$#h\z
!fX3a7n/&`#~k.c1Za;/4|wo~sL~g]@#Z6kT^B?	Bc3r@]zL6'>=0G2RmT1/b]]VkO6-K0T!<Jc};TvqHK0k&:P}NF|a<&~D<rMQf!9$kIwiK^_]-.l;L=M[gBppkGK*iH=b+WMIAboM*ekMs'0ukj*G32l]jqke@$;U? kYL9{Au8f|>7Z&I.@-B;s`R|pSJZP`I>,I8 {u#3iJ+QTlV' s:4z+OY^m.#5\T0N:kWdJ[;&x;P]e
Y=Bi:y*f7nny>-TNp^aeS?|sFW&S{2qh}FW|)/"w^:ITx?^5J?B1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Format: https://www.debian.org/doc/packaging-manuals/copyright-format/1.0/
Upstream-Name: libaio
Upstream-Contact: Jeff Moyer <jmoyer@redhat.com>
Source: https://git.fedorahosted.org/cgit/libaio.git

Files: *
Copyright:
 Copyright  2002-2003 Benjamin LaHaise <bcrl@redhat.com>
 Copyright  2003-2004 Jeff Moyer <jmoyer@redhat.com>
License: LGPL-2.1+
 This library is free software; you can redistribute it and/or
 modify it under the terms of the GNU Lesser General Public
 License as published by the Free Software Foundation; either
 version 2.1 of the License, or (at your option) any later version.
 .
 This library is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 Lesser General Public License for more details.
 .
 You should have received a copy of the GNU Lesser General Public License
 along with this library.  If not, see <https://www.gnu.org/licenses/>.
 .
 On Debian systems, the complete text of the GNU Lesser General
 Public License can be found in '/usr/share/common-licenses/LGPL-2.1'.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           libaio1: shared-lib-without-dependency-information lib/*/libaio.so.1.0.1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       